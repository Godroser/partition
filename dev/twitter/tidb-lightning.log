[2025/06/19 15:34:49.797 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 15:34:49.799 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 15:34:49.799 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":5972528850835128740,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"twitter\",\"table-pattern\":\"\",\"target-schema\":\"twitter\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 15:34:49.800 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 15:34:49.801 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=751.093µs] []
[2025/06/19 15:34:50.506 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 15:34:50.507 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 15:34:50.939 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 15:34:50.943 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 15:34:50.943 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 15:34:50.947 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 15:34:50.947 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 15:34:50.971 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=twitter]
[2025/06/19 15:34:50.972 +08:00] [ERROR] [schema_import.go:90] ["restore all schema failed"] [takeTime=24.426713ms] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:34:50.972 +08:00] [ERROR] [import.go:574] ["run failed"] [step=1] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:34:50.973 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=28.486013ms] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:34:50.974 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 15:34:50.975 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"] [errorVerbose="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found\ngithub.com/pingcap/errors.AddStack\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.func2\n\t/workspace/source/tidb/pkg/lightning/mydump/schema_import.go:198\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.(*ErrorGroupWithRecover).Go.func4\n\t/workspace/source/tidb/pkg/util/wait_group_wrapper.go:250\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 15:43:31.421 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 15:43:31.421 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 15:43:31.421 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":5704226621817059290,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"twitter\",\"table-pattern\":\"\",\"target-schema\":\"twitter\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 15:43:31.423 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 15:43:31.424 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.04612ms] []
[2025/06/19 15:43:31.473 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 15:43:31.473 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 15:43:31.529 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 15:43:31.531 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 15:43:31.532 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 15:43:31.535 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 15:43:31.535 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 15:43:31.536 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=twitter]
[2025/06/19 15:43:31.537 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=follows]
[2025/06/19 15:43:31.537 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=tweets]
[2025/06/19 15:43:31.537 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=users]
[2025/06/19 15:43:31.537 +08:00] [ERROR] [schema_import.go:90] ["restore all schema failed"] [takeTime=2.410739ms] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:43:31.537 +08:00] [ERROR] [import.go:574] ["run failed"] [step=1] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:43:31.537 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=5.520231ms] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"]
[2025/06/19 15:43:31.538 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 15:43:31.539 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found"] [errorVerbose="[Lightning:Restore:ErrSchemaNotExists]table `twitter`.`insert_users` schema not found\ngithub.com/pingcap/errors.AddStack\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.func2\n\t/workspace/source/tidb/pkg/lightning/mydump/schema_import.go:198\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.(*ErrorGroupWithRecover).Go.func4\n\t/workspace/source/tidb/pkg/util/wait_group_wrapper.go:250\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 15:44:26.837 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 15:44:26.837 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 15:44:26.837 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":695307084467922930,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"twitter\",\"table-pattern\":\"\",\"target-schema\":\"twitter\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 15:44:26.840 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 15:44:26.845 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=4.841881ms] []
[2025/06/19 15:44:26.902 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 15:44:26.902 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 15:44:26.974 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 15:44:26.977 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 15:44:26.977 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 15:44:26.980 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 15:44:26.980 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 15:44:27.000 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=twitter]
[2025/06/19 15:44:27.001 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=users]
[2025/06/19 15:44:27.001 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=tweets]
[2025/06/19 15:44:27.001 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=follows]
[2025/06/19 15:44:27.001 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=21.105936ms] []
[2025/06/19 15:44:27.082 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=users] [path=twitter.users.sql]
[2025/06/19 15:44:27.083 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=tweets] [path=twitter.tweets.sql]
[2025/06/19 15:44:27.085 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=follows] [path=twitter.follows.sql]
[2025/06/19 15:44:27.140 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `twitter`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 15:44:27.174 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `twitter`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 15:44:27.195 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:44:27.198 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:44:27.199 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 15:44:27.234 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 15:44:27.234 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 15:44:27.251 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 15:44:27.314 +08:00] [ERROR] [import.go:574] ["run failed"] [step=2] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`twitter`.`follows`] are not empty"]
[2025/06/19 15:44:27.314 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=337.292428ms] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`twitter`.`follows`] are not empty"]
[2025/06/19 15:44:27.316 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 15:44:27.317 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`twitter`.`follows`] are not empty"] [errorVerbose="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`twitter`.`follows`] are not empty\ngithub.com/pingcap/errors.AddStack\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/lightning/pkg/importer.(*Controller).preCheckRequirements\n\t/workspace/source/tidb/lightning/pkg/importer/import.go:1929\ngithub.com/pingcap/tidb/lightning/pkg/importer.(*Controller).Run\n\t/workspace/source/tidb/lightning/pkg/importer/import.go:562\ngithub.com/pingcap/tidb/lightning/pkg/server.(*Lightning).run\n\t/workspace/source/tidb/lightning/pkg/server/lightning.go:616\ngithub.com/pingcap/tidb/lightning/pkg/server.(*Lightning).RunOnceWithOptions\n\t/workspace/source/tidb/lightning/pkg/server/lightning.go:399\nmain.main.func2\n\t/workspace/source/tidb/lightning/cmd/tidb-lightning/main.go:96\nmain.main\n\t/workspace/source/tidb/lightning/cmd/tidb-lightning/main.go:97\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:272\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 15:46:28.959 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 15:46:28.959 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 15:46:28.959 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":4294938401061000560,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"twitter\",\"table-pattern\":\"\",\"target-schema\":\"twitter\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 15:46:28.961 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 15:46:28.962 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.015967ms] []
[2025/06/19 15:46:29.020 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 15:46:29.020 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 15:46:29.065 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 15:46:29.067 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 15:46:29.067 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 15:46:29.070 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 15:46:29.070 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 15:46:29.071 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=twitter]
[2025/06/19 15:46:29.072 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=users]
[2025/06/19 15:46:29.072 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=tweets]
[2025/06/19 15:46:29.072 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=twitter] [table=follows]
[2025/06/19 15:46:29.072 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=2.291397ms] []
[2025/06/19 15:46:29.096 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=users] [path=twitter.users.sql]
[2025/06/19 15:46:29.097 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=tweets] [path=twitter.tweets.sql]
[2025/06/19 15:46:29.099 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=twitter] [table=follows] [path=twitter.follows.sql]
[2025/06/19 15:46:29.104 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `twitter`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 15:46:29.105 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `twitter`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 15:46:29.120 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `twitter`.`follows` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 15:46:29.120 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:46:29.123 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:46:29.124 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 15:46:29.155 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 15:46:29.156 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 15:46:29.172 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 15:46:29.197 +08:00] [INFO] [import.go:1276] ["restore all tables data start"]
[2025/06/19 15:46:29.210 +08:00] [INFO] [checksum_helper.go:52] ["set tidb_backoff_weight to default"] [backoff_weight=30]
[2025/06/19 15:46:29.326 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`twitter`.`users`]
[2025/06/19 15:46:29.326 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`twitter`.`tweets`]
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`twitter`.`users`]
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`twitter`.`tweets`]
[2025/06/19 15:46:29.326 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=60.454µs]
[2025/06/19 15:46:29.326 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=47.518µs]
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`twitter`.`users`] [enginesCnt=2] [filesCnt=1] [takeTime=107.332µs] []
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`twitter`.`tweets`] [enginesCnt=2] [filesCnt=1] [takeTime=90.603µs] []
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`twitter`.`users`] [table=`twitter`.`users`] [count=3069463]
[2025/06/19 15:46:29.326 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`twitter`.`tweets`] [table=`twitter`.`tweets`] [count=25833363]
[2025/06/19 15:46:29.326 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Import]
[2025/06/19 15:46:29.327 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:46:29.328 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:46:30.149 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a]
[2025/06/19 15:46:30.149 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`twitter`.`users`]
[2025/06/19 15:46:30.149 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`twitter`.`users`] [engineNumber=0]
[2025/06/19 15:46:30.149 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`twitter`.`users`] [engineNumber=0]
[2025/06/19 15:46:30.244 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7]
[2025/06/19 15:46:30.244 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`twitter`.`tweets`]
[2025/06/19 15:46:30.244 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`twitter`.`tweets`] [engineNumber=0]
[2025/06/19 15:46:30.244 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`twitter`.`tweets`] [engineNumber=0]
[2025/06/19 15:46:30.850 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca]
[2025/06/19 15:46:30.856 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`twitter`.`users`] [engineNumber=0] [fileIndex=0] [path=twitter.users.sql:0]
[2025/06/19 15:46:31.009 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d]
[2025/06/19 15:46:31.016 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`twitter`.`tweets`] [engineNumber=0] [fileIndex=0] [path=twitter.tweets.sql:0]
[2025/06/19 15:46:31.890 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`twitter`.`users`] [engineNumber=0] [fileIndex=0] [path=twitter.users.sql:0] [readDur=243.530076ms] [encodeDur=691.89886ms] [deliverDur=149.038367ms] [checksum="{cksum=12478037867826848463,size=19388895,kvs=500000}"] [takeTime=1.032316093s] []
[2025/06/19 15:46:32.049 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`twitter`.`users`] [engineNumber=0] [read(bytes)=0] [written=19388895] [takeTime=1.900279655s] []
[2025/06/19 15:46:32.050 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca]
[2025/06/19 15:46:32.050 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=19388895] [kvs=500000] [files=1] [sstFileSize=4188288] [file=/data3/dzh/project/grep/dev/twitter/cache/20c8728f-452e-5071-ad26-21d9265276ca.sst/c10dbf90-09f1-49c0-be8d-57b5f5c8f58c.sst] [firstKey=748000000000000F0D5F728000000000000001] [lastKey=748000000000000F0D5F72800000000007A120]
[2025/06/19 15:46:32.236 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca] [takeTime=186.128176ms] []
[2025/06/19 15:46:32.310 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`twitter`.`users`] [engineNumber=0] [takeTime=2.160471087s] []
[2025/06/19 15:46:32.310 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca]
[2025/06/19 15:46:32.310 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca] [retryCnt=0]
[2025/06/19 15:46:32.313 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 15:46:32.887 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=20c8728f-452e-5071-ad26-21d9265276ca] ["region ranges"=1] [count=500000] [size=19388895]
[2025/06/19 15:46:32.887 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=2]
[2025/06/19 15:46:32.889 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f0d5f728000000000000001] [endOfAllRanges=748000000000000f0d5f72800000000007a121] [startKeyOfFirstRegion=748000000000000fff0d00000000000000f8] [endKeyOfLastRegion=748000000000000fff0f00000000000000f8]
[2025/06/19 15:46:35.084 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12817005 is conf_ver: 5 version: 2103, but you sent conf_ver: 5 version: 2101"] [region="{ID=12817037,startKey=748000000000000FFF0D5F728000000000FF0000010000000000FA,endKey=748000000000000FFF0D5F728000000000FF07A1210000000000FA,epoch=\"conf_ver:5 version:2103 \",peers=\"id:12817038 store_id:1 ,id:12817039 store_id:2 ,id:12817040 store_id:7 \"}"] [start=748000000000000F0D5F728000000000000001] [end=748000000000000F0D5F72800000000007A121]
[2025/06/19 15:46:35.084 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F0D5F728000000000000001] [endKey=748000000000000F0D5F72800000000007A121] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 15:46:37.084 +08:00]
[2025/06/19 15:46:37.951 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=20c8728f-452e-5071-ad26-21d9265276ca] [size=19388895] [kvs=500000] [importedSize=19388895] [importedCount=500000]
[2025/06/19 15:46:38.103 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca] [retryCnt=0] [takeTime=5.792904516s] []
[2025/06/19 15:46:38.103 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca]
[2025/06/19 15:46:38.234 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca] [takeTime=130.578542ms] []
[2025/06/19 15:46:38.234 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`users`:0] [engineUUID=20c8728f-452e-5071-ad26-21d9265276ca] [takeTime=5.924497336s] []
[2025/06/19 15:46:38.234 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`twitter`.`users`] [takeTime=8.085336247s] []
[2025/06/19 15:46:38.234 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a]
[2025/06/19 15:46:38.379 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a] [takeTime=144.978054ms] []
[2025/06/19 15:46:38.380 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a]
[2025/06/19 15:46:38.380 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a] [retryCnt=0]
[2025/06/19 15:46:38.383 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=9b537079-53fc-58a8-98f9-89861a4c459a]
[2025/06/19 15:46:38.383 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a] [retryCnt=0] [takeTime=2.635634ms] []
[2025/06/19 15:46:38.384 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a]
[2025/06/19 15:46:38.453 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a] [takeTime=68.874055ms] []
[2025/06/19 15:46:38.453 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`users`:-1] [engineUUID=9b537079-53fc-58a8-98f9-89861a4c459a] [takeTime=72.388141ms] []
[2025/06/19 15:46:38.453 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`twitter`.`users`] [takeTime=9.127092921s] []
[2025/06/19 15:46:38.453 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`twitter`.`follows`]
[2025/06/19 15:46:38.453 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`twitter`.`follows`]
[2025/06/19 15:46:38.453 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=40.044µs]
[2025/06/19 15:46:38.453 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`twitter`.`follows`] [enginesCnt=2] [filesCnt=1] [takeTime=75.886µs] []
[2025/06/19 15:46:38.453 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`twitter`.`follows`] [table=`twitter`.`follows`] [count=88897226]
[2025/06/19 15:46:38.455 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 15:46:38.754 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11]
[2025/06/19 15:46:38.754 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`twitter`.`follows`]
[2025/06/19 15:46:38.754 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`twitter`.`follows`] [engineNumber=0]
[2025/06/19 15:46:38.754 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`twitter`.`follows`] [engineNumber=0]
[2025/06/19 15:46:38.955 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa]
[2025/06/19 15:46:39.017 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`twitter`.`follows`] [engineNumber=0] [fileIndex=0] [path=twitter.follows.sql:0]
[2025/06/19 15:46:39.561 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=120851621] [kvs=1889947] [files=1] [sstFileSize=25819894] [file=/data3/dzh/project/grep/dev/twitter/cache/5e99ed46-b44f-5da6-929b-a2599353618d.sst/ea6479d8-a9d5-428f-9096-da204be09439.sst] [firstKey=748000000000000F0F5F728000000000000001] [lastKey=748000000000000F0F5F7280000000001CD69B]
[2025/06/19 15:46:41.055 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`twitter`.`tweets`] [engineNumber=0] [fileIndex=0] [path=twitter.tweets.sql:0] [readDur=4.62897009s] [encodeDur=4.407894041s] [deliverDur=1.48458352s] [checksum="{cksum=7037467273136205666,size=160505066,kvs=2500000}"] [takeTime=10.038899632s] []
[2025/06/19 15:46:41.270 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`twitter`.`tweets`] [engineNumber=0] [read(bytes)=0] [written=160505066] [takeTime=11.025779444s] []
[2025/06/19 15:46:41.270 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=39653445] [kvs=610053] [files=1] [sstFileSize=8357580] [file=/data3/dzh/project/grep/dev/twitter/cache/5e99ed46-b44f-5da6-929b-a2599353618d.sst/9cc18dc9-d3c1-4946-aab6-74e4fe315e07.sst] [firstKey=748000000000000F0F5F7280000000001CD69C] [lastKey=748000000000000F0F5F7280000000002625A0]
[2025/06/19 15:46:41.270 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d]
[2025/06/19 15:46:41.338 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d] [takeTime=67.826218ms] []
[2025/06/19 15:46:41.382 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`twitter`.`tweets`] [engineNumber=0] [takeTime=11.137924878s] []
[2025/06/19 15:46:41.382 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d]
[2025/06/19 15:46:41.382 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d] [retryCnt=0]
[2025/06/19 15:46:41.386 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=5e99ed46-b44f-5da6-929b-a2599353618d] [totalSize=160505066] [totalCount=2500000] [startKey=748000000000000F0F5F728000000000000001] [endKey=748000000000000F0F5F7280000000002625A1] [len(keys)=3] []
[2025/06/19 15:46:41.386 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 15:46:41.425 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=5e99ed46-b44f-5da6-929b-a2599353618d] ["region ranges"=2] [count=2500000] [size=160505066]
[2025/06/19 15:46:41.425 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=3]
[2025/06/19 15:46:41.425 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=5e99ed46-b44f-5da6-929b-a2599353618d]
[2025/06/19 15:46:41.427 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF0F5F728000000000FF0000010000000000FA] [end=748000000000000FFF0F5F728000000000FF2625A10000000000FB]
[2025/06/19 15:46:41.646 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > : found backoff error but don't count"] [errorVerbose="found backoff error but don't count\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > "] [backoff=10ms]
[2025/06/19 15:46:41.657 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > "] [backoff=20ms]
[2025/06/19 15:46:41.679 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 2, the first unfinished region: id:12817045 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\017_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2105 > peers:<id:12817046 store_id:1 > peers:<id:12817047 store_id:2 > peers:<id:12817048 store_id:7 > "] [backoff=40ms]
[2025/06/19 15:46:41.802 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=3]
[2025/06/19 15:46:42.021 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=3] [take=74.177998ms]
[2025/06/19 15:46:42.021 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=5e99ed46-b44f-5da6-929b-a2599353618d] [takeTime=594.89036ms] []
[2025/06/19 15:46:42.022 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f0f5f728000000000140001] [endOfAllRanges=748000000000000f0f5f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff0f5f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff0f5f728000000000ff2625a10000000000fa]
[2025/06/19 15:46:42.022 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f0f5f728000000000000001] [endOfAllRanges=748000000000000f0f5f728000000000140001] [startKeyOfFirstRegion=748000000000000fff0f5f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff0f5f728000000000ff1400010000000000fa]
[2025/06/19 15:46:42.927 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=81205066] [startKey=748000000000000F0F5F728000000000000001] [endKey=748000000000000F0F5F728000000000140001] [remainStart=748000000000000F0F5F728000000000138801] [region="{ID=12817045,startKey=748000000000000FFF0F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF0F5F728000000000FF1400010000000000FA,epoch=\"conf_ver:5 version:2105 \",peers=\"id:12817046 store_id:1 ,id:12817047 store_id:2 ,id:12817048 store_id:7 \"}"] [leader="id:12817048 store_id:7 "] [commitTS=458835673998950402]
[2025/06/19 15:46:44.723 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=5e99ed46-b44f-5da6-929b-a2599353618d] [size=160505066] [kvs=2500000] [importedSize=160505066] [importedCount=2500000]
[2025/06/19 15:46:44.745 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d] [retryCnt=0] [takeTime=3.362830005s] []
[2025/06/19 15:46:44.746 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d]
[2025/06/19 15:46:44.809 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d] [takeTime=62.822685ms] []
[2025/06/19 15:46:44.809 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`tweets`:0] [engineUUID=5e99ed46-b44f-5da6-929b-a2599353618d] [takeTime=3.426550193s] []
[2025/06/19 15:46:44.809 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`twitter`.`tweets`] [takeTime=14.564717195s] []
[2025/06/19 15:46:44.809 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7]
[2025/06/19 15:46:44.838 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7] [takeTime=29.252687ms] []
[2025/06/19 15:46:44.839 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7]
[2025/06/19 15:46:44.839 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7] [retryCnt=0]
[2025/06/19 15:46:44.841 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=d85f1784-2962-5650-b348-6ed6ca211ac7]
[2025/06/19 15:46:44.841 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7] [retryCnt=0] [takeTime=2.413189ms] []
[2025/06/19 15:46:44.842 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7]
[2025/06/19 15:46:44.884 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7] [takeTime=41.817766ms] []
[2025/06/19 15:46:44.884 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`tweets`:-1] [engineUUID=d85f1784-2962-5650-b348-6ed6ca211ac7] [takeTime=45.010578ms] []
[2025/06/19 15:46:44.885 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`twitter`.`tweets`] [takeTime=15.558725412s] []
[2025/06/19 15:47:10.500 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`twitter`.`follows`] [engineNumber=0] [fileIndex=0] [path=twitter.follows.sql:0] [readDur=4.960585472s] [encodeDur=23.068759192s] [deliverDur=7.578912271s] [checksum="{cksum=17349291318691849880,size=777445676,kvs=20001899}"] [takeTime=31.482475762s] []
[2025/06/19 15:47:10.905 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`twitter`.`follows`] [engineNumber=0] [read(bytes)=0] [written=777445676] [takeTime=32.150674795s] []
[2025/06/19 15:47:10.905 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa]
[2025/06/19 15:47:10.905 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=777445676] [kvs=20001899] [files=1] [sstFileSize=307779757] [file=/data3/dzh/project/grep/dev/twitter/cache/18a0ad8f-20ff-5444-8d58-e910a52177aa.sst/7cf2cdc3-b384-49c2-bf76-78e54bb6ef96.sst] [firstKey=748000000000000F135F728000000000000001] [lastKey=748000000000000F135F72800000000131346B]
[2025/06/19 15:47:11.038 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa] [takeTime=132.220455ms] []
[2025/06/19 15:47:11.086 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`twitter`.`follows`] [engineNumber=0] [takeTime=32.331305049s] []
[2025/06/19 15:47:11.086 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa]
[2025/06/19 15:47:11.086 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa] [retryCnt=0]
[2025/06/19 15:47:11.089 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=18a0ad8f-20ff-5444-8d58-e910a52177aa] [totalSize=777445676] [totalCount=20001899] [startKey=748000000000000F135F728000000000000001] [endKey=748000000000000F135F72800000000131346C] [len(keys)=17] []
[2025/06/19 15:47:11.089 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 15:47:11.123 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=18a0ad8f-20ff-5444-8d58-e910a52177aa] ["region ranges"=16] [count=20001899] [size=777445676]
[2025/06/19 15:47:11.124 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=17]
[2025/06/19 15:47:11.124 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=18a0ad8f-20ff-5444-8d58-e910a52177aa]
[2025/06/19 15:47:11.124 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF135F728000000000FF0000010000000000FA] [end=748000000000000FFF135F728000000001FF31346C0000000000FB]
[2025/06/19 15:47:11.335 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12594053,startKey=748000000000000FFF1300000000000000F8,endKey=7800000000000000FB,epoch=\"conf_ver:5 version:2107 \",peers=\"id:12594054 store_id:1 ,id:12594055 store_id:2 ,id:12594056 store_id:7 \"}"] [keys="{total=17,keys=\"[748000000000000F135F728000000000000001,\\\"(skip 15)\\\",748000000000000F135F72800000000131346C]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2109\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\023_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2109 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > "]
[2025/06/19 15:47:11.337 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12594053] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2109\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\023_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2109 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2109\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\023_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2109 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 15:47:11.388 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=2] [start=748000000000000FFF135F728000000000FF0000010000000000FA] [end=748000000000000FFF135F728000000001FF31346C0000000000FB]
[2025/06/19 15:47:11.390 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12817065,startKey=748000000000000FFF135F728000000000FF0000010000000000FA,endKey=748000000000000FFF135F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2109 \",peers=\"id:12817066 store_id:1 ,id:12817067 store_id:2 ,id:12817068 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F135F728000000000140001,\\\"(skip 13)\\\",748000000000000F135F7280000000012C0001]\"}"] [regionErr="message:\"peer is not leader for region 12817065, leader may None\" not_leader:<region_id:12817065 > "]
[2025/06/19 15:47:11.393 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12817067]
[2025/06/19 15:47:11.393 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=0] [regionID=12817065] ["new leader"="id:12817067 store_id:2 "]
[2025/06/19 15:47:11.397 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12817065,startKey=748000000000000FFF135F728000000000FF0000010000000000FA,endKey=748000000000000FFF135F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2109 \",peers=\"id:12817066 store_id:1 ,id:12817067 store_id:2 ,id:12817068 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F135F728000000000140001,\\\"(skip 13)\\\",748000000000000F135F7280000000012C0001]\"}"] [regionErr="message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12817065] 12817067 peer has not applied to current term, applied_term 5, current_term 6\\\"\" "]
[2025/06/19 15:47:11.397 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12817065] [error="split region failed: err=message:\"peer is not leader for region 12817065, leader may None\" not_leader:<region_id:12817065 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12817065] 12817067 peer has not applied to current term, applied_term 5, current_term 6\\\"\" : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="the following errors occurred:\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12817065, leader may None\" not_leader:<region_id:12817065 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12817065] 12817067 peer has not applied to current term, applied_term 5, current_term 6\\\"\" \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 15:47:11.499 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF135F728000000000FF1400010000000000FA] [end=748000000000000FFF135F728000000001FF2C00010000000000FB]
[2025/06/19 15:47:12.268 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=15]
[2025/06/19 15:47:12.442 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=15] [take=169.608063ms]
[2025/06/19 15:47:12.442 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=18a0ad8f-20ff-5444-8d58-e910a52177aa] [takeTime=1.318158007s] []
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000280001] [endOfAllRanges=748000000000000f135f7280000000003c0001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff2800010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff3c00010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000000001] [endOfAllRanges=748000000000000f135f728000000000140001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff1400010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000500001] [endOfAllRanges=748000000000000f135f728000000000640001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff5000010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff6400010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000140001] [endOfAllRanges=748000000000000f135f728000000000280001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff2800010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000780001] [endOfAllRanges=748000000000000f135f7280000000008c0001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff7800010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff8c00010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f7280000000003c0001] [endOfAllRanges=748000000000000f135f728000000000500001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff3c00010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff5000010000000000fa]
[2025/06/19 15:47:12.443 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000001180001] [endOfAllRanges=748000000000000f135f7280000000012c0001] [startKeyOfFirstRegion=748000000000000fff135f728000000001ff1800010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000001ff2c00010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000dc0001] [endOfAllRanges=748000000000000f135f728000000000f00001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ffdc00010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000fff000010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f7280000000012c0001] [endOfAllRanges=748000000000000f135f72800000000131346c] [startKeyOfFirstRegion=748000000000000fff135f728000000001ff2c00010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000001ff31346c0000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000640001] [endOfAllRanges=748000000000000f135f728000000000780001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff6400010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ff7800010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000001040001] [endOfAllRanges=748000000000000f135f728000000001180001] [startKeyOfFirstRegion=748000000000000fff135f728000000001ff0400010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000001ff1800010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000c80001] [endOfAllRanges=748000000000000f135f728000000000dc0001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ffc800010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ffdc00010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000a00001] [endOfAllRanges=748000000000000f135f728000000000b40001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ffa000010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ffb400010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000f00001] [endOfAllRanges=748000000000000f135f728000000001040001] [startKeyOfFirstRegion=748000000000000fff135f728000000000fff000010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000001ff0400010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f7280000000008c0001] [endOfAllRanges=748000000000000f135f728000000000a00001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ff8c00010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ffa000010000000000fa]
[2025/06/19 15:47:12.444 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f135f728000000000b40001] [endOfAllRanges=748000000000000f135f728000000000c80001] [startKeyOfFirstRegion=748000000000000fff135f728000000000ffb400010000000000fa] [endKeyOfLastRegion=748000000000000fff135f728000000000ffc800010000000000fa]
[2025/06/19 15:47:15.165 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751050] [startKey=748000000000000F135F7280000000003C0001] [endKey=748000000000000F135F728000000000500001] [remainStart=748000000000000F135F7280000000004F8801] [region="{ID=12817209,startKey=748000000000000FFF135F728000000000FF3C00010000000000FA,endKey=748000000000000FFF135F728000000000FF5000010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817210 store_id:1 ,id:12817211 store_id:2 ,id:12817212 store_id:7 \"}"] [leader="id:12817212 store_id:7 "] [commitTS=458835676082995201]
[2025/06/19 15:47:15.848 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49750676] [startKey=748000000000000F135F728000000000C80001] [endKey=748000000000000F135F728000000000DC0001] [remainStart=748000000000000F135F728000000000DB8801] [region="{ID=12817237,startKey=748000000000000FFF135F728000000000FFC800010000000000FA,endKey=748000000000000FFF135F728000000000FFDC00010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817238 store_id:1 ,id:12817239 store_id:2 ,id:12817240 store_id:7 \"}"] [leader="id:12817238 store_id:1 "] [commitTS=458835676082995201]
[2025/06/19 15:47:15.878 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752155] [startKey=748000000000000F135F728000000000A00001] [endKey=748000000000000F135F728000000000B40001] [remainStart=748000000000000F135F728000000000B38801] [region="{ID=12817229,startKey=748000000000000FFF135F728000000000FFA000010000000000FA,endKey=748000000000000FFF135F728000000000FFB400010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817230 store_id:1 ,id:12817231 store_id:2 ,id:12817232 store_id:7 \"}"] [leader="id:12817231 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.318 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751287] [startKey=748000000000000F135F728000000001180001] [endKey=748000000000000F135F7280000000012C0001] [remainStart=748000000000000F135F7280000000012B8801] [region="{ID=12817253,startKey=748000000000000FFF135F728000000001FF1800010000000000FA,endKey=748000000000000FFF135F728000000001FF2C00010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817254 store_id:1 ,id:12817255 store_id:2 ,id:12817256 store_id:7 \"}"] [leader="id:12817254 store_id:1 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.327 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751025] [startKey=748000000000000F135F7280000000008C0001] [endKey=748000000000000F135F728000000000A00001] [remainStart=748000000000000F135F7280000000009F8801] [region="{ID=12817225,startKey=748000000000000FFF135F728000000000FF8C00010000000000FA,endKey=748000000000000FFF135F728000000000FFA000010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817226 store_id:1 ,id:12817227 store_id:2 ,id:12817228 store_id:7 \"}"] [leader="id:12817227 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.342 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751454] [startKey=748000000000000F135F728000000000280001] [endKey=748000000000000F135F7280000000003C0001] [remainStart=748000000000000F135F7280000000003B8801] [region="{ID=12817205,startKey=748000000000000FFF135F728000000000FF2800010000000000FA,endKey=748000000000000FFF135F728000000000FF3C00010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817206 store_id:1 ,id:12817207 store_id:2 ,id:12817208 store_id:7 \"}"] [leader="id:12817208 store_id:7 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.372 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751819] [startKey=748000000000000F135F728000000000000001] [endKey=748000000000000F135F728000000000140001] [remainStart=748000000000000F135F728000000000138801] [region="{ID=12817197,startKey=748000000000000FFF135F728000000000FF0000010000000000FA,endKey=748000000000000FFF135F728000000000FF1400010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817198 store_id:1 ,id:12817199 store_id:2 ,id:12817200 store_id:7 \"}"] [leader="id:12817198 store_id:1 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.426 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751529] [startKey=748000000000000F135F728000000000DC0001] [endKey=748000000000000F135F728000000000F00001] [remainStart=748000000000000F135F728000000000EF8801] [region="{ID=12817241,startKey=748000000000000FFF135F728000000000FFDC00010000000000FA,endKey=748000000000000FFF135F728000000000FFF000010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817242 store_id:1 ,id:12817243 store_id:2 ,id:12817244 store_id:7 \"}"] [leader="id:12817243 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.499 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752016] [startKey=748000000000000F135F728000000000640001] [endKey=748000000000000F135F728000000000780001] [remainStart=748000000000000F135F728000000000778801] [region="{ID=12817217,startKey=748000000000000FFF135F728000000000FF6400010000000000FA,endKey=748000000000000FFF135F728000000000FF7800010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817218 store_id:1 ,id:12817219 store_id:2 ,id:12817220 store_id:7 \"}"] [leader="id:12817218 store_id:1 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.526 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752228] [startKey=748000000000000F135F728000000000500001] [endKey=748000000000000F135F728000000000640001] [remainStart=748000000000000F135F728000000000638801] [region="{ID=12817213,startKey=748000000000000FFF135F728000000000FF5000010000000000FA,endKey=748000000000000FFF135F728000000000FF6400010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817214 store_id:1 ,id:12817215 store_id:2 ,id:12817216 store_id:7 \"}"] [leader="id:12817215 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.527 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752251] [startKey=748000000000000F135F728000000000F00001] [endKey=748000000000000F135F728000000001040001] [remainStart=748000000000000F135F728000000001038801] [region="{ID=12817245,startKey=748000000000000FFF135F728000000000FFF000010000000000FA,endKey=748000000000000FFF135F728000000001FF0400010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817246 store_id:1 ,id:12817247 store_id:2 ,id:12817248 store_id:7 \"}"] [leader="id:12817247 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.533 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751473] [startKey=748000000000000F135F728000000000140001] [endKey=748000000000000F135F728000000000280001] [remainStart=748000000000000F135F728000000000278801] [region="{ID=12817201,startKey=748000000000000FFF135F728000000000FF1400010000000000FA,endKey=748000000000000FFF135F728000000000FF2800010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817202 store_id:1 ,id:12817203 store_id:2 ,id:12817204 store_id:7 \"}"] [leader="id:12817203 store_id:2 "] [commitTS=458835676082995201]
[2025/06/19 15:47:16.715 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49753196] [startKey=748000000000000F135F728000000000B40001] [endKey=748000000000000F135F728000000000C80001] [remainStart=748000000000000F135F728000000000C78801] [region="{ID=12817233,startKey=748000000000000FFF135F728000000000FFB400010000000000FA,endKey=748000000000000FFF135F728000000000FFC800010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817234 store_id:1 ,id:12817235 store_id:2 ,id:12817236 store_id:7 \"}"] [leader="id:12817234 store_id:1 "] [commitTS=458835676082995201]
[2025/06/19 15:47:20.507 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752399] [startKey=748000000000000F135F728000000000780001] [endKey=748000000000000F135F7280000000008C0001] [remainStart=748000000000000F135F7280000000008B8801] [region="{ID=12817221,startKey=748000000000000FFF135F728000000000FF7800010000000000FA,endKey=748000000000000FFF135F728000000000FF8C00010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817222 store_id:1 ,id:12817223 store_id:2 ,id:12817224 store_id:7 \"}"] [leader="id:12817224 store_id:7 "] [commitTS=458835676082995201]
[2025/06/19 15:47:20.589 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752041] [startKey=748000000000000F135F728000000001040001] [endKey=748000000000000F135F728000000001180001] [remainStart=748000000000000F135F728000000001178801] [region="{ID=12817249,startKey=748000000000000FFF135F728000000001FF0400010000000000FA,endKey=748000000000000FFF135F728000000001FF1800010000000000FA,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12817250 store_id:1 ,id:12817251 store_id:2 ,id:12817252 store_id:7 \"}"] [leader="id:12817252 store_id:7 "] [commitTS=458835676082995201]
[2025/06/19 15:47:33.840 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=18a0ad8f-20ff-5444-8d58-e910a52177aa] [size=777445676] [kvs=20001899] [importedSize=777445676] [importedCount=20001899]
[2025/06/19 15:47:33.862 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa] [retryCnt=0] [takeTime=22.776095372s] []
[2025/06/19 15:47:33.863 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa]
[2025/06/19 15:47:33.962 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa] [takeTime=98.846935ms] []
[2025/06/19 15:47:33.962 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`follows`:0] [engineUUID=18a0ad8f-20ff-5444-8d58-e910a52177aa] [takeTime=22.87598694s] []
[2025/06/19 15:47:33.962 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`twitter`.`follows`] [takeTime=55.207558223s] []
[2025/06/19 15:47:33.962 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11]
[2025/06/19 15:47:34.084 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11] [takeTime=122.417097ms] []
[2025/06/19 15:47:34.085 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11]
[2025/06/19 15:47:34.085 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11] [retryCnt=0]
[2025/06/19 15:47:34.088 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=518ca404-2123-582e-ba8a-80ca9e411c11]
[2025/06/19 15:47:34.088 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11] [retryCnt=0] [takeTime=2.460352ms] []
[2025/06/19 15:47:34.088 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11]
[2025/06/19 15:47:34.151 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11] [takeTime=63.054333ms] []
[2025/06/19 15:47:34.151 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`twitter`.`follows`:-1] [engineUUID=518ca404-2123-582e-ba8a-80ca9e411c11] [takeTime=66.31064ms] []
[2025/06/19 15:47:34.494 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`twitter`.`follows`] [takeTime=56.040791028s] []
[2025/06/19 15:47:34.494 +08:00] [INFO] [import.go:1148] ["cancel periodic actions"] [do=true]
[2025/06/19 15:47:34.494 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Normal]
[2025/06/19 15:47:35.632 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`twitter`.`tweets`] [checksum="{cksum=7037467273136205666,size=160505066,kvs=2500000}"]
[2025/06/19 15:47:35.632 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`twitter`.`users`] [checksum="{cksum=12478037867826848463,size=19388895,kvs=500000}"]
[2025/06/19 15:47:35.632 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=tweets]
[2025/06/19 15:47:35.632 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=users]
[2025/06/19 15:47:36.022 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=users] [takeTime=389.536661ms] []
[2025/06/19 15:47:36.022 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`twitter`.`users`] [local="{cksum=12478037867826848463,size=19388895,kvs=500000}"]
[2025/06/19 15:47:36.023 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`twitter`.`users`]
[2025/06/19 15:47:36.481 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=tweets] [takeTime=848.701655ms] []
[2025/06/19 15:47:36.481 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`twitter`.`tweets`] [local="{cksum=7037467273136205666,size=160505066,kvs=2500000}"]
[2025/06/19 15:47:36.482 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`twitter`.`tweets`]
[2025/06/19 15:47:37.520 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`twitter`.`users`] [takeTime=1.496126124s] []
[2025/06/19 15:47:37.520 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`twitter`.`follows`] [checksum="{cksum=17349291318691849880,size=777445676,kvs=20001899}"]
[2025/06/19 15:47:37.521 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=follows]
[2025/06/19 15:47:38.500 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=follows] [takeTime=979.601586ms] []
[2025/06/19 15:47:38.500 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`twitter`.`follows`] [local="{cksum=17349291318691849880,size=777445676,kvs=20001899}"]
[2025/06/19 15:47:38.501 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`twitter`.`follows`]
[2025/06/19 15:47:40.123 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`twitter`.`tweets`] [takeTime=3.640347154s] []
[2025/06/19 15:47:52.846 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`twitter`.`follows`] [takeTime=14.344351556s] []
[2025/06/19 15:47:52.847 +08:00] [INFO] [import.go:1412] ["restore all tables data completed"] [takeTime=1m23.649544674s] []
[2025/06/19 15:47:52.847 +08:00] [INFO] [import.go:1415] ["cleanup task metas"]
[2025/06/19 15:47:52.848 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=tikv-driver]
[2025/06/19 15:47:52.851 +08:00] [INFO] [import.go:1003] ["everything imported, stopping periodic actions"]
[2025/06/19 15:47:53.211 +08:00] [INFO] [import.go:1643] ["skip full compaction"]
[2025/06/19 15:47:53.211 +08:00] [INFO] [import.go:1793] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=4294938401061000560]
[2025/06/19 15:47:53.211 +08:00] [INFO] [import.go:1801] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=4294938401061000560] [takeTime=127.948µs] []
[2025/06/19 15:47:53.211 +08:00] [INFO] [import.go:584] ["the whole procedure completed"] [takeTime=1m24.143535095s] []
[2025/06/19 15:47:53.235 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 15:47:53.236 +08:00] [INFO] [checksum.go:510] ["service safe point keeper exited"]
[2025/06/19 15:47:53.236 +08:00] [INFO] [main.go:110] ["tidb lightning exit"] [finished=true]
[2025/06/19 16:59:36.000 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 16:59:36.016 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 16:59:36.016 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":2698010336429311269,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_advisor\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_advisor\",\"table-pattern\":\"\",\"target-schema\":\"tw_advisor\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 16:59:36.020 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 16:59:36.020 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=932.445µs] []
[2025/06/19 16:59:36.215 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 16:59:36.215 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 16:59:36.289 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 16:59:36.292 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 16:59:36.292 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 16:59:36.295 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 16:59:36.295 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 16:59:36.298 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_advisor]
[2025/06/19 16:59:36.317 +08:00] [ERROR] [schema_import.go:90] ["restore all schema failed"] [takeTime=21.15454ms] [error="[Lightning:Restore:ErrInvalidSchemaStmt]invalid schema statement: 'CREATE TABLE follows (\nfollower_id BIGINT NOT NULL,\nfollowee_id BIGINT NOT NULL\nPARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););': line 4 column 10 near \"PARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););\" "]
[2025/06/19 16:59:36.317 +08:00] [ERROR] [import.go:574] ["run failed"] [step=1] [error="[Lightning:Restore:ErrInvalidSchemaStmt]invalid schema statement: 'CREATE TABLE follows (\nfollower_id BIGINT NOT NULL,\nfollowee_id BIGINT NOT NULL\nPARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););': line 4 column 10 near \"PARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););\" "]
[2025/06/19 16:59:36.317 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=24.853195ms] [error="[Lightning:Restore:ErrInvalidSchemaStmt]invalid schema statement: 'CREATE TABLE follows (\nfollower_id BIGINT NOT NULL,\nfollowee_id BIGINT NOT NULL\nPARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););': line 4 column 10 near \"PARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););\" "]
[2025/06/19 16:59:36.319 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 16:59:36.320 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrInvalidSchemaStmt]invalid schema statement: 'CREATE TABLE follows (\nfollower_id BIGINT NOT NULL,\nfollowee_id BIGINT NOT NULL\nPARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););': line 4 column 10 near \"PARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););\" "] [errorVerbose="[Lightning:Restore:ErrInvalidSchemaStmt]invalid schema statement: 'CREATE TABLE follows (\nfollower_id BIGINT NOT NULL,\nfollowee_id BIGINT NOT NULL\nPARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););': line 4 column 10 near \"PARTITION BY RANGE COLUMNS(`follower_id`)\n(PARTITION `follows_p1` VALUES LESS THAN (250000),\nPARTITION `follows_p2` VALUES LESS THAN (500000),\nPARTITION `follows_p3` VALUES LESS THAN (750000),\nPARTITION `follows_p4` VALUES LESS THAN (MAXVALUE););\" \ngithub.com/pingcap/errors.AddStack\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/pkg/lightning/mydump.createIfNotExistsStmt\n\t/workspace/source/tidb/pkg/lightning/mydump/schema_import.go:335\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).runJob\n\t/workspace/source/tidb/pkg/lightning/mydump/schema_import.go:260\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.func1\n\t/workspace/source/tidb/pkg/lightning/mydump/schema_import.go:165\ngithub.com/pingcap/tidb/pkg/lightning/mydump.(*SchemaImporter).importTables.(*ErrorGroupWithRecover).Go.func3\n\t/workspace/source/tidb/pkg/util/wait_group_wrapper.go:250\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:00:37.756 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 17:00:37.756 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 17:00:37.756 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":5995077135625134674,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_advisor\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_advisor\",\"table-pattern\":\"\",\"target-schema\":\"tw_advisor\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 17:00:37.758 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 17:00:37.759 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=992.535µs] []
[2025/06/19 17:00:37.786 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 17:00:37.786 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 17:00:37.834 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 17:00:37.855 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 17:00:37.855 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 17:00:37.858 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 17:00:37.858 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 17:00:37.859 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_advisor]
[2025/06/19 17:00:38.305 +08:00] [WARN] [util.go:207] ["run create schema job failed with no retry"] [db=tw_advisor] [table=tweets] [query="CREATE TABLE IF NOT EXISTS `tw_advisor`.`tweets` (`tweet_id` BIGINT PRIMARY KEY,`user_id` BIGINT NOT NULL,`content` TEXT NOT NULL) PARTITION BY RANGE COLUMNS (`user_id`) (PARTITION `tweets_p1` VALUES LESS THAN (250000),PARTITION `tweets_p2` VALUES LESS THAN (500000),PARTITION `tweets_p3` VALUES LESS THAN (750000),PARTITION `tweets_p4` VALUES LESS THAN (MAXVALUE));"] [args=null] [retryCnt=0] [error="Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:00:38.306 +08:00] [ERROR] [schema_import.go:280] ["execute SQL: CREATE TABLE IF NOT EXISTS `tw_advisor`.`tweets` (`tweet_id` BIGINT PRIMARY KEY,`user_id` BIGINT NOT NULL,`content` TEXT NOT NULL) PARTITION BY RANGE COLUMNS (`user_id`) (PARTITION `tweets_p1` VALUES LESS THAN (250000),PARTITION `tweets_p2` VALUES LESS THAN (500000),PARTITION `tweets_p3` VALUES LESS THAN (750000),PARTITION `tweets_p4` VALUES LESS THAN (MAXVALUE)); failed"] [db=tw_advisor] [table=tweets] [takeTime=434.410852ms] [error="run create schema job failed: Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:00:38.306 +08:00] [WARN] [util.go:207] ["run create schema job failed with no retry"] [db=tw_advisor] [table=follows] [query="CREATE TABLE IF NOT EXISTS `tw_advisor`.`follows` (`follower_id` BIGINT NOT NULL,`followee_id` BIGINT NOT NULL) PARTITION BY RANGE COLUMNS (`follower_id`) (PARTITION `follows_p1` VALUES LESS THAN (250000),PARTITION `follows_p2` VALUES LESS THAN (500000),PARTITION `follows_p3` VALUES LESS THAN (750000),PARTITION `follows_p4` VALUES LESS THAN (MAXVALUE));"] [args=null] [retryCnt=0] [error="context canceled"]
[2025/06/19 17:00:38.306 +08:00] [WARN] [util.go:207] ["run create schema job failed with no retry"] [db=tw_advisor] [table=users] [query="CREATE TABLE IF NOT EXISTS `tw_advisor`.`users` (`user_id` BIGINT PRIMARY KEY,`name` VARCHAR(255) NOT NULL) PARTITION BY RANGE COLUMNS (`user_id`) (PARTITION `users_p1` VALUES LESS THAN (250000),PARTITION `users_p2` VALUES LESS THAN (500000),PARTITION `users_p3` VALUES LESS THAN (750000),PARTITION `users_p4` VALUES LESS THAN (MAXVALUE));"] [args=null] [retryCnt=0] [error="context canceled"]
[2025/06/19 17:00:38.306 +08:00] [ERROR] [schema_import.go:90] ["restore all schema failed"] [takeTime=447.656413ms] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `tw_advisor`.`tweets`, stmt: restore table schema: run create schema job failed: Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:00:38.306 +08:00] [ERROR] [import.go:574] ["run failed"] [step=1] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `tw_advisor`.`tweets`, stmt: restore table schema: run create schema job failed: Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:00:38.306 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=451.025821ms] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `tw_advisor`.`tweets`, stmt: restore table schema: run create schema job failed: Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:00:38.358 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 17:00:38.359 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:Restore:ErrCreateSchema]create schema failed, table: `tw_advisor`.`tweets`, stmt: restore table schema: run create schema job failed: Error 1503 (HY000): A CLUSTERED INDEX must include all columns in the table's partitioning function"]
[2025/06/19 17:02:20.485 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 17:02:20.486 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 17:02:20.486 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":14205129775852304,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_advisor\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_advisor\",\"table-pattern\":\"\",\"target-schema\":\"tw_advisor\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 17:02:20.488 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 17:02:20.492 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=4.624449ms] []
[2025/06/19 17:02:20.521 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 17:02:20.521 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 17:02:20.578 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 17:02:20.600 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 17:02:20.600 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 17:02:20.603 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 17:02:20.603 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 17:02:20.605 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_advisor]
[2025/06/19 17:02:20.606 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=tw_advisor] [table=users]
[2025/06/19 17:02:20.606 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=tw_advisor] [table=follows]
[2025/06/19 17:02:21.784 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=1.180596031s] []
[2025/06/19 17:02:22.127 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=users] [path=tw_advisor.users.sql]
[2025/06/19 17:02:22.129 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=tweets] [path=tw_advisor.tweets.sql]
[2025/06/19 17:02:22.130 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=follows] [path=tw_advisor.follows.sql]
[2025/06/19 17:02:22.990 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_advisor`.`follows` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:02:23.107 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_advisor`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:02:23.316 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_advisor`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:02:23.473 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:02:23.476 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:02:23.484 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 17:02:23.525 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:02:23.525 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 17:02:23.543 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:02:23.595 +08:00] [INFO] [import.go:1276] ["restore all tables data start"]
[2025/06/19 17:02:23.608 +08:00] [INFO] [checksum_helper.go:52] ["set tidb_backoff_weight to default"] [backoff_weight=30]
[2025/06/19 17:02:23.632 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Import]
[2025/06/19 17:02:23.632 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_advisor`.`tweets`]
[2025/06/19 17:02:23.632 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_advisor`.`users`]
[2025/06/19 17:02:23.632 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_advisor`.`tweets`]
[2025/06/19 17:02:23.632 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_advisor`.`users`]
[2025/06/19 17:02:23.633 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=45.348µs]
[2025/06/19 17:02:23.633 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=65.624µs]
[2025/06/19 17:02:23.633 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_advisor`.`users`] [enginesCnt=2] [filesCnt=1] [takeTime=96.363µs] []
[2025/06/19 17:02:23.633 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_advisor`.`tweets`] [enginesCnt=2] [filesCnt=1] [takeTime=128.366µs] []
[2025/06/19 17:02:23.633 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_advisor`.`users`] [table=`tw_advisor`.`users`] [count=3069463]
[2025/06/19 17:02:23.633 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_advisor`.`tweets`] [table=`tw_advisor`.`tweets`] [count=25833363]
[2025/06/19 17:02:23.634 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:02:23.634 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:02:24.880 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3]
[2025/06/19 17:02:24.880 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_advisor`.`users`]
[2025/06/19 17:02:24.880 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_advisor`.`users`] [engineNumber=0]
[2025/06/19 17:02:24.881 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_advisor`.`users`] [engineNumber=0]
[2025/06/19 17:02:25.086 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2]
[2025/06/19 17:02:25.086 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_advisor`.`tweets`]
[2025/06/19 17:02:25.086 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_advisor`.`tweets`] [engineNumber=0]
[2025/06/19 17:02:25.086 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_advisor`.`tweets`] [engineNumber=0]
[2025/06/19 17:02:25.161 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0]
[2025/06/19 17:02:25.169 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_advisor`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.users.sql:0]
[2025/06/19 17:02:25.320 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd]
[2025/06/19 17:02:25.324 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_advisor`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.tweets.sql:0]
[2025/06/19 17:02:26.396 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_advisor`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.users.sql:0] [readDur=223.518871ms] [encodeDur=905.746913ms] [deliverDur=141.533443ms] [checksum="{cksum=14061143131055759063,size=19388895,kvs=500000}"] [takeTime=1.226523822s] []
[2025/06/19 17:02:26.528 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_advisor`.`users`] [engineNumber=0] [read(bytes)=0] [written=19388895] [takeTime=1.647653471s] []
[2025/06/19 17:02:26.528 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0]
[2025/06/19 17:02:26.528 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=19388895] [kvs=500000] [files=1] [sstFileSize=4188345] [file=/data3/dzh/project/grep/dev/twitter/cache/61e2621d-27d2-5cc6-9bef-c4de65f724d0.sst/8fd7e61b-8727-437a-b93c-d365a22fe407.sst] [firstKey=748000000000000F185F728000000000000001] [lastKey=748000000000000F1A5F72800000000007A120]
[2025/06/19 17:02:26.591 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [takeTime=62.91561ms] []
[2025/06/19 17:02:26.640 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_advisor`.`users`] [engineNumber=0] [takeTime=1.759256578s] []
[2025/06/19 17:02:26.640 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0]
[2025/06/19 17:02:26.640 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [retryCnt=0]
[2025/06/19 17:02:26.749 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:02:26.784 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=61e2621d-27d2-5cc6-9bef-c4de65f724d0] ["region ranges"=1] [count=500000] [size=19388895]
[2025/06/19 17:02:26.785 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=2]
[2025/06/19 17:02:26.786 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f185f728000000000000001] [endOfAllRanges=748000000000000f1a5f72800000000007a121] [startKeyOfFirstRegion=748000000000000fff1800000000000000f8] [endKeyOfLastRegion=748000000000000fff1b00000000000000f8]
[2025/06/19 17:02:27.615 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818033 is conf_ver: 5 version: 2115, but you sent conf_ver: 5 version: 2114"] [region="{ID=12818057,startKey=748000000000000FFF1A00000000000000F8,endKey=748000000000000FFF1A5F728000000000FF07A1210000000000FA,epoch=\"conf_ver:5 version:2115 \",peers=\"id:12818058 store_id:1 ,id:12818059 store_id:2 ,id:12818060 store_id:7 \"}"] [start=748000000000000F1A] [end=748000000000000F1A5F72800000000007A121]
[2025/06/19 17:02:27.615 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F1A] [endKey=748000000000000F1A5F72800000000007A121] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:02:29.615 +08:00]
[2025/06/19 17:02:27.695 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818021 is conf_ver: 5 version: 2113, but you sent conf_ver: 5 version: 2112"] [region="{ID=12818021,startKey=748000000000000FFF185F728000000000FF0000010000000000FA,endKey=748000000000000FFF1900000000000000F8,epoch=\"conf_ver:5 version:2113 \",peers=\"id:12818022 store_id:1 ,id:12818023 store_id:2 ,id:12818024 store_id:7 \"}"] [start=748000000000000F185F728000000000000001] [end=748000000000000F19]
[2025/06/19 17:02:27.695 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F185F728000000000000001] [endKey=748000000000000F19] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:02:29.695 +08:00]
[2025/06/19 17:02:30.189 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [size=19388895] [kvs=500000] [importedSize=19388895] [importedCount=500000]
[2025/06/19 17:02:30.213 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [retryCnt=0] [takeTime=3.572717406s] []
[2025/06/19 17:02:30.213 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0]
[2025/06/19 17:02:30.267 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [takeTime=53.777691ms] []
[2025/06/19 17:02:30.267 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`users`:0] [engineUUID=61e2621d-27d2-5cc6-9bef-c4de65f724d0] [takeTime=3.627525243s] []
[2025/06/19 17:02:30.268 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_advisor`.`users`] [takeTime=5.387796289s] []
[2025/06/19 17:02:30.268 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3]
[2025/06/19 17:02:30.287 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3] [takeTime=19.557568ms] []
[2025/06/19 17:02:30.288 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3]
[2025/06/19 17:02:30.288 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3] [retryCnt=0]
[2025/06/19 17:02:30.292 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=0b31d35b-4192-5106-bf69-5b3c2ae809a3]
[2025/06/19 17:02:30.292 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3] [retryCnt=0] [takeTime=3.47392ms] []
[2025/06/19 17:02:30.292 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3]
[2025/06/19 17:02:30.338 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3] [takeTime=45.647543ms] []
[2025/06/19 17:02:30.338 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`users`:-1] [engineUUID=0b31d35b-4192-5106-bf69-5b3c2ae809a3] [takeTime=49.967049ms] []
[2025/06/19 17:02:30.339 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_advisor`.`users`] [takeTime=6.706845951s] []
[2025/06/19 17:02:30.339 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_advisor`.`follows`]
[2025/06/19 17:02:30.339 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_advisor`.`follows`]
[2025/06/19 17:02:30.340 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=67.491µs]
[2025/06/19 17:02:30.340 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_advisor`.`follows`] [enginesCnt=2] [filesCnt=1] [takeTime=114.84µs] []
[2025/06/19 17:02:30.340 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_advisor`.`follows`] [table=`tw_advisor`.`follows`] [count=88897226]
[2025/06/19 17:02:30.341 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:02:30.454 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08]
[2025/06/19 17:02:30.455 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_advisor`.`follows`]
[2025/06/19 17:02:30.455 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_advisor`.`follows`] [engineNumber=0]
[2025/06/19 17:02:30.455 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_advisor`.`follows`] [engineNumber=0]
[2025/06/19 17:02:30.612 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0]
[2025/06/19 17:02:30.708 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_advisor`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.follows.sql:0]
[2025/06/19 17:02:31.279 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=120851621] [kvs=1889947] [files=1] [sstFileSize=25820084] [file=/data3/dzh/project/grep/dev/twitter/cache/0d66797a-4412-5231-9c85-c0d1faea89dd.sst/8c16d1c9-49bd-435f-869d-f76c139d5d44.sst] [firstKey=748000000000000F245F728000000000000001] [lastKey=748000000000000F265F7280000000001CD69B]
[2025/06/19 17:02:33.060 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_advisor`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.tweets.sql:0] [readDur=1.67816305s] [encodeDur=5.025661745s] [deliverDur=1.598035112s] [checksum="{cksum=3741302022047040719,size=160505066,kvs=2500000}"] [takeTime=7.736043115s] []
[2025/06/19 17:02:33.289 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_advisor`.`tweets`] [engineNumber=0] [read(bytes)=0] [written=160505066] [takeTime=8.203075746s] []
[2025/06/19 17:02:33.289 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=39653445] [kvs=610053] [files=1] [sstFileSize=8357636] [file=/data3/dzh/project/grep/dev/twitter/cache/0d66797a-4412-5231-9c85-c0d1faea89dd.sst/f9b04170-ff05-4fcb-9b2e-d6851c8de386.sst] [firstKey=748000000000000F265F7280000000001CD69C] [lastKey=748000000000000F275F7280000000002625A0]
[2025/06/19 17:02:33.289 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd]
[2025/06/19 17:02:33.365 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd] [takeTime=75.948532ms] []
[2025/06/19 17:02:33.403 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_advisor`.`tweets`] [engineNumber=0] [takeTime=8.316754649s] []
[2025/06/19 17:02:33.403 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd]
[2025/06/19 17:02:33.403 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd] [retryCnt=0]
[2025/06/19 17:02:33.406 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=0d66797a-4412-5231-9c85-c0d1faea89dd] [totalSize=160505066] [totalCount=2500000] [startKey=748000000000000F245F728000000000000001] [endKey=748000000000000F275F7280000000002625A1] [len(keys)=3] []
[2025/06/19 17:02:33.406 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:02:33.439 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=0d66797a-4412-5231-9c85-c0d1faea89dd] ["region ranges"=2] [count=2500000] [size=160505066]
[2025/06/19 17:02:33.440 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=3]
[2025/06/19 17:02:33.440 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=0d66797a-4412-5231-9c85-c0d1faea89dd]
[2025/06/19 17:02:33.441 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF245F728000000000FF0000010000000000FA] [end=748000000000000FFF275F728000000000FF2625A10000000000FB]
[2025/06/19 17:02:33.723 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12594053,startKey=748000000000000FFF2700000000000000F8,endKey=7800000000000000FB,epoch=\"conf_ver:5 version:2117 \",peers=\"id:12594054 store_id:1 ,id:12594055 store_id:2 ,id:12594056 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F275F7280000000002625A1]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2118\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377'_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > "]
[2025/06/19 17:02:33.725 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12594053] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2118\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377'_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2118\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377'_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:02:33.770 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818041,startKey=748000000000000FFF2400000000000000F8,endKey=748000000000000FFF2500000000000000F8,epoch=\"conf_ver:5 version:2115 \",peers=\"id:12818042 store_id:1 ,id:12818043 store_id:2 ,id:12818044 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F245F728000000000000001]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818041 is conf_ver: 5 version: 2116\" epoch_not_match:<current_regions:<id:12818041 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377%\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818042 store_id:1 > peers:<id:12818043 store_id:2 > peers:<id:12818044 store_id:7 > > > "]
[2025/06/19 17:02:33.771 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818041] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818041 is conf_ver: 5 version: 2116\" epoch_not_match:<current_regions:<id:12818041 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377%\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818042 store_id:1 > peers:<id:12818043 store_id:2 > peers:<id:12818044 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818041 is conf_ver: 5 version: 2116\" epoch_not_match:<current_regions:<id:12818041 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377%\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818042 store_id:1 > peers:<id:12818043 store_id:2 > peers:<id:12818044 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:02:33.816 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:02:33.827 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > "] [backoff=20ms]
[2025/06/19 17:02:33.848 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818077 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377&_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2118 > peers:<id:12818078 store_id:1 > peers:<id:12818079 store_id:2 > peers:<id:12818080 store_id:7 > "] [backoff=40ms]
[2025/06/19 17:02:33.888 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=1]
[2025/06/19 17:02:33.995 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=6] [start=748000000000000FFF245F728000000000FF0000010000000000FA] [end=748000000000000FFF275F728000000000FF2625A10000000000FB]
[2025/06/19 17:02:33.996 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=0] [take=10.675µs]
[2025/06/19 17:02:33.996 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=0d66797a-4412-5231-9c85-c0d1faea89dd] [takeTime=555.352981ms] []
[2025/06/19 17:02:33.997 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f245f728000000000000001] [endOfAllRanges=748000000000000f265f728000000000140001] [startKeyOfFirstRegion=748000000000000fff245f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff265f728000000000ff1400010000000000fa]
[2025/06/19 17:02:33.997 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f265f728000000000140001] [endOfAllRanges=748000000000000f275f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff265f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff275f728000000000ff2625a10000000000fa]
[2025/06/19 17:02:37.145 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=0d66797a-4412-5231-9c85-c0d1faea89dd] [size=160505066] [kvs=2500000] [importedSize=160505066] [importedCount=2500000]
[2025/06/19 17:02:37.185 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd] [retryCnt=0] [takeTime=3.782494479s] []
[2025/06/19 17:02:37.186 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd]
[2025/06/19 17:02:37.291 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd] [takeTime=104.97041ms] []
[2025/06/19 17:02:37.291 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`tweets`:0] [engineUUID=0d66797a-4412-5231-9c85-c0d1faea89dd] [takeTime=3.888436033s] []
[2025/06/19 17:02:37.291 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_advisor`.`tweets`] [takeTime=12.205442843s] []
[2025/06/19 17:02:37.291 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2]
[2025/06/19 17:02:37.476 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2] [takeTime=185.004013ms] []
[2025/06/19 17:02:37.477 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2]
[2025/06/19 17:02:37.477 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2] [retryCnt=0]
[2025/06/19 17:02:37.480 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=44fe83af-5044-59f4-87a2-eea198b3fda2]
[2025/06/19 17:02:37.480 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2] [retryCnt=0] [takeTime=2.726649ms] []
[2025/06/19 17:02:37.481 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2]
[2025/06/19 17:02:37.513 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2] [takeTime=32.080626ms] []
[2025/06/19 17:02:37.513 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`tweets`:-1] [engineUUID=44fe83af-5044-59f4-87a2-eea198b3fda2] [takeTime=35.60587ms] []
[2025/06/19 17:02:37.514 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_advisor`.`tweets`] [takeTime=13.881558237s] []
[2025/06/19 17:03:28.806 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_advisor`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_advisor.follows.sql:0] [readDur=8.55768919s] [encodeDur=31.363711228s] [deliverDur=19.297853498s] [checksum="{cksum=2729894676666860337,size=777445676,kvs=20001899}"] [takeTime=58.097793582s] []
[2025/06/19 17:03:29.847 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_advisor`.`follows`] [engineNumber=0] [read(bytes)=0] [written=777445676] [takeTime=59.392370263s] []
[2025/06/19 17:03:29.847 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0]
[2025/06/19 17:03:36.604 +08:00] [INFO] [engine.go:1685] ["compact sst"] [fileCount=7] [size=777445676] [count=20001899] [cost=6.756437958s] [file=/data3/dzh/project/grep/dev/twitter/cache/1583618b-9acd-58b0-ad42-a0af1251b7b0.sst/25fab8d4-d951-4181-8e9f-c77c2ed39d31.sst]
[2025/06/19 17:03:36.604 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=777445676] [kvs=20001899] [files=1] [sstFileSize=304059515] [file=/data3/dzh/project/grep/dev/twitter/cache/1583618b-9acd-58b0-ad42-a0af1251b7b0.sst/25fab8d4-d951-4181-8e9f-c77c2ed39d31.sst] [firstKey=748000000000000F1D5F728000000000000003] [lastKey=748000000000000F205F72800000000131346B]
[2025/06/19 17:03:36.798 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0] [takeTime=6.951068253s] []
[2025/06/19 17:03:36.852 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_advisor`.`follows`] [engineNumber=0] [takeTime=1m6.397508082s] []
[2025/06/19 17:03:36.852 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0]
[2025/06/19 17:03:36.852 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0] [retryCnt=0]
[2025/06/19 17:03:36.856 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=1583618b-9acd-58b0-ad42-a0af1251b7b0] [totalSize=777445676] [totalCount=20001899] [startKey=748000000000000F1D5F728000000000000003] [endKey=748000000000000F205F72800000000131346C] [len(keys)=17] []
[2025/06/19 17:03:36.856 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:03:36.894 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=1583618b-9acd-58b0-ad42-a0af1251b7b0] ["region ranges"=16] [count=20001899] [size=777445676]
[2025/06/19 17:03:36.894 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=17]
[2025/06/19 17:03:36.894 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=1583618b-9acd-58b0-ad42-a0af1251b7b0]
[2025/06/19 17:03:36.895 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF1D5F728000000000FF0000030000000000FA] [end=748000000000000FFF205F728000000001FF31346C0000000000FB]
[2025/06/19 17:03:37.209 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818037,startKey=748000000000000FFF2000000000000000F8,endKey=748000000000000FFF2400000000000000F8,epoch=\"conf_ver:5 version:2114 \",peers=\"id:12818038 store_id:1 ,id:12818039 store_id:2 ,id:12818040 store_id:7 \"}"] [keys="{total=5,keys=\"[748000000000000F205F7280000000002C561E,\\\"(skip 3)\\\",748000000000000F205F72800000000131346C]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818037 is conf_ver: 5 version: 2115\" epoch_not_match:<current_regions:<id:12818037 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377 _r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2115 > peers:<id:12818038 store_id:1 > peers:<id:12818039 store_id:2 > peers:<id:12818040 store_id:7 > > > "]
[2025/06/19 17:03:37.210 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818037] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818037 is conf_ver: 5 version: 2115\" epoch_not_match:<current_regions:<id:12818037 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377 _r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2115 > peers:<id:12818038 store_id:1 > peers:<id:12818039 store_id:2 > peers:<id:12818040 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818037 is conf_ver: 5 version: 2115\" epoch_not_match:<current_regions:<id:12818037 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377 _r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377$\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2115 > peers:<id:12818038 store_id:1 > peers:<id:12818039 store_id:2 > peers:<id:12818040 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:03:37.333 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818009,startKey=748000000000000FFF1D00000000000000F8,endKey=748000000000000FFF1E00000000000000F8,epoch=\"conf_ver:5 version:2111 \",peers=\"id:12818010 store_id:1 ,id:12818011 store_id:2 ,id:12818012 store_id:7 \"}"] [keys="{total=4,keys=\"[748000000000000F1D5F728000000000000003,748000000000000F1D5F7280000000004FFBF0,748000000000000F1D5F728000000000A00A48,748000000000000F1D5F728000000000F00CE3]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818009 is conf_ver: 5 version: 2112\" epoch_not_match:<current_regions:<id:12818009 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\035_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2112 > peers:<id:12818010 store_id:1 > peers:<id:12818011 store_id:2 > peers:<id:12818012 store_id:7 > > > "]
[2025/06/19 17:03:37.334 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818009] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818009 is conf_ver: 5 version: 2112\" epoch_not_match:<current_regions:<id:12818009 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\035_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2112 > peers:<id:12818010 store_id:1 > peers:<id:12818011 store_id:2 > peers:<id:12818012 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818009 is conf_ver: 5 version: 2112\" epoch_not_match:<current_regions:<id:12818009 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\035_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2112 > peers:<id:12818010 store_id:1 > peers:<id:12818011 store_id:2 > peers:<id:12818012 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:03:37.367 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818109 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\037\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\037_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2117 > peers:<id:12818110 store_id:1 > peers:<id:12818111 store_id:2 > peers:<id:12818112 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818109 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\037\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\037_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2117 > peers:<id:12818110 store_id:1 > peers:<id:12818111 store_id:2 > peers:<id:12818112 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:03:37.368 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818121 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818122 store_id:1 > peers:<id:12818123 store_id:2 > peers:<id:12818124 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818121 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818122 store_id:1 > peers:<id:12818123 store_id:2 > peers:<id:12818124 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:03:37.380 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818121 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818122 store_id:1 > peers:<id:12818123 store_id:2 > peers:<id:12818124 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818121 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\036_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2116 > peers:<id:12818122 store_id:1 > peers:<id:12818123 store_id:2 > peers:<id:12818124 store_id:7 > "] [backoff=20ms]
[2025/06/19 17:03:37.526 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:03:38.011 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:03:38.063 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=13] [start=748000000000000FFF1D5F728000000000FF0000030000000000FA] [end=748000000000000FFF205F728000000001FF31346C0000000000FB]
[2025/06/19 17:03:38.506 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=3]
[2025/06/19 17:03:38.649 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:03:38.814 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=7] [take=164.158258ms]
[2025/06/19 17:03:38.814 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=1583618b-9acd-58b0-ad42-a0af1251b7b0] [takeTime=1.920184439s] []
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f1e5f728000000000fea6c0] [endOfAllRanges=748000000000000f1f5f7280000000001d78aa] [startKeyOfFirstRegion=748000000000000fff1e5f728000000000fffea6c00000000000fa] [endKeyOfLastRegion=748000000000000fff1f5f728000000000ff1d78aa0000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1d5f7280000000004ffbf0] [endOfAllRanges=748000000000000f1d5f728000000000a00a48] [startKeyOfFirstRegion=748000000000000fff1d5f728000000000ff4ffbf00000000000fa] [endKeyOfLastRegion=748000000000000fff1d5f728000000000ffa00a480000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1f5f7280000000001d78aa] [endOfAllRanges=748000000000000f1f5f7280000000006d816d] [startKeyOfFirstRegion=748000000000000fff1f5f728000000000ff1d78aa0000000000fa] [endKeyOfLastRegion=748000000000000fff1f5f728000000000ff6d816d0000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1f5f7280000000006d816d] [endOfAllRanges=748000000000000f1f5f728000000000bd77cc] [startKeyOfFirstRegion=748000000000000fff1f5f728000000000ff6d816d0000000000fa] [endKeyOfLastRegion=748000000000000fff1f5f728000000000ffbd77cc0000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f205f728000000000cc559f] [endOfAllRanges=748000000000000f205f7280000000011c5802] [startKeyOfFirstRegion=748000000000000fff205f728000000000ffcc559f0000000000fa] [endKeyOfLastRegion=748000000000000fff205f728000000001ff1c58020000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f205f7280000000007c6697] [endOfAllRanges=748000000000000f205f728000000000cc559f] [startKeyOfFirstRegion=748000000000000fff205f728000000000ff7c66970000000000fa] [endKeyOfLastRegion=748000000000000fff205f728000000000ffcc559f0000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1d5f728000000000a00a48] [endOfAllRanges=748000000000000f1d5f728000000000f00ce3] [startKeyOfFirstRegion=748000000000000fff1d5f728000000000ffa00a480000000000fa] [endKeyOfLastRegion=748000000000000fff1d5f728000000000fff00ce30000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f205f7280000000011c5802] [endOfAllRanges=748000000000000f205f72800000000131346c] [startKeyOfFirstRegion=748000000000000fff205f728000000001ff1c58020000000000fa] [endKeyOfLastRegion=748000000000000fff205f728000000001ff31346c0000000000fa]
[2025/06/19 17:03:38.816 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1d5f728000000000000003] [endOfAllRanges=748000000000000f1d5f7280000000004ffbf0] [startKeyOfFirstRegion=748000000000000fff1d5f728000000000ff0000030000000000fa] [endKeyOfLastRegion=748000000000000fff1d5f728000000000ff4ffbf00000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f205f7280000000002c561e] [endOfAllRanges=748000000000000f205f7280000000007c6697] [startKeyOfFirstRegion=748000000000000fff205f728000000000ff2c561e0000000000fa] [endKeyOfLastRegion=748000000000000fff205f728000000000ff7c66970000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1e5f728000000000aea9d4] [endOfAllRanges=748000000000000f1e5f728000000000fea6c0] [startKeyOfFirstRegion=748000000000000fff1e5f728000000000ffaea9d40000000000fa] [endKeyOfLastRegion=748000000000000fff1e5f728000000000fffea6c00000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f1f5f7280000000010d7c06] [endOfAllRanges=748000000000000f205f7280000000002c561e] [startKeyOfFirstRegion=748000000000000fff1f5f728000000001ff0d7c060000000000fa] [endKeyOfLastRegion=748000000000000fff205f728000000000ff2c561e0000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1e5f7280000000005eb5f1] [endOfAllRanges=748000000000000f1e5f728000000000aea9d4] [startKeyOfFirstRegion=748000000000000fff1e5f728000000000ff5eb5f10000000000fa] [endKeyOfLastRegion=748000000000000fff1e5f728000000000ffaea9d40000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1e5f7280000000000ecade] [endOfAllRanges=748000000000000f1e5f7280000000005eb5f1] [startKeyOfFirstRegion=748000000000000fff1e5f728000000000ff0ecade0000000000fa] [endKeyOfLastRegion=748000000000000fff1e5f728000000000ff5eb5f10000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f1d5f728000000000f00ce3] [endOfAllRanges=748000000000000f1e5f7280000000000ecade] [startKeyOfFirstRegion=748000000000000fff1d5f728000000000fff00ce30000000000fa] [endKeyOfLastRegion=748000000000000fff1e5f728000000000ff0ecade0000000000fa]
[2025/06/19 17:03:38.817 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f1f5f728000000000bd77cc] [endOfAllRanges=748000000000000f1f5f7280000000010d7c06] [startKeyOfFirstRegion=748000000000000fff1f5f728000000000ffbd77cc0000000000fa] [endKeyOfLastRegion=748000000000000fff1f5f728000000001ff0d7c060000000000fa]
[2025/06/19 17:03:42.724 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836406] [startKey=748000000000000F205F7280000000002C561E] [endKey=748000000000000F205F7280000000007C6697] [remainStart=748000000000000F205F7280000000007A86A4] [region="{ID=12818165,startKey=748000000000000FFF205F728000000000FF2C561E0000000000FA,endKey=748000000000000FFF205F728000000000FF7C66970000000000FA,epoch=\"conf_ver:5 version:2119 \",peers=\"id:12818166 store_id:1 ,id:12818167 store_id:2 ,id:12818168 store_id:7 \"}"] [leader="id:12818167 store_id:2 "] [commitTS=458836869270470659]
[2025/06/19 17:03:42.911 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49500934] [startKey=748000000000000F1D5F728000000000A00A48] [endKey=748000000000000F1D5F728000000000F00CE3] [remainStart=748000000000000F1D5F728000000000EE2D3F] [region="{ID=12818177,startKey=748000000000000FFF1D5F728000000000FFA00A480000000000FA,endKey=748000000000000FFF1D5F728000000000FFF00CE30000000000FA,epoch=\"conf_ver:5 version:2115 \",peers=\"id:12818178 store_id:1 ,id:12818179 store_id:2 ,id:12818180 store_id:7 \"}"] [leader="id:12818179 store_id:2 "] [commitTS=458836869270470659]
[2025/06/19 17:03:43.074 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836035] [startKey=748000000000000F205F7280000000007C6697] [endKey=748000000000000F205F728000000000CC559F] [remainStart=748000000000000F205F728000000000CA776C] [region="{ID=12818173,startKey=748000000000000FFF205F728000000000FF7C66970000000000FA,endKey=748000000000000FFF205F728000000000FFCC559F0000000000FA,epoch=\"conf_ver:5 version:2119 \",peers=\"id:12818174 store_id:1 ,id:12818175 store_id:2 ,id:12818176 store_id:7 \"}"] [leader="id:12818176 store_id:7 "] [commitTS=458836869270470659]
[2025/06/19 17:03:43.095 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499146] [startKey=748000000000000F1D5F728000000000000003] [endKey=748000000000000F1D5F7280000000004FFBF0] [remainStart=748000000000000F1D5F7280000000004E1F91] [region="{ID=12818161,startKey=748000000000000FFF1D5F728000000000FF0000030000000000FA,endKey=748000000000000FFF1D5F728000000000FF4FFBF00000000000FA,epoch=\"conf_ver:5 version:2115 \",peers=\"id:12818162 store_id:1 ,id:12818163 store_id:2 ,id:12818164 store_id:7 \"}"] [leader="id:12818162 store_id:1 "] [commitTS=458836869270470659]
[2025/06/19 17:03:43.311 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835564] [startKey=748000000000000F1F5F728000000000BD77CC] [endKey=748000000000000F1F5F7280000000010D7C06] [remainStart=748000000000000F1F5F7280000000010BA027] [region="{ID=12818133,startKey=748000000000000FFF1F5F728000000000FFBD77CC0000000000FA,endKey=748000000000000FFF1F5F728000000001FF0D7C060000000000FA,epoch=\"conf_ver:5 version:2117 \",peers=\"id:12818134 store_id:1 ,id:12818135 store_id:2 ,id:12818136 store_id:7 \"}"] [leader="id:12818136 store_id:7 "] [commitTS=458836869270470659]
[2025/06/19 17:03:45.447 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835575] [startKey=748000000000000F1F5F7280000000006D816D] [endKey=748000000000000F1F5F728000000000BD77CC] [remainStart=748000000000000F1F5F728000000000BB9A01] [region="{ID=12818125,startKey=748000000000000FFF1F5F728000000000FF6D816D0000000000FA,endKey=748000000000000FFF1F5F728000000000FFBD77CC0000000000FA,epoch=\"conf_ver:5 version:2117 \",peers=\"id:12818126 store_id:1 ,id:12818127 store_id:2 ,id:12818128 store_id:7 \"}"] [leader="id:12818126 store_id:1 "] [commitTS=458836869270470659]
[2025/06/19 17:03:45.805 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835605] [startKey=748000000000000F1E5F7280000000000ECADE] [endKey=748000000000000F1E5F7280000000005EB5F1] [remainStart=748000000000000F1E5F7280000000005CD674] [region="{ID=12818137,startKey=748000000000000FFF1E5F728000000000FF0ECADE0000000000FA,endKey=748000000000000FFF1E5F728000000000FF5EB5F10000000000FA,epoch=\"conf_ver:5 version:2116 \",peers=\"id:12818138 store_id:1 ,id:12818139 store_id:2 ,id:12818140 store_id:7 \"}"] [leader="id:12818138 store_id:1 "] [commitTS=458836869270470659]
[2025/06/19 17:03:45.842 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835527] [startKey=748000000000000F1E5F728000000000AEA9D4] [endKey=748000000000000F1E5F728000000000FEA6C0] [remainStart=748000000000000F1E5F728000000000FCC539] [region="{ID=12818149,startKey=748000000000000FFF1E5F728000000000FFAEA9D40000000000FA,endKey=748000000000000FFF1E5F728000000000FFFEA6C00000000000FA,epoch=\"conf_ver:5 version:2116 \",peers=\"id:12818150 store_id:1 ,id:12818151 store_id:2 ,id:12818152 store_id:7 \"}"] [leader="id:12818151 store_id:2 "] [commitTS=458836869270470659]
[2025/06/19 17:03:45.910 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499529] [startKey=748000000000000F1D5F7280000000004FFBF0] [endKey=748000000000000F1D5F728000000000A00A48] [remainStart=748000000000000F1D5F7280000000009E28CB] [region="{ID=12818169,startKey=748000000000000FFF1D5F728000000000FF4FFBF00000000000FA,endKey=748000000000000FFF1D5F728000000000FFA00A480000000000FA,epoch=\"conf_ver:5 version:2115 \",peers=\"id:12818170 store_id:1 ,id:12818171 store_id:2 ,id:12818172 store_id:7 \"}"] [leader="id:12818172 store_id:7 "] [commitTS=458836869270470659]
[2025/06/19 17:03:45.965 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835989] [startKey=748000000000000F1F5F7280000000001D78AA] [endKey=748000000000000F1F5F7280000000006D816D] [remainStart=748000000000000F1F5F7280000000006BA150] [region="{ID=12818117,startKey=748000000000000FFF1F5F728000000000FF1D78AA0000000000FA,endKey=748000000000000FFF1F5F728000000000FF6D816D0000000000FA,epoch=\"conf_ver:5 version:2117 \",peers=\"id:12818118 store_id:1 ,id:12818119 store_id:2 ,id:12818120 store_id:7 \"}"] [leader="id:12818120 store_id:7 "] [commitTS=458836869270470659]
[2025/06/19 17:03:46.015 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835481] [startKey=748000000000000F1E5F7280000000005EB5F1] [endKey=748000000000000F1E5F728000000000AEA9D4] [remainStart=748000000000000F1E5F728000000000ACCC43] [region="{ID=12818145,startKey=748000000000000FFF1E5F728000000000FF5EB5F10000000000FA,endKey=748000000000000FFF1E5F728000000000FFAEA9D40000000000FA,epoch=\"conf_ver:5 version:2116 \",peers=\"id:12818146 store_id:1 ,id:12818147 store_id:2 ,id:12818148 store_id:7 \"}"] [leader="id:12818148 store_id:7 "] [commitTS=458836869270470659]
[2025/06/19 17:03:48.445 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835939] [startKey=748000000000000F205F728000000000CC559F] [endKey=748000000000000F205F7280000000011C5802] [remainStart=748000000000000F205F7280000000011A7546] [region="{ID=12818181,startKey=748000000000000FFF205F728000000000FFCC559F0000000000FA,endKey=748000000000000FFF205F728000000001FF1C58020000000000FA,epoch=\"conf_ver:5 version:2119 \",peers=\"id:12818182 store_id:1 ,id:12818183 store_id:2 ,id:12818184 store_id:7 \"}"] [leader="id:12818182 store_id:1 "] [commitTS=458836869270470659]
[2025/06/19 17:04:06.750 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=1583618b-9acd-58b0-ad42-a0af1251b7b0] [size=777445676] [kvs=20001899] [importedSize=777445676] [importedCount=20001899]
[2025/06/19 17:04:06.838 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0] [retryCnt=0] [takeTime=29.985824962s] []
[2025/06/19 17:04:06.839 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0]
[2025/06/19 17:04:06.988 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0] [takeTime=148.883032ms] []
[2025/06/19 17:04:06.988 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`follows`:0] [engineUUID=1583618b-9acd-58b0-ad42-a0af1251b7b0] [takeTime=30.135705378s] []
[2025/06/19 17:04:06.988 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_advisor`.`follows`] [takeTime=1m36.533499355s] []
[2025/06/19 17:04:06.988 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08]
[2025/06/19 17:04:07.113 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08] [takeTime=125.133207ms] []
[2025/06/19 17:04:07.114 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08]
[2025/06/19 17:04:07.114 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08] [retryCnt=0]
[2025/06/19 17:04:07.116 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=38a9fd40-16a1-5d50-b175-db44eea15a08]
[2025/06/19 17:04:07.117 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08] [retryCnt=0] [takeTime=2.38825ms] []
[2025/06/19 17:04:07.117 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08]
[2025/06/19 17:04:07.231 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08] [takeTime=114.131375ms] []
[2025/06/19 17:04:07.231 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_advisor`.`follows`:-1] [engineUUID=38a9fd40-16a1-5d50-b175-db44eea15a08] [takeTime=117.320839ms] []
[2025/06/19 17:04:07.442 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_advisor`.`follows`] [takeTime=1m37.102432486s] []
[2025/06/19 17:04:07.442 +08:00] [INFO] [import.go:1148] ["cancel periodic actions"] [do=true]
[2025/06/19 17:04:07.442 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Normal]
[2025/06/19 17:04:08.949 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_advisor`.`tweets`] [checksum="{cksum=3741302022047040719,size=160505066,kvs=2500000}"]
[2025/06/19 17:04:08.949 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=tweets]
[2025/06/19 17:04:08.949 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_advisor`.`follows`] [checksum="{cksum=2729894676666860337,size=777445676,kvs=20001899}"]
[2025/06/19 17:04:08.949 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=follows]
[2025/06/19 17:04:10.495 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=tweets] [takeTime=1.545865816s] []
[2025/06/19 17:04:10.495 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_advisor`.`tweets`] [local="{cksum=3741302022047040719,size=160505066,kvs=2500000}"]
[2025/06/19 17:04:10.497 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_advisor`.`tweets`]
[2025/06/19 17:04:11.774 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=follows] [takeTime=2.824417872s] []
[2025/06/19 17:04:11.774 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_advisor`.`follows`] [local="{cksum=2729894676666860337,size=777445676,kvs=20001899}"]
[2025/06/19 17:04:11.775 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_advisor`.`follows`]
[2025/06/19 17:04:24.406 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_advisor`.`follows`] [takeTime=12.631037649s] []
[2025/06/19 17:04:24.407 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_advisor`.`users`] [checksum="{cksum=14061143131055759063,size=19388895,kvs=500000}"]
[2025/06/19 17:04:24.407 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=users]
[2025/06/19 17:04:24.712 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_advisor`.`tweets`] [takeTime=14.214993808s] []
[2025/06/19 17:04:24.786 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=users] [takeTime=378.541716ms] []
[2025/06/19 17:04:24.786 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_advisor`.`users`] [local="{cksum=14061143131055759063,size=19388895,kvs=500000}"]
[2025/06/19 17:04:24.787 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_advisor`.`users`]
[2025/06/19 17:04:31.142 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_advisor`.`users`] [takeTime=6.355165526s] []
[2025/06/19 17:04:31.143 +08:00] [INFO] [import.go:1412] ["restore all tables data completed"] [takeTime=2m7.547738735s] []
[2025/06/19 17:04:31.143 +08:00] [INFO] [import.go:1415] ["cleanup task metas"]
[2025/06/19 17:04:31.144 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=tikv-driver]
[2025/06/19 17:04:31.146 +08:00] [INFO] [import.go:1003] ["everything imported, stopping periodic actions"]
[2025/06/19 17:04:31.286 +08:00] [INFO] [import.go:1643] ["skip full compaction"]
[2025/06/19 17:04:31.286 +08:00] [INFO] [import.go:1793] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=14205129775852304]
[2025/06/19 17:04:31.286 +08:00] [INFO] [import.go:1801] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=14205129775852304] [takeTime=148.138µs] []
[2025/06/19 17:04:31.286 +08:00] [INFO] [import.go:584] ["the whole procedure completed"] [takeTime=2m10.686048098s] []
[2025/06/19 17:04:31.315 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 17:04:31.316 +08:00] [INFO] [checksum.go:510] ["service safe point keeper exited"]
[2025/06/19 17:04:31.316 +08:00] [INFO] [main.go:110] ["tidb lightning exit"] [finished=true]
[2025/06/19 17:21:21.681 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 17:21:21.681 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 17:21:21.681 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":8974206214588398217,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_proteus\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_proteus\",\"table-pattern\":\"\",\"target-schema\":\"tw_proteus\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 17:21:21.683 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 17:21:21.685 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.308847ms] []
[2025/06/19 17:21:21.765 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 17:21:21.765 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 17:21:21.823 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 17:21:21.826 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 17:21:21.826 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 17:21:21.829 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 17:21:21.829 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 17:21:21.831 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_advisor]
[2025/06/19 17:21:21.832 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=tw_advisor] [table=users]
[2025/06/19 17:21:21.832 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=tw_advisor] [table=tweets]
[2025/06/19 17:21:21.832 +08:00] [INFO] [schema_import.go:192] ["table already exists in downstream, skip"] [db=tw_advisor] [table=follows]
[2025/06/19 17:21:21.832 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=2.730997ms] []
[2025/06/19 17:21:21.853 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=users] [path=tw_advisor.users.sql]
[2025/06/19 17:21:21.855 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=tweets] [path=tw_advisor.tweets.sql]
[2025/06/19 17:21:21.856 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_advisor] [table=follows] [path=tw_advisor.follows.sql]
[2025/06/19 17:21:21.894 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:21:21.896 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:21:21.902 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 17:21:21.939 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:21:21.940 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 17:21:21.971 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:21:21.996 +08:00] [ERROR] [import.go:574] ["run failed"] [step=2] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`tw_advisor`.`follows`, `tw_advisor`.`tweets`, `tw_advisor`.`users`] are not empty"]
[2025/06/19 17:21:21.996 +08:00] [ERROR] [import.go:584] ["the whole procedure failed"] [takeTime=169.215412ms] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`tw_advisor`.`follows`, `tw_advisor`.`tweets`, `tw_advisor`.`users`] are not empty"]
[2025/06/19 17:21:21.997 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 17:21:21.998 +08:00] [ERROR] [main.go:107] ["tidb lightning encountered error stack info"] [error="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`tw_advisor`.`follows`, `tw_advisor`.`tweets`, `tw_advisor`.`users`] are not empty"] [errorVerbose="[Lightning:PreCheck:ErrPreCheckFailed]tidb-lightning pre-check failed: table(s) [`tw_advisor`.`follows`, `tw_advisor`.`tweets`, `tw_advisor`.`users`] are not empty\ngithub.com/pingcap/errors.AddStack\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/lightning/pkg/importer.(*Controller).preCheckRequirements\n\t/workspace/source/tidb/lightning/pkg/importer/import.go:1929\ngithub.com/pingcap/tidb/lightning/pkg/importer.(*Controller).Run\n\t/workspace/source/tidb/lightning/pkg/importer/import.go:562\ngithub.com/pingcap/tidb/lightning/pkg/server.(*Lightning).run\n\t/workspace/source/tidb/lightning/pkg/server/lightning.go:616\ngithub.com/pingcap/tidb/lightning/pkg/server.(*Lightning).RunOnceWithOptions\n\t/workspace/source/tidb/lightning/pkg/server/lightning.go:399\nmain.main.func2\n\t/workspace/source/tidb/lightning/cmd/tidb-lightning/main.go:96\nmain.main\n\t/workspace/source/tidb/lightning/cmd/tidb-lightning/main.go:97\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:272\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:23:50.387 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 17:23:50.387 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 17:23:50.387 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":5265407895072682971,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_proteus\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_proteus\",\"table-pattern\":\"\",\"target-schema\":\"tw_proteus\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 17:23:50.389 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 17:23:50.390 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.118841ms] []
[2025/06/19 17:23:50.421 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 17:23:50.422 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 17:23:50.471 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 17:23:50.473 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 17:23:50.473 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 17:23:50.475 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 17:23:50.475 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 17:23:50.477 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_proteus]
[2025/06/19 17:23:56.652 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=6.17665022s] []
[2025/06/19 17:23:56.672 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_proteus] [table=users] [path=tw_proteus.users.sql]
[2025/06/19 17:23:56.674 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_proteus] [table=tweets] [path=tw_proteus.tweets.sql]
[2025/06/19 17:23:56.675 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_proteus] [table=follows] [path=tw_proteus.follows.sql]
[2025/06/19 17:23:56.680 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_proteus`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:23:56.679 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_proteus`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:23:56.682 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_proteus`.`follows` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:23:56.683 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:23:56.685 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:23:56.687 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 17:23:56.730 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:23:56.731 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 17:23:56.751 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:23:56.921 +08:00] [INFO] [import.go:1276] ["restore all tables data start"]
[2025/06/19 17:23:56.936 +08:00] [INFO] [checksum_helper.go:52] ["set tidb_backoff_weight to default"] [backoff_weight=30]
[2025/06/19 17:23:57.289 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_proteus`.`users`]
[2025/06/19 17:23:57.289 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_proteus`.`tweets`]
[2025/06/19 17:23:57.288 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Import]
[2025/06/19 17:23:57.289 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_proteus`.`tweets`]
[2025/06/19 17:23:57.289 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_proteus`.`users`]
[2025/06/19 17:23:57.290 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=547.589µs]
[2025/06/19 17:23:57.290 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=508.835µs]
[2025/06/19 17:23:57.290 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_proteus`.`tweets`] [enginesCnt=2] [filesCnt=1] [takeTime=610.469µs] []
[2025/06/19 17:23:57.290 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_proteus`.`users`] [enginesCnt=2] [filesCnt=1] [takeTime=598.227µs] []
[2025/06/19 17:23:57.290 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_proteus`.`tweets`] [table=`tw_proteus`.`tweets`] [count=25833363]
[2025/06/19 17:23:57.290 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_proteus`.`users`] [table=`tw_proteus`.`users`] [count=3069463]
[2025/06/19 17:23:57.291 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:23:57.291 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:23:58.322 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756]
[2025/06/19 17:23:58.323 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_proteus`.`tweets`]
[2025/06/19 17:23:58.323 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_proteus`.`tweets`] [engineNumber=0]
[2025/06/19 17:23:58.323 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_proteus`.`tweets`] [engineNumber=0]
[2025/06/19 17:23:58.398 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b]
[2025/06/19 17:23:58.399 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_proteus`.`users`]
[2025/06/19 17:23:58.399 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_proteus`.`users`] [engineNumber=0]
[2025/06/19 17:23:58.399 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_proteus`.`users`] [engineNumber=0]
[2025/06/19 17:23:58.972 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7]
[2025/06/19 17:23:58.978 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_proteus`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.tweets.sql:0]
[2025/06/19 17:23:59.055 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5]
[2025/06/19 17:23:59.058 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_proteus`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.users.sql:0]
[2025/06/19 17:24:00.418 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_proteus`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.users.sql:0] [readDur=247.050383ms] [encodeDur=1.010989512s] [deliverDur=149.256283ms] [checksum="{cksum=5001560770747020645,size=19388895,kvs=500000}"] [takeTime=1.360228382s] []
[2025/06/19 17:24:00.550 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_proteus`.`users`] [engineNumber=0] [read(bytes)=0] [written=19388895] [takeTime=2.151465546s] []
[2025/06/19 17:24:00.550 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5]
[2025/06/19 17:24:00.551 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=19388895] [kvs=500000] [files=1] [sstFileSize=4188349] [file=/data3/dzh/project/grep/dev/twitter/cache/a7e1f304-d19f-53f2-8288-50280d6819b5.sst/34bf6694-ea41-4191-a92e-5e7895dda316.sst] [firstKey=748000000000000F4C5F728000000000000001] [lastKey=748000000000000F4E5F72800000000007A120]
[2025/06/19 17:24:00.615 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5] [takeTime=64.908223ms] []
[2025/06/19 17:24:00.658 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_proteus`.`users`] [engineNumber=0] [takeTime=2.258864567s] []
[2025/06/19 17:24:00.658 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5]
[2025/06/19 17:24:00.658 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5] [retryCnt=0]
[2025/06/19 17:24:00.662 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:24:00.701 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=a7e1f304-d19f-53f2-8288-50280d6819b5] ["region ranges"=1] [count=500000] [size=19388895]
[2025/06/19 17:24:00.702 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=2]
[2025/06/19 17:24:00.705 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f4c5f728000000000000001] [endOfAllRanges=748000000000000f4e5f72800000000007a121] [startKeyOfFirstRegion=748000000000000fff4c00000000000000f8] [endKeyOfLastRegion=748000000000000fff4f00000000000000f8]
[2025/06/19 17:24:01.544 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818385 is conf_ver: 5 version: 2132, but you sent conf_ver: 5 version: 2131"] [region="{ID=12818389,startKey=748000000000000FFF4E00000000000000F8,endKey=748000000000000FFF4E5F728000000000FF07A1210000000000FA,epoch=\"conf_ver:5 version:2132 \",peers=\"id:12818390 store_id:1 ,id:12818391 store_id:2 ,id:12818392 store_id:7 \"}"] [start=748000000000000F4E] [end=748000000000000F4E5F72800000000007A121]
[2025/06/19 17:24:01.546 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F4E] [endKey=748000000000000F4E5F72800000000007A121] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:24:03.546 +08:00]
[2025/06/19 17:24:01.717 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818377 is conf_ver: 5 version: 2130, but you sent conf_ver: 5 version: 2129"] [region="{ID=12818377,startKey=748000000000000FFF4C5F728000000000FF0000010000000000FA,endKey=748000000000000FFF4D00000000000000F8,epoch=\"conf_ver:5 version:2130 \",peers=\"id:12818378 store_id:1 ,id:12818379 store_id:2 ,id:12818380 store_id:7 \"}"] [start=748000000000000F4C5F728000000000000001] [end=748000000000000F4D]
[2025/06/19 17:24:01.717 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F4C5F728000000000000001] [endKey=748000000000000F4D] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:24:03.717 +08:00]
[2025/06/19 17:24:04.195 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=a7e1f304-d19f-53f2-8288-50280d6819b5] [size=19388895] [kvs=500000] [importedSize=19388895] [importedCount=500000]
[2025/06/19 17:24:04.221 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5] [retryCnt=0] [takeTime=3.563716179s] []
[2025/06/19 17:24:04.222 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5]
[2025/06/19 17:24:04.245 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5] [takeTime=23.042455ms] []
[2025/06/19 17:24:04.245 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`users`:0] [engineUUID=a7e1f304-d19f-53f2-8288-50280d6819b5] [takeTime=3.587705251s] []
[2025/06/19 17:24:04.245 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_proteus`.`users`] [takeTime=5.84685937s] []
[2025/06/19 17:24:04.245 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b]
[2025/06/19 17:24:04.280 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b] [takeTime=34.142331ms] []
[2025/06/19 17:24:04.280 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b]
[2025/06/19 17:24:04.280 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b] [retryCnt=0]
[2025/06/19 17:24:04.283 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b]
[2025/06/19 17:24:04.283 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b] [retryCnt=0] [takeTime=2.705089ms] []
[2025/06/19 17:24:04.284 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b]
[2025/06/19 17:24:04.307 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b] [takeTime=23.626143ms] []
[2025/06/19 17:24:04.307 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`users`:-1] [engineUUID=aaea7edf-b7bc-5e5a-82cd-d5b42a67082b] [takeTime=27.066956ms] []
[2025/06/19 17:24:04.309 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_proteus`.`users`] [takeTime=7.019787953s] []
[2025/06/19 17:24:04.309 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_proteus`.`follows`]
[2025/06/19 17:24:04.309 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_proteus`.`follows`]
[2025/06/19 17:24:04.309 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=54.548µs]
[2025/06/19 17:24:04.309 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_proteus`.`follows`] [enginesCnt=2] [filesCnt=1] [takeTime=97.553µs] []
[2025/06/19 17:24:04.309 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_proteus`.`follows`] [table=`tw_proteus`.`follows`] [count=88897226]
[2025/06/19 17:24:04.310 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:24:04.461 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9]
[2025/06/19 17:24:04.462 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_proteus`.`follows`]
[2025/06/19 17:24:04.462 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_proteus`.`follows`] [engineNumber=0]
[2025/06/19 17:24:04.462 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_proteus`.`follows`] [engineNumber=0]
[2025/06/19 17:24:04.637 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4]
[2025/06/19 17:24:04.658 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_proteus`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.follows.sql:0]
[2025/06/19 17:24:05.013 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=120851621] [kvs=1889947] [files=1] [sstFileSize=25820100] [file=/data3/dzh/project/grep/dev/twitter/cache/b1178a5c-9917-5849-8846-25ecfc2ef5e7.sst/582cdfcb-d8d3-4a4d-b638-5d3f7c20b0d0.sst] [firstKey=748000000000000F415F728000000000000001] [lastKey=748000000000000F445F7280000000001CD69B]
[2025/06/19 17:24:06.686 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_proteus`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.tweets.sql:0] [readDur=1.639717835s] [encodeDur=5.099815856s] [deliverDur=1.569267927s] [checksum="{cksum=5896666013909211690,size=160505066,kvs=2500000}"] [takeTime=7.705891184s] []
[2025/06/19 17:24:06.869 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_proteus`.`tweets`] [engineNumber=0] [read(bytes)=0] [written=160505066] [takeTime=8.546428909s] []
[2025/06/19 17:24:06.870 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=39653445] [kvs=610053] [files=1] [sstFileSize=8357580] [file=/data3/dzh/project/grep/dev/twitter/cache/b1178a5c-9917-5849-8846-25ecfc2ef5e7.sst/2342b3ea-5848-48c9-8397-2b5c513c7ea9.sst] [firstKey=748000000000000F445F7280000000001CD69C] [lastKey=748000000000000F445F7280000000002625A0]
[2025/06/19 17:24:06.870 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7]
[2025/06/19 17:24:06.920 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [takeTime=50.179649ms] []
[2025/06/19 17:24:06.954 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_proteus`.`tweets`] [engineNumber=0] [takeTime=8.630739044s] []
[2025/06/19 17:24:06.954 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7]
[2025/06/19 17:24:06.954 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [retryCnt=0]
[2025/06/19 17:24:06.957 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [totalSize=160505066] [totalCount=2500000] [startKey=748000000000000F415F728000000000000001] [endKey=748000000000000F445F7280000000002625A1] [len(keys)=3] []
[2025/06/19 17:24:06.957 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:24:06.991 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=b1178a5c-9917-5849-8846-25ecfc2ef5e7] ["region ranges"=2] [count=2500000] [size=160505066]
[2025/06/19 17:24:06.991 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=3]
[2025/06/19 17:24:06.991 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=b1178a5c-9917-5849-8846-25ecfc2ef5e7]
[2025/06/19 17:24:06.992 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF415F728000000000FF0000010000000000FA] [end=748000000000000FFF445F728000000000FF2625A10000000000FB]
[2025/06/19 17:24:07.234 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818337,startKey=748000000000000FFF4100000000000000F8,endKey=748000000000000FFF4200000000000000F8,epoch=\"conf_ver:5 version:2121 \",peers=\"id:12818338 store_id:1 ,id:12818339 store_id:2 ,id:12818340 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F415F728000000000000001]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818337 is conf_ver: 5 version: 2122\" epoch_not_match:<current_regions:<id:12818337 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377A_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377B\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2122 > peers:<id:12818338 store_id:1 > peers:<id:12818339 store_id:2 > peers:<id:12818340 store_id:7 > > > "]
[2025/06/19 17:24:07.237 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818337] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818337 is conf_ver: 5 version: 2122\" epoch_not_match:<current_regions:<id:12818337 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377A_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377B\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2122 > peers:<id:12818338 store_id:1 > peers:<id:12818339 store_id:2 > peers:<id:12818340 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818337 is conf_ver: 5 version: 2122\" epoch_not_match:<current_regions:<id:12818337 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377A_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377B\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2122 > peers:<id:12818338 store_id:1 > peers:<id:12818339 store_id:2 > peers:<id:12818340 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:24:07.339 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818357,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF4800000000000000F8,epoch=\"conf_ver:5 version:2124 \",peers=\"id:12818358 store_id:1 ,id:12818359 store_id:2 ,id:12818360 store_id:7 \"}"] [keys="{total=2,keys=\"[748000000000000F445F728000000000140001,748000000000000F445F7280000000002625A1]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818357 is conf_ver: 5 version: 2125\" epoch_not_match:<current_regions:<id:12818357 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377D_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2125 > peers:<id:12818358 store_id:1 > peers:<id:12818359 store_id:2 > peers:<id:12818360 store_id:7 > > > "]
[2025/06/19 17:24:07.339 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818357] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818357 is conf_ver: 5 version: 2125\" epoch_not_match:<current_regions:<id:12818357 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377D_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2125 > peers:<id:12818358 store_id:1 > peers:<id:12818359 store_id:2 > peers:<id:12818360 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818357 is conf_ver: 5 version: 2125\" epoch_not_match:<current_regions:<id:12818357 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377D_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2125 > peers:<id:12818358 store_id:1 > peers:<id:12818359 store_id:2 > peers:<id:12818360 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:24:07.340 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818357 is conf_ver: 5 version: 2125\" epoch_not_match:<current_regions:<id:12818357 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377D_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2125 > peers:<id:12818358 store_id:1 > peers:<id:12818359 store_id:2 > peers:<id:12818360 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818357 is conf_ver: 5 version: 2125\" epoch_not_match:<current_regions:<id:12818357 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377D_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2125 > peers:<id:12818358 store_id:1 > peers:<id:12818359 store_id:2 > peers:<id:12818360 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"] [backoff=50ms]
[2025/06/19 17:24:07.392 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=5] [start=748000000000000FFF415F728000000000FF0000010000000000FA] [end=748000000000000FFF445F728000000000FF2625A10000000000FB]
[2025/06/19 17:24:07.394 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818401,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF445F728000000000FF2625A10000000000FA,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818402 store_id:1 ,id:12818403 store_id:2 ,id:12818404 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F445F728000000000140001]\"}"] [regionErr="message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > "]
[2025/06/19 17:24:07.395 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818404]
[2025/06/19 17:24:07.395 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=0] [regionID=12818401] ["new leader"="id:12818404 store_id:7 "]
[2025/06/19 17:24:07.397 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818401,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF445F728000000000FF2625A10000000000FA,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818402 store_id:1 ,id:12818403 store_id:2 ,id:12818404 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F445F728000000000140001]\"}"] [regionErr="message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > "]
[2025/06/19 17:24:07.397 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818404]
[2025/06/19 17:24:07.398 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=1] [regionID=12818401] ["new leader"="id:12818404 store_id:7 "]
[2025/06/19 17:24:07.399 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818401,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF445F728000000000FF2625A10000000000FA,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818402 store_id:1 ,id:12818403 store_id:2 ,id:12818404 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F445F728000000000140001]\"}"] [regionErr="message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > "]
[2025/06/19 17:24:07.400 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818404]
[2025/06/19 17:24:07.400 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=2] [regionID=12818401] ["new leader"="id:12818404 store_id:7 "]
[2025/06/19 17:24:07.401 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818401,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF445F728000000000FF2625A10000000000FA,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818402 store_id:1 ,id:12818403 store_id:2 ,id:12818404 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F445F728000000000140001]\"}"] [regionErr="message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > "]
[2025/06/19 17:24:07.402 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818404]
[2025/06/19 17:24:07.402 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=3] [regionID=12818401] ["new leader"="id:12818404 store_id:7 "]
[2025/06/19 17:24:07.403 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818401] [error="split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="the following errors occurred:\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:24:07.403 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="the following errors occurred:\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818401, leader may None\" not_leader:<region_id:12818401 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700"] [backoff=100ms]
[2025/06/19 17:24:07.504 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF445F728000000000FF1400010000000000FA] [end=748000000000000FFF445F728000000000FF1400010000000000FB]
[2025/06/19 17:24:07.507 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818401,startKey=748000000000000FFF4400000000000000F8,endKey=748000000000000FFF445F728000000000FF2625A10000000000FA,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818402 store_id:1 ,id:12818403 store_id:2 ,id:12818404 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F445F728000000000140001]\"}"] [regionErr="message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818401] 12818404 peer has not applied to current term, applied_term 5, current_term 6\\\"\" "]
[2025/06/19 17:24:07.508 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818401] [error="split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818401] 12818404 peer has not applied to current term, applied_term 5, current_term 6\\\"\" : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818401] 12818404 peer has not applied to current term, applied_term 5, current_term 6\\\"\" \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:24:07.508 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818401] 12818404 peer has not applied to current term, applied_term 5, current_term 6\\\"\" : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818401] 12818404 peer has not applied to current term, applied_term 5, current_term 6\\\"\" \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"] [backoff=200ms]
[2025/06/19 17:24:07.709 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF445F728000000000FF1400010000000000FA] [end=748000000000000FFF445F728000000000FF1400010000000000FB]
[2025/06/19 17:24:07.873 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=1]
[2025/06/19 17:24:08.190 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=1] [take=315.676896ms]
[2025/06/19 17:24:08.191 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [takeTime=1.199161216s] []
[2025/06/19 17:24:08.192 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=4] [startOfAllRanges=748000000000000f415f728000000000000001] [endOfAllRanges=748000000000000f445f728000000000140001] [startKeyOfFirstRegion=748000000000000fff415f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff445f728000000000ff1400010000000000fa]
[2025/06/19 17:24:08.192 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f445f728000000000140001] [endOfAllRanges=748000000000000f445f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff445f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff445f728000000000ff2625a10000000000fa]
[2025/06/19 17:24:11.317 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [size=160505066] [kvs=2500000] [importedSize=160505066] [importedCount=2500000]
[2025/06/19 17:24:11.336 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [retryCnt=0] [takeTime=4.381847505s] []
[2025/06/19 17:24:11.337 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7]
[2025/06/19 17:24:11.410 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [takeTime=73.287006ms] []
[2025/06/19 17:24:11.410 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`tweets`:0] [engineUUID=b1178a5c-9917-5849-8846-25ecfc2ef5e7] [takeTime=4.456132978s] []
[2025/06/19 17:24:11.410 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_proteus`.`tweets`] [takeTime=13.087205264s] []
[2025/06/19 17:24:11.410 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756]
[2025/06/19 17:24:11.523 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756] [takeTime=112.761078ms] []
[2025/06/19 17:24:11.524 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756]
[2025/06/19 17:24:11.524 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756] [retryCnt=0]
[2025/06/19 17:24:11.526 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=95319eb7-17cc-58ec-94b9-cc73d534f756]
[2025/06/19 17:24:11.526 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756] [retryCnt=0] [takeTime=2.498296ms] []
[2025/06/19 17:24:11.527 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756]
[2025/06/19 17:24:11.640 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756] [takeTime=113.284749ms] []
[2025/06/19 17:24:11.640 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`tweets`:-1] [engineUUID=95319eb7-17cc-58ec-94b9-cc73d534f756] [takeTime=116.582802ms] []
[2025/06/19 17:24:11.641 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_proteus`.`tweets`] [takeTime=14.352378094s] []
[2025/06/19 17:25:00.630 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_proteus`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_proteus.follows.sql:0] [readDur=5.109836202s] [encodeDur=31.389029418s] [deliverDur=21.239311382s] [checksum="{cksum=5537136570772654355,size=777445676,kvs=20001899}"] [takeTime=55.971781016s] []
[2025/06/19 17:25:01.832 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_proteus`.`follows`] [engineNumber=0] [read(bytes)=0] [written=777445676] [takeTime=57.370052973s] []
[2025/06/19 17:25:01.832 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4]
[2025/06/19 17:25:09.289 +08:00] [INFO] [engine.go:1685] ["compact sst"] [fileCount=7] [size=777445676] [count=20001899] [cost=7.457026813s] [file=/data3/dzh/project/grep/dev/twitter/cache/71fcbd5a-5fac-53fc-8477-ca99f03a3dc4.sst/3c36ee72-4a4d-4f8a-8556-0e447babd388.sst]
[2025/06/19 17:25:09.289 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=777445676] [kvs=20001899] [files=1] [sstFileSize=304060722] [file=/data3/dzh/project/grep/dev/twitter/cache/71fcbd5a-5fac-53fc-8477-ca99f03a3dc4.sst/3c36ee72-4a4d-4f8a-8556-0e447babd388.sst] [firstKey=748000000000000F485F728000000000000003] [lastKey=748000000000000F4B5F72800000000131346B]
[2025/06/19 17:25:09.456 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [takeTime=7.624559596s] []
[2025/06/19 17:25:09.506 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_proteus`.`follows`] [engineNumber=0] [takeTime=1m5.044469894s] []
[2025/06/19 17:25:09.506 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4]
[2025/06/19 17:25:09.506 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [retryCnt=0]
[2025/06/19 17:25:09.511 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [totalSize=777445676] [totalCount=20001899] [startKey=748000000000000F485F728000000000000003] [endKey=748000000000000F4B5F72800000000131346C] [len(keys)=17] []
[2025/06/19 17:25:09.511 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:25:09.553 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] ["region ranges"=16] [count=20001899] [size=777445676]
[2025/06/19 17:25:09.553 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=17]
[2025/06/19 17:25:09.553 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4]
[2025/06/19 17:25:09.554 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF485F728000000000FF0000030000000000FA] [end=748000000000000FFF4B5F728000000001FF31346C0000000000FB]
[2025/06/19 17:25:09.768 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818373,startKey=748000000000000FFF4B00000000000000F8,endKey=748000000000000FFF4C00000000000000F8,epoch=\"conf_ver:5 version:2128 \",peers=\"id:12818374 store_id:1 ,id:12818375 store_id:2 ,id:12818376 store_id:7 \"}"] [keys="{total=5,keys=\"[748000000000000F4B5F7280000000002C561E,\\\"(skip 3)\\\",748000000000000F4B5F72800000000131346C]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818373 is conf_ver: 5 version: 2129\" epoch_not_match:<current_regions:<id:12818373 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377K_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377L\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2129 > peers:<id:12818374 store_id:1 > peers:<id:12818375 store_id:2 > peers:<id:12818376 store_id:7 > > > "]
[2025/06/19 17:25:09.769 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818373] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818373 is conf_ver: 5 version: 2129\" epoch_not_match:<current_regions:<id:12818373 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377K_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377L\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2129 > peers:<id:12818374 store_id:1 > peers:<id:12818375 store_id:2 > peers:<id:12818376 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818373 is conf_ver: 5 version: 2129\" epoch_not_match:<current_regions:<id:12818373 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377K_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377L\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2129 > peers:<id:12818374 store_id:1 > peers:<id:12818375 store_id:2 > peers:<id:12818376 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:25:09.901 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818361,startKey=748000000000000FFF4800000000000000F8,endKey=748000000000000FFF4900000000000000F8,epoch=\"conf_ver:5 version:2125 \",peers=\"id:12818362 store_id:1 ,id:12818363 store_id:2 ,id:12818364 store_id:7 \"}"] [keys="{total=4,keys=\"[748000000000000F485F728000000000000003,748000000000000F485F7280000000004FFBF0,748000000000000F485F728000000000A00A48,748000000000000F485F728000000000F00CE3]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818361 is conf_ver: 5 version: 2126\" epoch_not_match:<current_regions:<id:12818361 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2126 > peers:<id:12818362 store_id:1 > peers:<id:12818363 store_id:2 > peers:<id:12818364 store_id:7 > > > "]
[2025/06/19 17:25:09.902 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818361] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818361 is conf_ver: 5 version: 2126\" epoch_not_match:<current_regions:<id:12818361 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2126 > peers:<id:12818362 store_id:1 > peers:<id:12818363 store_id:2 > peers:<id:12818364 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818361 is conf_ver: 5 version: 2126\" epoch_not_match:<current_regions:<id:12818361 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377H_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2126 > peers:<id:12818362 store_id:1 > peers:<id:12818363 store_id:2 > peers:<id:12818364 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:25:09.973 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818461 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2130 > peers:<id:12818462 store_id:1 > peers:<id:12818463 store_id:2 > peers:<id:12818464 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818461 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2130 > peers:<id:12818462 store_id:1 > peers:<id:12818463 store_id:2 > peers:<id:12818464 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:25:09.973 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818481 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377J\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377J_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2131 > peers:<id:12818482 store_id:1 > peers:<id:12818483 store_id:2 > peers:<id:12818484 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818481 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377J\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377J_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2131 > peers:<id:12818482 store_id:1 > peers:<id:12818483 store_id:2 > peers:<id:12818484 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:25:09.985 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818461 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2130 > peers:<id:12818462 store_id:1 > peers:<id:12818463 store_id:2 > peers:<id:12818464 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818461 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377I_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2130 > peers:<id:12818462 store_id:1 > peers:<id:12818463 store_id:2 > peers:<id:12818464 store_id:7 > "] [backoff=20ms]
[2025/06/19 17:25:10.295 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:25:10.618 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:25:10.771 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=13] [start=748000000000000FFF485F728000000000FF0000030000000000FA] [end=748000000000000FFF4B5F728000000001FF31346C0000000000FB]
[2025/06/19 17:25:11.596 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=3]
[2025/06/19 17:25:11.789 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:25:12.116 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=7] [take=325.484676ms]
[2025/06/19 17:25:12.116 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [takeTime=2.563121026s] []
[2025/06/19 17:25:12.118 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f485f728000000000f00ce3] [endOfAllRanges=748000000000000f495f7280000000000ecade] [startKeyOfFirstRegion=748000000000000fff485f728000000000fff00ce30000000000fa] [endKeyOfLastRegion=748000000000000fff495f728000000000ff0ecade0000000000fa]
[2025/06/19 17:25:12.118 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f495f7280000000000ecade] [endOfAllRanges=748000000000000f495f7280000000005eb5f1] [startKeyOfFirstRegion=748000000000000fff495f728000000000ff0ecade0000000000fa] [endKeyOfLastRegion=748000000000000fff495f728000000000ff5eb5f10000000000fa]
[2025/06/19 17:25:12.118 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f485f728000000000000003] [endOfAllRanges=748000000000000f485f7280000000004ffbf0] [startKeyOfFirstRegion=748000000000000fff485f728000000000ff0000030000000000fa] [endKeyOfLastRegion=748000000000000fff485f728000000000ff4ffbf00000000000fa]
[2025/06/19 17:25:12.118 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f495f7280000000005eb5f1] [endOfAllRanges=748000000000000f495f728000000000aea9d4] [startKeyOfFirstRegion=748000000000000fff495f728000000000ff5eb5f10000000000fa] [endKeyOfLastRegion=748000000000000fff495f728000000000ffaea9d40000000000fa]
[2025/06/19 17:25:12.118 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4a5f728000000000bd77cc] [endOfAllRanges=748000000000000f4a5f7280000000010d7c06] [startKeyOfFirstRegion=748000000000000fff4a5f728000000000ffbd77cc0000000000fa] [endKeyOfLastRegion=748000000000000fff4a5f728000000001ff0d7c060000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f485f7280000000004ffbf0] [endOfAllRanges=748000000000000f485f728000000000a00a48] [startKeyOfFirstRegion=748000000000000fff485f728000000000ff4ffbf00000000000fa] [endKeyOfLastRegion=748000000000000fff485f728000000000ffa00a480000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f4a5f7280000000010d7c06] [endOfAllRanges=748000000000000f4b5f7280000000002c561e] [startKeyOfFirstRegion=748000000000000fff4a5f728000000001ff0d7c060000000000fa] [endKeyOfLastRegion=748000000000000fff4b5f728000000000ff2c561e0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4b5f7280000000011c5802] [endOfAllRanges=748000000000000f4b5f72800000000131346c] [startKeyOfFirstRegion=748000000000000fff4b5f728000000001ff1c58020000000000fa] [endKeyOfLastRegion=748000000000000fff4b5f728000000001ff31346c0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f485f728000000000a00a48] [endOfAllRanges=748000000000000f485f728000000000f00ce3] [startKeyOfFirstRegion=748000000000000fff485f728000000000ffa00a480000000000fa] [endKeyOfLastRegion=748000000000000fff485f728000000000fff00ce30000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4b5f7280000000002c561e] [endOfAllRanges=748000000000000f4b5f7280000000007c6697] [startKeyOfFirstRegion=748000000000000fff4b5f728000000000ff2c561e0000000000fa] [endKeyOfLastRegion=748000000000000fff4b5f728000000000ff7c66970000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4b5f7280000000007c6697] [endOfAllRanges=748000000000000f4b5f728000000000cc559f] [startKeyOfFirstRegion=748000000000000fff4b5f728000000000ff7c66970000000000fa] [endKeyOfLastRegion=748000000000000fff4b5f728000000000ffcc559f0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4a5f7280000000001d78aa] [endOfAllRanges=748000000000000f4a5f7280000000006d816d] [startKeyOfFirstRegion=748000000000000fff4a5f728000000000ff1d78aa0000000000fa] [endKeyOfLastRegion=748000000000000fff4a5f728000000000ff6d816d0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4a5f7280000000006d816d] [endOfAllRanges=748000000000000f4a5f728000000000bd77cc] [startKeyOfFirstRegion=748000000000000fff4a5f728000000000ff6d816d0000000000fa] [endKeyOfLastRegion=748000000000000fff4a5f728000000000ffbd77cc0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f495f728000000000fea6c0] [endOfAllRanges=748000000000000f4a5f7280000000001d78aa] [startKeyOfFirstRegion=748000000000000fff495f728000000000fffea6c00000000000fa] [endKeyOfLastRegion=748000000000000fff4a5f728000000000ff1d78aa0000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f495f728000000000aea9d4] [endOfAllRanges=748000000000000f495f728000000000fea6c0] [startKeyOfFirstRegion=748000000000000fff495f728000000000ffaea9d40000000000fa] [endKeyOfLastRegion=748000000000000fff495f728000000000fffea6c00000000000fa]
[2025/06/19 17:25:12.122 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f4b5f728000000000cc559f] [endOfAllRanges=748000000000000f4b5f7280000000011c5802] [startKeyOfFirstRegion=748000000000000fff4b5f728000000000ffcc559f0000000000fa] [endKeyOfLastRegion=748000000000000fff4b5f728000000001ff1c58020000000000fa]
[2025/06/19 17:25:14.808 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835527] [startKey=748000000000000F495F728000000000AEA9D4] [endKey=748000000000000F495F728000000000FEA6C0] [remainStart=748000000000000F495F728000000000FCC539] [region="{ID=12818485,startKey=748000000000000FFF495F728000000000FFAEA9D40000000000FA,endKey=748000000000000FFF495F728000000000FFFEA6C00000000000FA,epoch=\"conf_ver:5 version:2130 \",peers=\"id:12818486 store_id:1 ,id:12818487 store_id:2 ,id:12818488 store_id:7 \"}"] [leader="id:12818486 store_id:1 "] [commitTS=458837208497913857]
[2025/06/19 17:25:16.400 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835564] [startKey=748000000000000F4A5F728000000000BD77CC] [endKey=748000000000000F4A5F7280000000010D7C06] [remainStart=748000000000000F4A5F7280000000010BA027] [region="{ID=12818497,startKey=748000000000000FFF4A5F728000000000FFBD77CC0000000000FA,endKey=748000000000000FFF4A5F728000000001FF0D7C060000000000FA,epoch=\"conf_ver:5 version:2131 \",peers=\"id:12818498 store_id:1 ,id:12818499 store_id:2 ,id:12818500 store_id:7 \"}"] [leader="id:12818500 store_id:7 "] [commitTS=458837208497913857]
[2025/06/19 17:25:16.488 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835575] [startKey=748000000000000F4A5F7280000000006D816D] [endKey=748000000000000F4A5F728000000000BD77CC] [remainStart=748000000000000F4A5F728000000000BB9A01] [region="{ID=12818493,startKey=748000000000000FFF4A5F728000000000FF6D816D0000000000FA,endKey=748000000000000FFF4A5F728000000000FFBD77CC0000000000FA,epoch=\"conf_ver:5 version:2131 \",peers=\"id:12818494 store_id:1 ,id:12818495 store_id:2 ,id:12818496 store_id:7 \"}"] [leader="id:12818494 store_id:1 "] [commitTS=458837208497913857]
[2025/06/19 17:25:16.853 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835989] [startKey=748000000000000F4A5F7280000000001D78AA] [endKey=748000000000000F4A5F7280000000006D816D] [remainStart=748000000000000F4A5F7280000000006BA150] [region="{ID=12818489,startKey=748000000000000FFF4A5F728000000000FF1D78AA0000000000FA,endKey=748000000000000FFF4A5F728000000000FF6D816D0000000000FA,epoch=\"conf_ver:5 version:2131 \",peers=\"id:12818490 store_id:1 ,id:12818491 store_id:2 ,id:12818492 store_id:7 \"}"] [leader="id:12818492 store_id:7 "] [commitTS=458837208497913857]
[2025/06/19 17:25:16.963 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836406] [startKey=748000000000000F4B5F7280000000002C561E] [endKey=748000000000000F4B5F7280000000007C6697] [remainStart=748000000000000F4B5F7280000000007A86A4] [region="{ID=12818517,startKey=748000000000000FFF4B5F728000000000FF2C561E0000000000FA,endKey=748000000000000FFF4B5F728000000000FF7C66970000000000FA,epoch=\"conf_ver:5 version:2133 \",peers=\"id:12818518 store_id:1 ,id:12818519 store_id:2 ,id:12818520 store_id:7 \"}"] [leader="id:12818519 store_id:2 "] [commitTS=458837208497913857]
[2025/06/19 17:25:18.122 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835481] [startKey=748000000000000F495F7280000000005EB5F1] [endKey=748000000000000F495F728000000000AEA9D4] [remainStart=748000000000000F495F728000000000ACCC43] [region="{ID=12818477,startKey=748000000000000FFF495F728000000000FF5EB5F10000000000FA,endKey=748000000000000FFF495F728000000000FFAEA9D40000000000FA,epoch=\"conf_ver:5 version:2130 \",peers=\"id:12818478 store_id:1 ,id:12818479 store_id:2 ,id:12818480 store_id:7 \"}"] [leader="id:12818479 store_id:2 "] [commitTS=458837208497913857]
[2025/06/19 17:25:18.220 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835605] [startKey=748000000000000F495F7280000000000ECADE] [endKey=748000000000000F495F7280000000005EB5F1] [remainStart=748000000000000F495F7280000000005CD674] [region="{ID=12818473,startKey=748000000000000FFF495F728000000000FF0ECADE0000000000FA,endKey=748000000000000FFF495F728000000000FF5EB5F10000000000FA,epoch=\"conf_ver:5 version:2130 \",peers=\"id:12818474 store_id:1 ,id:12818475 store_id:2 ,id:12818476 store_id:7 \"}"] [leader="id:12818476 store_id:7 "] [commitTS=458837208497913857]
[2025/06/19 17:25:18.692 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499529] [startKey=748000000000000F485F7280000000004FFBF0] [endKey=748000000000000F485F728000000000A00A48] [remainStart=748000000000000F485F7280000000009E28CB] [region="{ID=12818505,startKey=748000000000000FFF485F728000000000FF4FFBF00000000000FA,endKey=748000000000000FFF485F728000000000FFA00A480000000000FA,epoch=\"conf_ver:5 version:2129 \",peers=\"id:12818506 store_id:1 ,id:12818507 store_id:2 ,id:12818508 store_id:7 \"}"] [leader="id:12818506 store_id:1 "] [commitTS=458837208497913857]
[2025/06/19 17:25:19.113 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836035] [startKey=748000000000000F4B5F7280000000007C6697] [endKey=748000000000000F4B5F728000000000CC559F] [remainStart=748000000000000F4B5F728000000000CA776C] [region="{ID=12818521,startKey=748000000000000FFF4B5F728000000000FF7C66970000000000FA,endKey=748000000000000FFF4B5F728000000000FFCC559F0000000000FA,epoch=\"conf_ver:5 version:2133 \",peers=\"id:12818522 store_id:1 ,id:12818523 store_id:2 ,id:12818524 store_id:7 \"}"] [leader="id:12818524 store_id:7 "] [commitTS=458837208497913857]
[2025/06/19 17:25:19.505 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49500934] [startKey=748000000000000F485F728000000000A00A48] [endKey=748000000000000F485F728000000000F00CE3] [remainStart=748000000000000F485F728000000000EE2D3F] [region="{ID=12818509,startKey=748000000000000FFF485F728000000000FFA00A480000000000FA,endKey=748000000000000FFF485F728000000000FFF00CE30000000000FA,epoch=\"conf_ver:5 version:2129 \",peers=\"id:12818510 store_id:1 ,id:12818511 store_id:2 ,id:12818512 store_id:7 \"}"] [leader="id:12818511 store_id:2 "] [commitTS=458837208497913857]
[2025/06/19 17:25:22.289 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499146] [startKey=748000000000000F485F728000000000000003] [endKey=748000000000000F485F7280000000004FFBF0] [remainStart=748000000000000F485F7280000000004E1F91] [region="{ID=12818501,startKey=748000000000000FFF485F728000000000FF0000030000000000FA,endKey=748000000000000FFF485F728000000000FF4FFBF00000000000FA,epoch=\"conf_ver:5 version:2129 \",peers=\"id:12818502 store_id:1 ,id:12818503 store_id:2 ,id:12818504 store_id:7 \"}"] [leader="id:12818503 store_id:2 "] [commitTS=458837208497913857]
[2025/06/19 17:25:23.094 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835939] [startKey=748000000000000F4B5F728000000000CC559F] [endKey=748000000000000F4B5F7280000000011C5802] [remainStart=748000000000000F4B5F7280000000011A7546] [region="{ID=12818525,startKey=748000000000000FFF4B5F728000000000FFCC559F0000000000FA,endKey=748000000000000FFF4B5F728000000001FF1C58020000000000FA,epoch=\"conf_ver:5 version:2133 \",peers=\"id:12818526 store_id:1 ,id:12818527 store_id:2 ,id:12818528 store_id:7 \"}"] [leader="id:12818526 store_id:1 "] [commitTS=458837208497913857]
[2025/06/19 17:25:37.235 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [size=777445676] [kvs=20001899] [importedSize=777445676] [importedCount=20001899]
[2025/06/19 17:25:37.307 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [retryCnt=0] [takeTime=27.800483142s] []
[2025/06/19 17:25:37.308 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4]
[2025/06/19 17:25:37.527 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [takeTime=219.111621ms] []
[2025/06/19 17:25:37.527 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`follows`:0] [engineUUID=71fcbd5a-5fac-53fc-8477-ca99f03a3dc4] [takeTime=28.02058669s] []
[2025/06/19 17:25:37.527 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_proteus`.`follows`] [takeTime=1m33.065323824s] []
[2025/06/19 17:25:37.527 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9]
[2025/06/19 17:25:37.619 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9] [takeTime=92.512662ms] []
[2025/06/19 17:25:37.620 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9]
[2025/06/19 17:25:37.620 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9] [retryCnt=0]
[2025/06/19 17:25:37.623 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=06a76c46-611d-51fb-a79f-481be3a72bc9]
[2025/06/19 17:25:37.623 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9] [retryCnt=0] [takeTime=2.572096ms] []
[2025/06/19 17:25:37.624 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9]
[2025/06/19 17:25:37.663 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9] [takeTime=39.730521ms] []
[2025/06/19 17:25:37.663 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_proteus`.`follows`:-1] [engineUUID=06a76c46-611d-51fb-a79f-481be3a72bc9] [takeTime=43.099065ms] []
[2025/06/19 17:25:37.826 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_proteus`.`follows`] [takeTime=1m33.517558043s] []
[2025/06/19 17:25:37.826 +08:00] [INFO] [import.go:1148] ["cancel periodic actions"] [do=true]
[2025/06/19 17:25:37.827 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Normal]
[2025/06/19 17:25:38.793 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_proteus`.`tweets`] [checksum="{cksum=5896666013909211690,size=160505066,kvs=2500000}"]
[2025/06/19 17:25:38.793 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_proteus`.`users`] [checksum="{cksum=5001560770747020645,size=19388895,kvs=500000}"]
[2025/06/19 17:25:38.793 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=users]
[2025/06/19 17:25:38.793 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=tweets]
[2025/06/19 17:25:39.072 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=users] [takeTime=279.060993ms] []
[2025/06/19 17:25:39.072 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_proteus`.`users`] [local="{cksum=5001560770747020645,size=19388895,kvs=500000}"]
[2025/06/19 17:25:39.073 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_proteus`.`users`]
[2025/06/19 17:25:39.711 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=tweets] [takeTime=918.466929ms] []
[2025/06/19 17:25:39.711 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_proteus`.`tweets`] [local="{cksum=5896666013909211690,size=160505066,kvs=2500000}"]
[2025/06/19 17:25:39.712 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_proteus`.`tweets`]
[2025/06/19 17:25:44.429 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_proteus`.`users`] [takeTime=5.354944079s] []
[2025/06/19 17:25:44.429 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_proteus`.`follows`] [checksum="{cksum=5537136570772654355,size=777445676,kvs=20001899}"]
[2025/06/19 17:25:44.430 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=follows]
[2025/06/19 17:25:47.529 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=follows] [takeTime=3.098879041s] []
[2025/06/19 17:25:47.529 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_proteus`.`follows`] [local="{cksum=5537136570772654355,size=777445676,kvs=20001899}"]
[2025/06/19 17:25:47.530 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_proteus`.`follows`]
[2025/06/19 17:25:47.745 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_proteus`.`tweets`] [takeTime=8.032275495s] []
[2025/06/19 17:25:56.807 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_proteus`.`follows`] [takeTime=9.276679762s] []
[2025/06/19 17:25:56.807 +08:00] [INFO] [import.go:1412] ["restore all tables data completed"] [takeTime=1m59.885052374s] []
[2025/06/19 17:25:56.807 +08:00] [INFO] [import.go:1415] ["cleanup task metas"]
[2025/06/19 17:25:56.809 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=tikv-driver]
[2025/06/19 17:25:56.811 +08:00] [INFO] [import.go:1003] ["everything imported, stopping periodic actions"]
[2025/06/19 17:25:56.847 +08:00] [INFO] [import.go:1643] ["skip full compaction"]
[2025/06/19 17:25:56.847 +08:00] [INFO] [import.go:1793] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=5265407895072682971]
[2025/06/19 17:25:56.847 +08:00] [INFO] [import.go:1801] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=5265407895072682971] [takeTime=134.1µs] []
[2025/06/19 17:25:56.848 +08:00] [INFO] [import.go:584] ["the whole procedure completed"] [takeTime=2m6.374283928s] []
[2025/06/19 17:25:56.875 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 17:25:56.876 +08:00] [INFO] [checksum.go:510] ["service safe point keeper exited"]
[2025/06/19 17:25:56.876 +08:00] [INFO] [main.go:110] ["tidb lightning exit"] [finished=true]
[2025/06/19 17:50:26.714 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/19 17:50:26.715 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/19 17:50:26.715 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":6068261685416191611,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_peloton\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_peloton\",\"table-pattern\":\"\",\"target-schema\":\"tw_peloton\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/19 17:50:26.716 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/19 17:50:26.718 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.768898ms] []
[2025/06/19 17:50:26.760 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/19 17:50:26.760 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/19 17:50:26.812 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/19 17:50:26.814 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/19 17:50:26.814 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/19 17:50:26.817 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/19 17:50:26.817 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/19 17:50:26.818 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_peloton]
[2025/06/19 17:50:32.229 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=5.41108877s] []
[2025/06/19 17:50:32.250 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_peloton] [table=users] [path=tw_peloton.users.sql]
[2025/06/19 17:50:32.251 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_peloton] [table=tweets] [path=tw_peloton.tweets.sql]
[2025/06/19 17:50:32.252 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_peloton] [table=follows] [path=tw_peloton.follows.sql]
[2025/06/19 17:50:32.258 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_peloton`.`follows` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:50:32.260 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_peloton`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:50:32.338 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_peloton`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/19 17:50:32.339 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:50:32.341 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:50:32.342 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/19 17:50:32.374 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:50:32.375 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/19 17:50:32.393 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/19 17:50:32.559 +08:00] [INFO] [import.go:1276] ["restore all tables data start"]
[2025/06/19 17:50:32.568 +08:00] [INFO] [checksum_helper.go:52] ["set tidb_backoff_weight to default"] [backoff_weight=30]
[2025/06/19 17:50:32.847 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Import]
[2025/06/19 17:50:32.847 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_peloton`.`users`]
[2025/06/19 17:50:32.847 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_peloton`.`tweets`]
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_peloton`.`users`]
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_peloton`.`tweets`]
[2025/06/19 17:50:32.848 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=48.376µs]
[2025/06/19 17:50:32.848 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=70.482µs]
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_peloton`.`tweets`] [enginesCnt=2] [filesCnt=1] [takeTime=94.952µs] []
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_peloton`.`users`] [enginesCnt=2] [filesCnt=1] [takeTime=125.578µs] []
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_peloton`.`tweets`] [table=`tw_peloton`.`tweets`] [count=25833363]
[2025/06/19 17:50:32.848 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_peloton`.`users`] [table=`tw_peloton`.`users`] [count=3069463]
[2025/06/19 17:50:32.849 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:50:32.849 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:50:34.313 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428]
[2025/06/19 17:50:34.314 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_peloton`.`users`]
[2025/06/19 17:50:34.314 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_peloton`.`users`] [engineNumber=0]
[2025/06/19 17:50:34.314 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_peloton`.`users`] [engineNumber=0]
[2025/06/19 17:50:34.333 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7]
[2025/06/19 17:50:34.333 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_peloton`.`tweets`]
[2025/06/19 17:50:34.333 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_peloton`.`tweets`] [engineNumber=0]
[2025/06/19 17:50:34.334 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_peloton`.`tweets`] [engineNumber=0]
[2025/06/19 17:50:35.285 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29]
[2025/06/19 17:50:35.294 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_peloton`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.tweets.sql:0]
[2025/06/19 17:50:35.298 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0]
[2025/06/19 17:50:35.300 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_peloton`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.users.sql:0]
[2025/06/19 17:50:36.539 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_peloton`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.users.sql:0] [readDur=225.617269ms] [encodeDur=914.262159ms] [deliverDur=159.639277ms] [checksum="{cksum=11007639462782896220,size=19388895,kvs=500000}"] [takeTime=1.238812651s] []
[2025/06/19 17:50:36.660 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_peloton`.`users`] [engineNumber=0] [read(bytes)=0] [written=19388895] [takeTime=2.345888277s] []
[2025/06/19 17:50:36.660 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0]
[2025/06/19 17:50:36.661 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=19388895] [kvs=500000] [files=1] [sstFileSize=4188345] [file=/data3/dzh/project/grep/dev/twitter/cache/4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0.sst/ae29a53e-ce43-4f7e-ba43-19e4e223ef03.sst] [firstKey=748000000000000F645F728000000000000001] [lastKey=748000000000000F665F72800000000007A120]
[2025/06/19 17:50:36.731 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [takeTime=70.190771ms] []
[2025/06/19 17:50:36.791 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_peloton`.`users`] [engineNumber=0] [takeTime=2.476223769s] []
[2025/06/19 17:50:36.791 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0]
[2025/06/19 17:50:36.791 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [retryCnt=0]
[2025/06/19 17:50:36.794 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:50:36.832 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] ["region ranges"=1] [count=500000] [size=19388895]
[2025/06/19 17:50:36.832 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=2]
[2025/06/19 17:50:36.834 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f645f728000000000000001] [endOfAllRanges=748000000000000f665f72800000000007a121] [startKeyOfFirstRegion=748000000000000fff6400000000000000f8] [endKeyOfLastRegion=748000000000000fff6700000000000000f8]
[2025/06/19 17:50:37.555 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818631 is conf_ver: 5 version: 2138, but you sent conf_ver: 5 version: 2137"] [region="{ID=12818659,startKey=748000000000000FFF6600000000000000F8,endKey=748000000000000FFF665F728000000000FF07A1210000000000FA,epoch=\"conf_ver:5 version:2138 \",peers=\"id:12818660 store_id:1 ,id:12818661 store_id:2 ,id:12818662 store_id:7 \"}"] [start=748000000000000F66] [end=748000000000000F665F72800000000007A121]
[2025/06/19 17:50:37.555 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F66] [endKey=748000000000000F665F72800000000007A121] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:50:39.555 +08:00]
[2025/06/19 17:50:37.830 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818623 is conf_ver: 5 version: 2136, but you sent conf_ver: 5 version: 2135"] [region="{ID=12818623,startKey=748000000000000FFF645F728000000000FF0000010000000000FA,endKey=748000000000000FFF6500000000000000F8,epoch=\"conf_ver:5 version:2136 \",peers=\"id:12818624 store_id:1 ,id:12818625 store_id:2 ,id:12818626 store_id:7 \"}"] [start=748000000000000F645F728000000000000001] [end=748000000000000F65]
[2025/06/19 17:50:37.831 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F645F728000000000000001] [endKey=748000000000000F65] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/19 17:50:39.831 +08:00]
[2025/06/19 17:50:40.579 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=120851621] [kvs=1889947] [files=1] [sstFileSize=25819892] [file=/data3/dzh/project/grep/dev/twitter/cache/4026ae7e-7283-5500-97f7-ce087391ed29.sst/3aaff662-546d-42f7-9c23-5be0418fa569.sst] [firstKey=748000000000000F695F728000000000000001] [lastKey=748000000000000F695F7280000000001CD69B]
[2025/06/19 17:50:40.598 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [size=19388895] [kvs=500000] [importedSize=19388895] [importedCount=500000]
[2025/06/19 17:50:40.631 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [retryCnt=0] [takeTime=3.840359447s] []
[2025/06/19 17:50:40.632 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0]
[2025/06/19 17:50:40.659 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [takeTime=26.94421ms] []
[2025/06/19 17:50:40.659 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`users`:0] [engineUUID=4fb7f510-f4d2-5fa8-97d3-58fe8ba387b0] [takeTime=3.867926079s] []
[2025/06/19 17:50:40.659 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_peloton`.`users`] [takeTime=6.34450494s] []
[2025/06/19 17:50:40.659 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428]
[2025/06/19 17:50:40.705 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428] [takeTime=45.983052ms] []
[2025/06/19 17:50:40.706 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428]
[2025/06/19 17:50:40.706 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428] [retryCnt=0]
[2025/06/19 17:50:40.708 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=60ed5984-9550-54a1-9146-e563eca97428]
[2025/06/19 17:50:40.708 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428] [retryCnt=0] [takeTime=2.471328ms] []
[2025/06/19 17:50:40.709 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428]
[2025/06/19 17:50:40.738 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428] [takeTime=29.233697ms] []
[2025/06/19 17:50:40.738 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`users`:-1] [engineUUID=60ed5984-9550-54a1-9146-e563eca97428] [takeTime=32.439811ms] []
[2025/06/19 17:50:40.739 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_peloton`.`users`] [takeTime=7.8916459s] []
[2025/06/19 17:50:40.739 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_peloton`.`follows`]
[2025/06/19 17:50:40.739 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_peloton`.`follows`]
[2025/06/19 17:50:40.739 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=57.483µs]
[2025/06/19 17:50:40.739 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_peloton`.`follows`] [enginesCnt=2] [filesCnt=1] [takeTime=98.367µs] []
[2025/06/19 17:50:40.739 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_peloton`.`follows`] [table=`tw_peloton`.`follows`] [count=88897226]
[2025/06/19 17:50:40.740 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/19 17:50:40.823 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e]
[2025/06/19 17:50:40.823 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_peloton`.`follows`]
[2025/06/19 17:50:40.823 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_peloton`.`follows`] [engineNumber=0]
[2025/06/19 17:50:40.823 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_peloton`.`follows`] [engineNumber=0]
[2025/06/19 17:50:40.948 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b]
[2025/06/19 17:50:40.968 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_peloton`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.follows.sql:0]
[2025/06/19 17:50:41.883 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_peloton`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.tweets.sql:0] [readDur=1.548403205s] [encodeDur=4.047395923s] [deliverDur=1.660431896s] [checksum="{cksum=9081537100023489177,size=160505066,kvs=2500000}"] [takeTime=6.58919062s] []
[2025/06/19 17:50:42.127 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_peloton`.`tweets`] [engineNumber=0] [read(bytes)=0] [written=160505066] [takeTime=7.793086901s] []
[2025/06/19 17:50:42.127 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29]
[2025/06/19 17:50:42.127 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=39653445] [kvs=610053] [files=1] [sstFileSize=8357580] [file=/data3/dzh/project/grep/dev/twitter/cache/4026ae7e-7283-5500-97f7-ce087391ed29.sst/1737342e-4c2e-4e0a-9918-9fc782995019.sst] [firstKey=748000000000000F695F7280000000001CD69C] [lastKey=748000000000000F695F7280000000002625A0]
[2025/06/19 17:50:42.240 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29] [takeTime=113.105855ms] []
[2025/06/19 17:50:42.286 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_peloton`.`tweets`] [engineNumber=0] [takeTime=7.952321068s] []
[2025/06/19 17:50:42.286 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29]
[2025/06/19 17:50:42.286 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29] [retryCnt=0]
[2025/06/19 17:50:42.288 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=4026ae7e-7283-5500-97f7-ce087391ed29] [totalSize=160505066] [totalCount=2500000] [startKey=748000000000000F695F728000000000000001] [endKey=748000000000000F695F7280000000002625A1] [len(keys)=3] []
[2025/06/19 17:50:42.288 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:50:42.330 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=4026ae7e-7283-5500-97f7-ce087391ed29] ["region ranges"=2] [count=2500000] [size=160505066]
[2025/06/19 17:50:42.331 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=3]
[2025/06/19 17:50:42.331 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=4026ae7e-7283-5500-97f7-ce087391ed29]
[2025/06/19 17:50:42.331 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF695F728000000000FF0000010000000000FA] [end=748000000000000FFF695F728000000000FF2625A10000000000FB]
[2025/06/19 17:50:42.620 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818639,startKey=748000000000000FFF6900000000000000F8,endKey=748000000000000FFF6B00000000000000F8,epoch=\"conf_ver:5 version:2139 \",peers=\"id:12818640 store_id:1 ,id:12818641 store_id:2 ,id:12818642 store_id:7 \"}"] [keys="{total=3,keys=\"[748000000000000F695F728000000000000001,748000000000000F695F728000000000140001,748000000000000F695F7280000000002625A1]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818639 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818639 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818640 store_id:1 > peers:<id:12818641 store_id:2 > peers:<id:12818642 store_id:7 > > > "]
[2025/06/19 17:50:42.623 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818639] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818639 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818639 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818640 store_id:1 > peers:<id:12818641 store_id:2 > peers:<id:12818642 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818639 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818639 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818640 store_id:1 > peers:<id:12818641 store_id:2 > peers:<id:12818642 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:50:42.624 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818639 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818639 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818640 store_id:1 > peers:<id:12818641 store_id:2 > peers:<id:12818642 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818639 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818639 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818640 store_id:1 > peers:<id:12818641 store_id:2 > peers:<id:12818642 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"] [backoff=50ms]
[2025/06/19 17:50:42.676 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=2] [start=748000000000000FFF695F728000000000FF0000010000000000FA] [end=748000000000000FFF695F728000000000FF2625A10000000000FB]
[2025/06/19 17:50:42.892 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818683 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2142 > peers:<id:12818684 store_id:1 > peers:<id:12818685 store_id:2 > peers:<id:12818686 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818683 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2142 > peers:<id:12818684 store_id:1 > peers:<id:12818685 store_id:2 > peers:<id:12818686 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:50:42.903 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818683 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2142 > peers:<id:12818684 store_id:1 > peers:<id:12818685 store_id:2 > peers:<id:12818686 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818683 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377i_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2142 > peers:<id:12818684 store_id:1 > peers:<id:12818685 store_id:2 > peers:<id:12818686 store_id:7 > "] [backoff=20ms]
[2025/06/19 17:50:42.966 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=1]
[2025/06/19 17:50:43.283 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=1] [take=315.789238ms]
[2025/06/19 17:50:43.283 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=4026ae7e-7283-5500-97f7-ce087391ed29] [takeTime=952.303137ms] []
[2025/06/19 17:50:43.285 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f695f728000000000140001] [endOfAllRanges=748000000000000f695f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff695f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff695f728000000000ff2625a10000000000fa]
[2025/06/19 17:50:43.285 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f695f728000000000000001] [endOfAllRanges=748000000000000f695f728000000000140001] [startKeyOfFirstRegion=748000000000000fff695f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff695f728000000000ff1400010000000000fa]
[2025/06/19 17:50:44.250 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=81205066] [startKey=748000000000000F695F728000000000000001] [endKey=748000000000000F695F728000000000140001] [remainStart=748000000000000F695F728000000000138801] [region="{ID=12818683,startKey=748000000000000FFF695F728000000000FF0000010000000000FA,endKey=748000000000000FFF695F728000000000FF1400010000000000FA,epoch=\"conf_ver:5 version:2142 \",peers=\"id:12818684 store_id:1 ,id:12818685 store_id:2 ,id:12818686 store_id:7 \"}"] [leader="id:12818684 store_id:1 "] [commitTS=458837625477529601]
[2025/06/19 17:50:45.782 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=4026ae7e-7283-5500-97f7-ce087391ed29] [size=160505066] [kvs=2500000] [importedSize=160505066] [importedCount=2500000]
[2025/06/19 17:50:45.800 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29] [retryCnt=0] [takeTime=3.51404003s] []
[2025/06/19 17:50:45.801 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29]
[2025/06/19 17:50:45.862 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29] [takeTime=61.065617ms] []
[2025/06/19 17:50:45.862 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`tweets`:0] [engineUUID=4026ae7e-7283-5500-97f7-ce087391ed29] [takeTime=3.575947657s] []
[2025/06/19 17:50:45.862 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_peloton`.`tweets`] [takeTime=11.528691679s] []
[2025/06/19 17:50:45.862 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7]
[2025/06/19 17:50:45.883 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7] [takeTime=21.046044ms] []
[2025/06/19 17:50:45.884 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7]
[2025/06/19 17:50:45.884 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7] [retryCnt=0]
[2025/06/19 17:50:45.886 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=46724dbd-439d-51f4-893e-8289363e7ca7]
[2025/06/19 17:50:45.886 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7] [retryCnt=0] [takeTime=1.955893ms] []
[2025/06/19 17:50:45.886 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7]
[2025/06/19 17:50:45.913 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7] [takeTime=26.513034ms] []
[2025/06/19 17:50:45.913 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`tweets`:-1] [engineUUID=46724dbd-439d-51f4-893e-8289363e7ca7] [takeTime=28.994685ms] []
[2025/06/19 17:50:45.914 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_peloton`.`tweets`] [takeTime=13.06605773s] []
[2025/06/19 17:51:36.062 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_peloton`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_peloton.follows.sql:0] [readDur=5.058640255s] [encodeDur=31.398781787s] [deliverDur=19.89279497s] [checksum="{cksum=5906452528462628289,size=777445676,kvs=20001899}"] [takeTime=55.092972028s] []
[2025/06/19 17:51:37.184 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_peloton`.`follows`] [engineNumber=0] [read(bytes)=0] [written=777445676] [takeTime=56.360179962s] []
[2025/06/19 17:51:37.184 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b]
[2025/06/19 17:51:44.782 +08:00] [INFO] [engine.go:1685] ["compact sst"] [fileCount=7] [size=777445676] [count=20001899] [cost=7.598550509s] [file=/data3/dzh/project/grep/dev/twitter/cache/1d03b603-cdf3-5719-b5a1-9b59cc474e7b.sst/93011601-1f16-4d58-8345-ce75e86ef41a.sst]
[2025/06/19 17:51:44.783 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=777445676] [kvs=20001899] [files=1] [sstFileSize=304059352] [file=/data3/dzh/project/grep/dev/twitter/cache/1d03b603-cdf3-5719-b5a1-9b59cc474e7b.sst/93011601-1f16-4d58-8345-ce75e86ef41a.sst] [firstKey=748000000000000F6B5F728000000000000003] [lastKey=748000000000000F6E5F72800000000131346B]
[2025/06/19 17:51:44.888 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [takeTime=7.704421134s] []
[2025/06/19 17:51:44.922 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_peloton`.`follows`] [engineNumber=0] [takeTime=1m4.098356284s] []
[2025/06/19 17:51:44.922 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b]
[2025/06/19 17:51:44.922 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [retryCnt=0]
[2025/06/19 17:51:44.926 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [totalSize=777445676] [totalCount=20001899] [startKey=748000000000000F6B5F728000000000000003] [endKey=748000000000000F6E5F72800000000131346C] [len(keys)=17] []
[2025/06/19 17:51:44.926 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/19 17:51:44.959 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] ["region ranges"=16] [count=20001899] [size=777445676]
[2025/06/19 17:51:44.960 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=17]
[2025/06/19 17:51:44.960 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=1d03b603-cdf3-5719-b5a1-9b59cc474e7b]
[2025/06/19 17:51:44.961 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF6B5F728000000000FF0000030000000000FA] [end=748000000000000FFF6E5F728000000001FF31346C0000000000FB]
[2025/06/19 17:51:45.221 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818643,startKey=748000000000000FFF6B00000000000000F8,endKey=748000000000000FFF6C00000000000000F8,epoch=\"conf_ver:5 version:2140 \",peers=\"id:12818644 store_id:1 ,id:12818645 store_id:2 ,id:12818646 store_id:7 \"}"] [keys="{total=4,keys=\"[748000000000000F6B5F728000000000000003,748000000000000F6B5F7280000000004FFBF0,748000000000000F6B5F728000000000A00A48,748000000000000F6B5F728000000000F00CE3]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818643 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818643 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818644 store_id:1 > peers:<id:12818645 store_id:2 > peers:<id:12818646 store_id:7 > > > "]
[2025/06/19 17:51:45.222 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818643] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818643 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818643 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818644 store_id:1 > peers:<id:12818645 store_id:2 > peers:<id:12818646 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818643 is conf_ver: 5 version: 2141\" epoch_not_match:<current_regions:<id:12818643 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377k_r\\200\\000\\000\\000\\000\\377\\000\\000\\003\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2141 > peers:<id:12818644 store_id:1 > peers:<id:12818645 store_id:2 > peers:<id:12818646 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:51:45.389 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12594053,startKey=748000000000000FFF6E00000000000000F8,endKey=7800000000000000FB,epoch=\"conf_ver:5 version:2142 \",peers=\"id:12594054 store_id:1 ,id:12594055 store_id:2 ,id:12594056 store_id:7 \"}"] [keys="{total=5,keys=\"[748000000000000F6E5F7280000000002C561E,\\\"(skip 3)\\\",748000000000000F6E5F72800000000131346C]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2143\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377n_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2143 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > "]
[2025/06/19 17:51:45.390 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12594053] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2143\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377n_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2143 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12594053 is conf_ver: 5 version: 2143\" epoch_not_match:<current_regions:<id:12594053 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377n_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2143 > peers:<id:12594054 store_id:1 > peers:<id:12594055 store_id:2 > peers:<id:12594056 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:51:45.409 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818735 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2145 > peers:<id:12818736 store_id:1 > peers:<id:12818737 store_id:2 > peers:<id:12818738 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818735 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2145 > peers:<id:12818736 store_id:1 > peers:<id:12818737 store_id:2 > peers:<id:12818738 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:51:45.409 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818715 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377m\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377m_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2146 > peers:<id:12818716 store_id:1 > peers:<id:12818717 store_id:2 > peers:<id:12818718 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818715 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377m\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377m_r\\200\\000\\000\\000\\000\\377\\035x\\252\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2146 > peers:<id:12818716 store_id:1 > peers:<id:12818717 store_id:2 > peers:<id:12818718 store_id:7 > "] [backoff=10ms]
[2025/06/19 17:51:45.421 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818735 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2145 > peers:<id:12818736 store_id:1 > peers:<id:12818737 store_id:2 > peers:<id:12818738 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 4, the first unfinished region: id:12818735 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377l_r\\200\\000\\000\\000\\000\\377\\016\\312\\336\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2145 > peers:<id:12818736 store_id:1 > peers:<id:12818737 store_id:2 > peers:<id:12818738 store_id:7 > "] [backoff=20ms]
[2025/06/19 17:51:46.052 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:51:46.054 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:51:46.106 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=13] [start=748000000000000FFF6B5F728000000000FF0000030000000000FA] [end=748000000000000FFF6E5F728000000001FF31346C0000000000FB]
[2025/06/19 17:51:46.109 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818691,startKey=748000000000000FFF6E00000000000000F8,endKey=748000000000000FFF6E5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2143 \",peers=\"id:12818692 store_id:1 ,id:12818693 store_id:2 ,id:12818694 store_id:7 \"}"] [keys="{total=4,keys=\"[748000000000000F6E5F7280000000002C561E,748000000000000F6E5F7280000000007C6697,748000000000000F6E5F728000000000CC559F,748000000000000F6E5F7280000000011C5802]\"}"] [regionErr="message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818691] 12818694 peer has not applied to current term, applied_term 5, current_term 6\\\"\" "]
[2025/06/19 17:51:46.109 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818691] [error="split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818691] 12818694 peer has not applied to current term, applied_term 5, current_term 6\\\"\" : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818691] 12818694 peer has not applied to current term, applied_term 5, current_term 6\\\"\" \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/19 17:51:46.595 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=3]
[2025/06/19 17:51:46.697 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF6E5F728000000000FF2C561E0000000000FA] [end=748000000000000FFF6E5F728000000001FF1C58020000000000FB]
[2025/06/19 17:51:47.181 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=4]
[2025/06/19 17:51:47.512 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=4] [take=328.958695ms]
[2025/06/19 17:51:47.512 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [takeTime=2.551856474s] []
[2025/06/19 17:51:47.514 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6e5f7280000000002c561e] [endOfAllRanges=748000000000000f6e5f7280000000007c6697] [startKeyOfFirstRegion=748000000000000fff6e5f728000000000ff2c561e0000000000fa] [endKeyOfLastRegion=748000000000000fff6e5f728000000000ff7c66970000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6b5f728000000000000003] [endOfAllRanges=748000000000000f6b5f7280000000004ffbf0] [startKeyOfFirstRegion=748000000000000fff6b5f728000000000ff0000030000000000fa] [endKeyOfLastRegion=748000000000000fff6b5f728000000000ff4ffbf00000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6e5f7280000000011c5802] [endOfAllRanges=748000000000000f6e5f72800000000131346c] [startKeyOfFirstRegion=748000000000000fff6e5f728000000001ff1c58020000000000fa] [endKeyOfLastRegion=748000000000000fff6e5f728000000001ff31346c0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6d5f728000000000bd77cc] [endOfAllRanges=748000000000000f6d5f7280000000010d7c06] [startKeyOfFirstRegion=748000000000000fff6d5f728000000000ffbd77cc0000000000fa] [endKeyOfLastRegion=748000000000000fff6d5f728000000001ff0d7c060000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6b5f7280000000004ffbf0] [endOfAllRanges=748000000000000f6b5f728000000000a00a48] [startKeyOfFirstRegion=748000000000000fff6b5f728000000000ff4ffbf00000000000fa] [endKeyOfLastRegion=748000000000000fff6b5f728000000000ffa00a480000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6c5f728000000000aea9d4] [endOfAllRanges=748000000000000f6c5f728000000000fea6c0] [startKeyOfFirstRegion=748000000000000fff6c5f728000000000ffaea9d40000000000fa] [endKeyOfLastRegion=748000000000000fff6c5f728000000000fffea6c00000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6d5f7280000000001d78aa] [endOfAllRanges=748000000000000f6d5f7280000000006d816d] [startKeyOfFirstRegion=748000000000000fff6d5f728000000000ff1d78aa0000000000fa] [endKeyOfLastRegion=748000000000000fff6d5f728000000000ff6d816d0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6e5f7280000000007c6697] [endOfAllRanges=748000000000000f6e5f728000000000cc559f] [startKeyOfFirstRegion=748000000000000fff6e5f728000000000ff7c66970000000000fa] [endKeyOfLastRegion=748000000000000fff6e5f728000000000ffcc559f0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6e5f728000000000cc559f] [endOfAllRanges=748000000000000f6e5f7280000000011c5802] [startKeyOfFirstRegion=748000000000000fff6e5f728000000000ffcc559f0000000000fa] [endKeyOfLastRegion=748000000000000fff6e5f728000000001ff1c58020000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f6d5f7280000000010d7c06] [endOfAllRanges=748000000000000f6e5f7280000000002c561e] [startKeyOfFirstRegion=748000000000000fff6d5f728000000001ff0d7c060000000000fa] [endKeyOfLastRegion=748000000000000fff6e5f728000000000ff2c561e0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6b5f728000000000a00a48] [endOfAllRanges=748000000000000f6b5f728000000000f00ce3] [startKeyOfFirstRegion=748000000000000fff6b5f728000000000ffa00a480000000000fa] [endKeyOfLastRegion=748000000000000fff6b5f728000000000fff00ce30000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6c5f7280000000005eb5f1] [endOfAllRanges=748000000000000f6c5f728000000000aea9d4] [startKeyOfFirstRegion=748000000000000fff6c5f728000000000ff5eb5f10000000000fa] [endKeyOfLastRegion=748000000000000fff6c5f728000000000ffaea9d40000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f6b5f728000000000f00ce3] [endOfAllRanges=748000000000000f6c5f7280000000000ecade] [startKeyOfFirstRegion=748000000000000fff6b5f728000000000fff00ce30000000000fa] [endKeyOfLastRegion=748000000000000fff6c5f728000000000ff0ecade0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f6c5f728000000000fea6c0] [endOfAllRanges=748000000000000f6d5f7280000000001d78aa] [startKeyOfFirstRegion=748000000000000fff6c5f728000000000fffea6c00000000000fa] [endKeyOfLastRegion=748000000000000fff6d5f728000000000ff1d78aa0000000000fa]
[2025/06/19 17:51:47.515 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6c5f7280000000000ecade] [endOfAllRanges=748000000000000f6c5f7280000000005eb5f1] [startKeyOfFirstRegion=748000000000000fff6c5f728000000000ff0ecade0000000000fa] [endKeyOfLastRegion=748000000000000fff6c5f728000000000ff5eb5f10000000000fa]
[2025/06/19 17:51:47.516 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f6d5f7280000000006d816d] [endOfAllRanges=748000000000000f6d5f728000000000bd77cc] [startKeyOfFirstRegion=748000000000000fff6d5f728000000000ff6d816d0000000000fa] [endKeyOfLastRegion=748000000000000fff6d5f728000000000ffbd77cc0000000000fa]
[2025/06/19 17:51:50.587 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835605] [startKey=748000000000000F6C5F7280000000000ECADE] [endKey=748000000000000F6C5F7280000000005EB5F1] [remainStart=748000000000000F6C5F7280000000005CD674] [region="{ID=12818743,startKey=748000000000000FFF6C5F728000000000FF0ECADE0000000000FA,endKey=748000000000000FFF6C5F728000000000FF5EB5F10000000000FA,epoch=\"conf_ver:5 version:2145 \",peers=\"id:12818744 store_id:1 ,id:12818745 store_id:2 ,id:12818746 store_id:7 \"}"] [leader="id:12818745 store_id:2 "] [commitTS=458837626958643201]
[2025/06/19 17:51:50.822 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835481] [startKey=748000000000000F6C5F7280000000005EB5F1] [endKey=748000000000000F6C5F728000000000AEA9D4] [remainStart=748000000000000F6C5F728000000000ACCC43] [region="{ID=12818751,startKey=748000000000000FFF6C5F728000000000FF5EB5F10000000000FA,endKey=748000000000000FFF6C5F728000000000FFAEA9D40000000000FA,epoch=\"conf_ver:5 version:2145 \",peers=\"id:12818752 store_id:1 ,id:12818753 store_id:2 ,id:12818754 store_id:7 \"}"] [leader="id:12818752 store_id:1 "] [commitTS=458837626958643201]
[2025/06/19 17:51:51.515 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835564] [startKey=748000000000000F6D5F728000000000BD77CC] [endKey=748000000000000F6D5F7280000000010D7C06] [remainStart=748000000000000F6D5F7280000000010BA027] [region="{ID=12818727,startKey=748000000000000FFF6D5F728000000000FFBD77CC0000000000FA,endKey=748000000000000FFF6D5F728000000001FF0D7C060000000000FA,epoch=\"conf_ver:5 version:2146 \",peers=\"id:12818728 store_id:1 ,id:12818729 store_id:2 ,id:12818730 store_id:7 \"}"] [leader="id:12818730 store_id:7 "] [commitTS=458837626958643201]
[2025/06/19 17:51:51.956 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836035] [startKey=748000000000000F6E5F7280000000007C6697] [endKey=748000000000000F6E5F728000000000CC559F] [remainStart=748000000000000F6E5F728000000000CA776C] [region="{ID=12818799,startKey=748000000000000FFF6E5F728000000000FF7C66970000000000FA,endKey=748000000000000FFF6E5F728000000000FFCC559F0000000000FA,epoch=\"conf_ver:5 version:2147 \",peers=\"id:12818800 store_id:1 ,id:12818801 store_id:2 ,id:12818802 store_id:7 \"}"] [leader="id:12818802 store_id:7 "] [commitTS=458837626958643201]
[2025/06/19 17:51:53.838 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499529] [startKey=748000000000000F6B5F7280000000004FFBF0] [endKey=748000000000000F6B5F728000000000A00A48] [remainStart=748000000000000F6B5F7280000000009E28CB] [region="{ID=12818783,startKey=748000000000000FFF6B5F728000000000FF4FFBF00000000000FA,endKey=748000000000000FFF6B5F728000000000FFA00A480000000000FA,epoch=\"conf_ver:5 version:2144 \",peers=\"id:12818784 store_id:1 ,id:12818785 store_id:2 ,id:12818786 store_id:7 \"}"] [leader="id:12818786 store_id:7 "] [commitTS=458837626958643201]
[2025/06/19 17:51:54.146 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835989] [startKey=748000000000000F6D5F7280000000001D78AA] [endKey=748000000000000F6D5F7280000000006D816D] [remainStart=748000000000000F6D5F7280000000006BA150] [region="{ID=12818719,startKey=748000000000000FFF6D5F728000000000FF1D78AA0000000000FA,endKey=748000000000000FFF6D5F728000000000FF6D816D0000000000FA,epoch=\"conf_ver:5 version:2146 \",peers=\"id:12818720 store_id:1 ,id:12818721 store_id:2 ,id:12818722 store_id:7 \"}"] [leader="id:12818720 store_id:1 "] [commitTS=458837626958643201]
[2025/06/19 17:51:55.844 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49500934] [startKey=748000000000000F6B5F728000000000A00A48] [endKey=748000000000000F6B5F728000000000F00CE3] [remainStart=748000000000000F6B5F728000000000EE2D3F] [region="{ID=12818787,startKey=748000000000000FFF6B5F728000000000FFA00A480000000000FA,endKey=748000000000000FFF6B5F728000000000FFF00CE30000000000FA,epoch=\"conf_ver:5 version:2144 \",peers=\"id:12818788 store_id:1 ,id:12818789 store_id:2 ,id:12818790 store_id:7 \"}"] [leader="id:12818788 store_id:1 "] [commitTS=458837626958643201]
[2025/06/19 17:51:56.247 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49499146] [startKey=748000000000000F6B5F728000000000000003] [endKey=748000000000000F6B5F7280000000004FFBF0] [remainStart=748000000000000F6B5F7280000000004E1F91] [region="{ID=12818779,startKey=748000000000000FFF6B5F728000000000FF0000030000000000FA,endKey=748000000000000FFF6B5F728000000000FF4FFBF00000000000FA,epoch=\"conf_ver:5 version:2144 \",peers=\"id:12818780 store_id:1 ,id:12818781 store_id:2 ,id:12818782 store_id:7 \"}"] [leader="id:12818781 store_id:2 "] [commitTS=458837626958643201]
[2025/06/19 17:51:56.313 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49836406] [startKey=748000000000000F6E5F7280000000002C561E] [endKey=748000000000000F6E5F7280000000007C6697] [remainStart=748000000000000F6E5F7280000000007A86A4] [region="{ID=12818795,startKey=748000000000000FFF6E5F728000000000FF2C561E0000000000FA,endKey=748000000000000FFF6E5F728000000000FF7C66970000000000FA,epoch=\"conf_ver:5 version:2147 \",peers=\"id:12818796 store_id:1 ,id:12818797 store_id:2 ,id:12818798 store_id:7 \"}"] [leader="id:12818796 store_id:1 "] [commitTS=458837626958643201]
[2025/06/19 17:51:56.961 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835939] [startKey=748000000000000F6E5F728000000000CC559F] [endKey=748000000000000F6E5F7280000000011C5802] [remainStart=748000000000000F6E5F7280000000011A7546] [region="{ID=12818803,startKey=748000000000000FFF6E5F728000000000FFCC559F0000000000FA,endKey=748000000000000FFF6E5F728000000001FF1C58020000000000FA,epoch=\"conf_ver:5 version:2147 \",peers=\"id:12818804 store_id:1 ,id:12818805 store_id:2 ,id:12818806 store_id:7 \"}"] [leader="id:12818805 store_id:2 "] [commitTS=458837626958643201]
[2025/06/19 17:51:57.176 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835527] [startKey=748000000000000F6C5F728000000000AEA9D4] [endKey=748000000000000F6C5F728000000000FEA6C0] [remainStart=748000000000000F6C5F728000000000FCC539] [region="{ID=12818759,startKey=748000000000000FFF6C5F728000000000FFAEA9D40000000000FA,endKey=748000000000000FFF6C5F728000000000FFFEA6C00000000000FA,epoch=\"conf_ver:5 version:2145 \",peers=\"id:12818760 store_id:1 ,id:12818761 store_id:2 ,id:12818762 store_id:7 \"}"] [leader="id:12818761 store_id:2 "] [commitTS=458837626958643201]
[2025/06/19 17:51:57.684 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49835575] [startKey=748000000000000F6D5F7280000000006D816D] [endKey=748000000000000F6D5F728000000000BD77CC] [remainStart=748000000000000F6D5F728000000000BB9A01] [region="{ID=12818723,startKey=748000000000000FFF6D5F728000000000FF6D816D0000000000FA,endKey=748000000000000FFF6D5F728000000000FFBD77CC0000000000FA,epoch=\"conf_ver:5 version:2146 \",peers=\"id:12818724 store_id:1 ,id:12818725 store_id:2 ,id:12818726 store_id:7 \"}"] [leader="id:12818725 store_id:2 "] [commitTS=458837626958643201]
[2025/06/19 17:52:18.261 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [size=777445676] [kvs=20001899] [importedSize=777445676] [importedCount=20001899]
[2025/06/19 17:52:18.344 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [retryCnt=0] [takeTime=33.422276021s] []
[2025/06/19 17:52:18.344 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b]
[2025/06/19 17:52:18.572 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [takeTime=227.883039ms] []
[2025/06/19 17:52:18.573 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`follows`:0] [engineUUID=1d03b603-cdf3-5719-b5a1-9b59cc474e7b] [takeTime=33.650689603s] []
[2025/06/19 17:52:18.573 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_peloton`.`follows`] [takeTime=1m37.749307223s] []
[2025/06/19 17:52:18.573 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e]
[2025/06/19 17:52:18.869 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e] [takeTime=296.27579ms] []
[2025/06/19 17:52:18.870 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e]
[2025/06/19 17:52:18.870 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e] [retryCnt=0]
[2025/06/19 17:52:18.872 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=d3c40877-1092-54e0-a335-e4b49d7d0a0e]
[2025/06/19 17:52:18.872 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e] [retryCnt=0] [takeTime=2.695011ms] []
[2025/06/19 17:52:18.873 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e]
[2025/06/19 17:52:18.962 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e] [takeTime=88.524522ms] []
[2025/06/19 17:52:18.962 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_peloton`.`follows`:-1] [engineUUID=d3c40877-1092-54e0-a335-e4b49d7d0a0e] [takeTime=92.045917ms] []
[2025/06/19 17:52:19.151 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_peloton`.`follows`] [takeTime=1m38.411448157s] []
[2025/06/19 17:52:19.151 +08:00] [INFO] [import.go:1148] ["cancel periodic actions"] [do=true]
[2025/06/19 17:52:19.151 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Normal]
[2025/06/19 17:52:21.307 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_peloton`.`tweets`] [checksum="{cksum=9081537100023489177,size=160505066,kvs=2500000}"]
[2025/06/19 17:52:21.307 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_peloton`.`users`] [checksum="{cksum=11007639462782896220,size=19388895,kvs=500000}"]
[2025/06/19 17:52:21.307 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=tweets]
[2025/06/19 17:52:21.307 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=users]
[2025/06/19 17:52:21.820 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=users] [takeTime=513.52475ms] []
[2025/06/19 17:52:21.821 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_peloton`.`users`] [local="{cksum=11007639462782896220,size=19388895,kvs=500000}"]
[2025/06/19 17:52:21.822 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_peloton`.`users`]
[2025/06/19 17:52:22.158 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=tweets] [takeTime=850.725872ms] []
[2025/06/19 17:52:22.158 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_peloton`.`tweets`] [local="{cksum=9081537100023489177,size=160505066,kvs=2500000}"]
[2025/06/19 17:52:22.159 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_peloton`.`tweets`]
[2025/06/19 17:52:26.738 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_peloton`.`tweets`] [takeTime=4.57950277s] []
[2025/06/19 17:52:26.739 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_peloton`.`follows`] [checksum="{cksum=5906452528462628289,size=777445676,kvs=20001899}"]
[2025/06/19 17:52:26.739 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=follows]
[2025/06/19 17:52:28.284 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_peloton`.`users`] [takeTime=6.462430026s] []
[2025/06/19 17:52:29.487 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=follows] [takeTime=2.74784675s] []
[2025/06/19 17:52:29.487 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_peloton`.`follows`] [local="{cksum=5906452528462628289,size=777445676,kvs=20001899}"]
[2025/06/19 17:52:29.489 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_peloton`.`follows`]
[2025/06/19 17:52:39.794 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_peloton`.`follows`] [takeTime=10.305014042s] []
[2025/06/19 17:52:39.794 +08:00] [INFO] [import.go:1412] ["restore all tables data completed"] [takeTime=2m7.235124084s] []
[2025/06/19 17:52:39.795 +08:00] [INFO] [import.go:1415] ["cleanup task metas"]
[2025/06/19 17:52:39.795 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=tikv-driver]
[2025/06/19 17:52:39.798 +08:00] [INFO] [import.go:1003] ["everything imported, stopping periodic actions"]
[2025/06/19 17:52:39.984 +08:00] [INFO] [import.go:1643] ["skip full compaction"]
[2025/06/19 17:52:39.984 +08:00] [INFO] [import.go:1793] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=6068261685416191611]
[2025/06/19 17:52:39.984 +08:00] [INFO] [import.go:1801] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=6068261685416191611] [takeTime=122.156µs] []
[2025/06/19 17:52:39.984 +08:00] [INFO] [import.go:584] ["the whole procedure completed"] [takeTime=2m13.169919378s] []
[2025/06/19 17:52:40.013 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/19 17:52:40.014 +08:00] [INFO] [checksum.go:510] ["service safe point keeper exited"]
[2025/06/19 17:52:40.014 +08:00] [INFO] [main.go:110] ["tidb lightning exit"] [finished=true]
[2025/06/20 15:46:59.106 +08:00] [WARN] [config.go:1606] ["currently only per-task configuration can be applied, global configuration changes can only be made on startup"] ["global config changes"="[lightning.level,lightning.file]"]
[2025/06/20 15:46:59.108 +08:00] [INFO] [info.go:53] ["Welcome to TiDB-Lightning"] [release-version=v8.5.1] [git-hash=fea86c8e35ad4a86a5e1160701f99493c2ee547c] [git-branch=HEAD] [go-version=go1.23.4] [utc-build-time="2025-01-16 07:41:07"] [race-enabled=false]
[2025/06/20 15:46:59.108 +08:00] [INFO] [lightning.go:437] [cfg] [cfg="{\"id\":5045538457050738054,\"lightning\":{\"table-concurrency\":6,\"index-concurrency\":2,\"region-concurrency\":72,\"io-concurrency\":5,\"check-requirements\":true,\"meta-schema-name\":\"lightning_metadata\",\"max-error\":{\"type\":0,\"conflict\":0},\"max-error-records\":0,\"task-info-schema-name\":\"lightning_task_info\"},\"tidb\":{\"host\":\"10.77.110.144\",\"port\":4000,\"user\":\"root\",\"status-port\":10080,\"pd-addr\":\"10.77.110.144:2379\",\"sql-mode\":\"ONLY_FULL_GROUP_BY,NO_AUTO_CREATE_USER\",\"tls\":\"\",\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"max-allowed-packet\":67108864,\"distsql-scan-concurrency\":15,\"build-stats-concurrency\":20,\"index-serial-scan-concurrency\":20,\"checksum-table-concurrency\":2,\"vars\":null},\"checkpoint\":{\"schema\":\"tidb_lightning_checkpoint\",\"driver\":\"file\",\"enable\":true,\"keep-after-success\":\"remove\"},\"mydumper\":{\"read-block-size\":65536,\"batch-size\":0,\"batch-import-ratio\":0,\"source-id\":\"\",\"data-source-dir\":\"file:///data3/dzh/project/grep/dev/twitter/data/tw_oracle_redshift\",\"character-set\":\"auto\",\"csv\":{\"separator\":\",\",\"delimiter\":\"\\\"\",\"terminator\":\"\",\"null\":[\"\\\\N\"],\"header\":true,\"header-schema-match\":true,\"trim-last-separator\":false,\"not-null\":false,\"backslash-escape\":true,\"escaped-by\":\"\\\\\"},\"max-region-size\":268435456,\"filter\":[\"*.*\",\"!mysql.*\",\"!sys.*\",\"!INFORMATION_SCHEMA.*\",\"!PERFORMANCE_SCHEMA.*\",\"!METRICS_SCHEMA.*\",\"!INSPECTION_SCHEMA.*\"],\"files\":null,\"no-schema\":false,\"case-sensitive\":false,\"strict-format\":false,\"default-file-rules\":true,\"ignore-data-columns\":null,\"data-character-set\":\"binary\",\"data-invalid-char-replace\":\"�\"},\"tikv-importer\":{\"addr\":\"\",\"backend\":\"local\",\"on-duplicate\":\"\",\"max-kv-pairs\":4096,\"send-kv-pairs\":32768,\"send-kv-size\":16384,\"compress-kv-pairs\":\"\",\"region-split-size\":0,\"region-split-keys\":0,\"region-split-batch-size\":4096,\"region-split-concurrency\":72,\"region-check-backoff-limit\":1800,\"sorted-kv-dir\":\"/data3/dzh/project/grep/dev/twitter/cache\",\"disk-quota\":9223372036854775807,\"range-concurrency\":16,\"duplicate-resolution\":\"\",\"incremental-import\":false,\"parallel-import\":false,\"keyspace-name\":\"\",\"add-index-by-sql\":false,\"engine-mem-cache-size\":536870912,\"local-writer-mem-cache-size\":134217728,\"store-write-bwlimit\":0,\"logical-import-batch-size\":98304,\"logical-import-batch-rows\":65536,\"logical-import-prep-stmt\":false,\"pause-pd-scheduler-scope\":\"table\",\"block-size\":16384},\"post-restore\":{\"checksum\":\"required\",\"analyze\":\"optional\",\"level-1-compact\":false,\"post-process-at-last\":true,\"compact\":false,\"checksum-via-sql\":false},\"cron\":{\"switch-mode\":\"5m0s\",\"log-progress\":\"5m0s\",\"check-disk-quota\":\"1m0s\"},\"routes\":[{\"schema-pattern\":\"tw_oracle_redshift\",\"table-pattern\":\"\",\"target-schema\":\"tw_oracle_redshift\",\"target-table\":\"\"}],\"security\":{\"ca-path\":\"\",\"cert-path\":\"\",\"key-path\":\"\",\"redact-info-log\":false},\"conflict\":{\"strategy\":\"\",\"precheck-conflict-before-import\":false,\"threshold\":0,\"max-record-rows\":0}}"]
[2025/06/20 15:46:59.109 +08:00] [INFO] [lightning.go:537] ["load data source start"]
[2025/06/20 15:46:59.111 +08:00] [INFO] [lightning.go:540] ["load data source completed"] [takeTime=1.097595ms] []
[2025/06/20 15:46:59.646 +08:00] [INFO] [lightning.go:588] ["acquired keyspace name"] [keyspaceName=]
[2025/06/20 15:46:59.646 +08:00] [INFO] [checkpoints.go:1154] ["open checkpoint file failed, going to create a new one"] [path=/tmp/tidb_lightning_checkpoint.pb] []
[2025/06/20 15:46:59.847 +08:00] [INFO] [local.go:733] ["multi ingest support"]
[2025/06/20 15:46:59.853 +08:00] [INFO] [local.go:755] ["TiKV server side free space check is enabled, so lightning will turn it off"]
[2025/06/20 15:46:59.853 +08:00] [INFO] [import.go:556] ["the whole procedure start"]
[2025/06/20 15:46:59.857 +08:00] [INFO] [import.go:1770] [new_collation_enabled] [enabled=true]
[2025/06/20 15:46:59.857 +08:00] [INFO] [schema_import.go:88] ["restore all schema start"]
[2025/06/20 15:46:59.869 +08:00] [INFO] [schema_import.go:137] ["database already exists in downstream, skip"] [db=tw_oracle_redshift]
[2025/06/20 15:47:05.626 +08:00] [INFO] [schema_import.go:90] ["restore all schema completed"] [takeTime=5.768514566s] []
[2025/06/20 15:47:06.630 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_oracle_redshift] [table=users] [path=tw_oracle_redshift.users.sql]
[2025/06/20 15:47:06.632 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_oracle_redshift] [table=tweets] [path=tw_oracle_redshift.tweets.sql]
[2025/06/20 15:47:06.633 +08:00] [INFO] [precheck_impl.go:1019] ["datafile to check"] [db=tw_oracle_redshift] [table=follows] [path=tw_oracle_redshift.follows.sql]
[2025/06/20 15:47:06.871 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_oracle_redshift`.`tweets` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/20 15:47:07.088 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_oracle_redshift`.`users` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/20 15:47:07.195 +08:00] [WARN] [util.go:207] ["check table empty failed with no retry"] [query="SELECT 1 FROM `tw_oracle_redshift`.`follows` USE INDEX() LIMIT 1"] [retryCnt=0] [error="sql: no rows in result set"]
[2025/06/20 15:47:07.579 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/20 15:47:07.581 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/20 15:47:07.590 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=tweets]
[2025/06/20 15:47:07.629 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=tweets] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/20 15:47:07.629 +08:00] [INFO] [get_pre_info.go:667] ["sample file start"] [table=follows]
[2025/06/20 15:47:07.661 +08:00] [INFO] [get_pre_info.go:772] ["Sample source data"] [table=follows] [IndexRatio=0] [IsSourceOrder=true]
[2025/06/20 15:47:07.906 +08:00] [INFO] [import.go:1276] ["restore all tables data start"]
[2025/06/20 15:47:07.914 +08:00] [INFO] [checksum_helper.go:52] ["set tidb_backoff_weight to default"] [backoff_weight=30]
[2025/06/20 15:47:08.061 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Import]
[2025/06/20 15:47:08.061 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_oracle_redshift`.`tweets`]
[2025/06/20 15:47:08.061 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_oracle_redshift`.`users`]
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_oracle_redshift`.`tweets`]
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_oracle_redshift`.`users`]
[2025/06/20 15:47:08.061 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=55.765µs]
[2025/06/20 15:47:08.061 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=43.142µs]
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_oracle_redshift`.`tweets`] [enginesCnt=2] [filesCnt=1] [takeTime=105.459µs] []
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_oracle_redshift`.`users`] [enginesCnt=2] [filesCnt=1] [takeTime=102.16µs] []
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_oracle_redshift`.`tweets`] [table=`tw_oracle_redshift`.`tweets`] [count=25833363]
[2025/06/20 15:47:08.061 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_oracle_redshift`.`users`] [table=`tw_oracle_redshift`.`users`] [count=3069463]
[2025/06/20 15:47:08.062 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/20 15:47:08.062 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/20 15:47:09.093 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6]
[2025/06/20 15:47:09.093 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_oracle_redshift`.`users`]
[2025/06/20 15:47:09.093 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0]
[2025/06/20 15:47:09.093 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0]
[2025/06/20 15:47:09.101 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f]
[2025/06/20 15:47:09.102 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_oracle_redshift`.`tweets`]
[2025/06/20 15:47:09.102 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0]
[2025/06/20 15:47:09.102 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0]
[2025/06/20 15:47:09.627 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32]
[2025/06/20 15:47:09.630 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527]
[2025/06/20 15:47:09.646 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.tweets.sql:0]
[2025/06/20 15:47:09.651 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.users.sql:0]
[2025/06/20 15:47:10.911 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.users.sql:0] [readDur=229.766561ms] [encodeDur=930.992431ms] [deliverDur=148.949152ms] [checksum="{cksum=769432901054914795,size=19388895,kvs=500000}"] [takeTime=1.259967651s] []
[2025/06/20 15:47:11.243 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0] [read(bytes)=0] [written=19388895] [takeTime=2.149939494s] []
[2025/06/20 15:47:11.243 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527]
[2025/06/20 15:47:11.243 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=19388895] [kvs=500000] [files=1] [sstFileSize=4188345] [file=/data3/dzh/project/grep/dev/twitter/cache/daceadcf-81d5-599b-a71a-472614e94527.sst/7a418385-c9e3-43bd-9577-1654902b94a7.sst] [firstKey=748000000000000F815F728000000000000001] [lastKey=748000000000000F835F72800000000007A120]
[2025/06/20 15:47:11.635 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527] [takeTime=392.031368ms] []
[2025/06/20 15:47:11.972 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_oracle_redshift`.`users`] [engineNumber=0] [takeTime=2.879307075s] []
[2025/06/20 15:47:11.973 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527]
[2025/06/20 15:47:11.973 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527] [retryCnt=0]
[2025/06/20 15:47:11.976 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/20 15:47:12.380 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=daceadcf-81d5-599b-a71a-472614e94527] ["region ranges"=1] [count=500000] [size=19388895]
[2025/06/20 15:47:12.380 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=2]
[2025/06/20 15:47:12.382 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f815f728000000000000001] [endOfAllRanges=748000000000000f835f72800000000007a121] [startKeyOfFirstRegion=748000000000000fff8100000000000000f8] [endKeyOfLastRegion=748000000000000fff8400000000000000f8]
[2025/06/20 15:47:14.192 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818914 is conf_ver: 5 version: 2155, but you sent conf_ver: 5 version: 2154"] [region="{ID=12818938,startKey=748000000000000FFF8300000000000000F8,endKey=748000000000000FFF835F728000000000FF07A1210000000000FA,epoch=\"conf_ver:5 version:2155 \",peers=\"id:12818939 store_id:1 ,id:12818940 store_id:2 ,id:12818941 store_id:7 \"}"] [start=748000000000000F83] [end=748000000000000F835F72800000000007A121]
[2025/06/20 15:47:14.193 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F83] [endKey=748000000000000F835F72800000000007A121] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/20 15:47:16.193 +08:00]
[2025/06/20 15:47:14.964 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=regionScanned] [error="[Lightning:KV:EpochNotMatch]EpochNotMatch current epoch of region 12818898 is conf_ver: 5 version: 2153, but you sent conf_ver: 5 version: 2152"] [region="{ID=12818898,startKey=748000000000000FFF815F728000000000FF0000010000000000FA,endKey=748000000000000FFF8200000000000000F8,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818899 store_id:1 ,id:12818900 store_id:2 ,id:12818901 store_id:7 \"}"] [start=748000000000000F815F728000000000000001] [end=748000000000000F82]
[2025/06/20 15:47:14.964 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F815F728000000000000001] [endKey=748000000000000F82] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/20 15:47:16.964 +08:00]
[2025/06/20 15:47:15.757 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=120851621] [kvs=1889947] [files=1] [sstFileSize=25820082] [file=/data3/dzh/project/grep/dev/twitter/cache/8dc35fdd-26a2-5c8b-8081-c91785b5ab32.sst/5a6f794b-c8c3-405d-bcf6-623329cd2a2d.sst] [firstKey=748000000000000F875F728000000000000001] [lastKey=748000000000000F895F7280000000001CD69B]
[2025/06/20 15:47:17.328 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.tweets.sql:0] [readDur=1.562123848s] [encodeDur=4.968845733s] [deliverDur=1.762998948s] [checksum="{cksum=8596937516135247041,size=160505066,kvs=2500000}"] [takeTime=7.681067109s] []
[2025/06/20 15:47:17.831 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0] [read(bytes)=0] [written=160505066] [takeTime=8.729281723s] []
[2025/06/20 15:47:17.831 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32]
[2025/06/20 15:47:17.831 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=39653445] [kvs=610053] [files=1] [sstFileSize=8357638] [file=/data3/dzh/project/grep/dev/twitter/cache/8dc35fdd-26a2-5c8b-8081-c91785b5ab32.sst/536496b5-1ea9-4164-8f25-13d0dface153.sst] [firstKey=748000000000000F895F7280000000001CD69C] [lastKey=748000000000000F8A5F7280000000002625A0]
[2025/06/20 15:47:18.713 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [takeTime=882.228599ms] []
[2025/06/20 15:47:19.025 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_oracle_redshift`.`tweets`] [engineNumber=0] [takeTime=9.92333415s] []
[2025/06/20 15:47:19.025 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32]
[2025/06/20 15:47:19.025 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [retryCnt=0]
[2025/06/20 15:47:19.029 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [totalSize=160505066] [totalCount=2500000] [startKey=748000000000000F875F728000000000000001] [endKey=748000000000000F8A5F7280000000002625A1] [len(keys)=3] []
[2025/06/20 15:47:19.029 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/20 15:47:19.129 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] ["region ranges"=2] [count=2500000] [size=160505066]
[2025/06/20 15:47:19.129 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=3]
[2025/06/20 15:47:19.129 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=8dc35fdd-26a2-5c8b-8081-c91785b5ab32]
[2025/06/20 15:47:19.131 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=4] [start=748000000000000FFF875F728000000000FF0000010000000000FA] [end=748000000000000FFF8A5F728000000000FF2625A10000000000FB]
[2025/06/20 15:47:19.605 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818926,startKey=748000000000000FFF8700000000000000F8,endKey=748000000000000FFF8800000000000000F8,epoch=\"conf_ver:5 version:2156 \",peers=\"id:12818927 store_id:1 ,id:12818928 store_id:2 ,id:12818929 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F875F728000000000000001]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818926 is conf_ver: 5 version: 2157\" epoch_not_match:<current_regions:<id:12818926 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\207_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\210\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2157 > peers:<id:12818927 store_id:1 > peers:<id:12818928 store_id:2 > peers:<id:12818929 store_id:7 > > > "]
[2025/06/20 15:47:19.606 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818926] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818926 is conf_ver: 5 version: 2157\" epoch_not_match:<current_regions:<id:12818926 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\207_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\210\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2157 > peers:<id:12818927 store_id:1 > peers:<id:12818928 store_id:2 > peers:<id:12818929 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818926 is conf_ver: 5 version: 2157\" epoch_not_match:<current_regions:<id:12818926 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\207_r\\200\\000\\000\\000\\000\\377\\000\\000\\001\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\210\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2157 > peers:<id:12818927 store_id:1 > peers:<id:12818928 store_id:2 > peers:<id:12818929 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/20 15:47:19.665 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > "] [backoff=10ms]
[2025/06/20 15:47:19.677 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > "] [backoff=20ms]
[2025/06/20 15:47:19.698 +08:00] [INFO] [retry.go:99] ["retryable operation failed"] [category=utils] [sampled=] [error="WaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > : found backoff error"] [errorVerbose="found backoff error\ngithub.com/pingcap/tidb/br/pkg/restore/split.init\n\t<autogenerated>:1\nruntime.doInit1\n\t/usr/local/go/src/runtime/proc.go:7290\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:7257\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:254\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700\nWaitRegionsSplit not finished, needRecheck: 1, the first unfinished region: id:12818954 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211\\000\\000\\000\\000\\000\\000\\000\\370\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\211_r\\200\\000\\000\\000\\000\\377\\024\\000\\001\\000\\000\\000\\000\\000\\372\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818955 store_id:1 > peers:<id:12818956 store_id:2 > peers:<id:12818957 store_id:7 > "] [backoff=40ms]
[2025/06/20 15:47:19.983 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=1]
[2025/06/20 15:47:20.081 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=daceadcf-81d5-599b-a71a-472614e94527] [size=19388895] [kvs=500000] [importedSize=19388895] [importedCount=500000]
[2025/06/20 15:47:20.126 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818691,startKey=748000000000000FFF8A00000000000000F8,endKey=7800000000000000FB,epoch=\"conf_ver:5 version:2158 \",peers=\"id:12818692 store_id:1 ,id:12818693 store_id:2 ,id:12818694 store_id:7 \"}"] [keys="{total=1,keys=\"[748000000000000F8A5F7280000000002625A1]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818691 is conf_ver: 5 version: 2159\" epoch_not_match:<current_regions:<id:12818691 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\212_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818692 store_id:1 > peers:<id:12818693 store_id:2 > peers:<id:12818694 store_id:7 > > > "]
[2025/06/20 15:47:20.126 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818691] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818691 is conf_ver: 5 version: 2159\" epoch_not_match:<current_regions:<id:12818691 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\212_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818692 store_id:1 > peers:<id:12818693 store_id:2 > peers:<id:12818694 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818691 is conf_ver: 5 version: 2159\" epoch_not_match:<current_regions:<id:12818691 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\212_r\\200\\000\\000\\000\\000\\377&%\\241\\000\\000\\000\\000\\000\\372\" end_key:\"x\\000\\000\\000\\000\\000\\000\\000\\373\" region_epoch:<conf_ver:5 version:2159 > peers:<id:12818692 store_id:1 > peers:<id:12818693 store_id:2 > peers:<id:12818694 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/20 15:47:20.178 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=6] [start=748000000000000FFF875F728000000000FF0000010000000000FA] [end=748000000000000FFF8A5F728000000000FF2625A10000000000FB]
[2025/06/20 15:47:20.178 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=0] [take=26.062µs]
[2025/06/20 15:47:20.178 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [takeTime=1.048256812s] []
[2025/06/20 15:47:20.180 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=3] [startOfAllRanges=748000000000000f875f728000000000000001] [endOfAllRanges=748000000000000f895f728000000000140001] [startKeyOfFirstRegion=748000000000000fff875f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff895f728000000000ff1400010000000000fa]
[2025/06/20 15:47:20.180 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=2] [startOfAllRanges=748000000000000f895f728000000000140001] [endOfAllRanges=748000000000000f8a5f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff895f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff8a5f728000000000ff2625a10000000000fa]
[2025/06/20 15:47:20.229 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527] [retryCnt=0] [takeTime=8.255989806s] []
[2025/06/20 15:47:20.229 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527]
[2025/06/20 15:47:20.310 +08:00] [WARN] [local.go:1232] ["meet retryable error when writing to TiKV"] [error="peer 12818960, store 2, region 12818958, epoch conf_ver:5 version:2159 , when send data: rpc error: code = Unknown desc = RequestTooOld(\"region 12818958 is not found\")"] ["job stage"=needRescan]
[2025/06/20 15:47:20.807 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f8a] [endOfAllRanges=748000000000000f8a5f7280000000002625a1] [startKeyOfFirstRegion=748000000000000fff8a00000000000000f8] [endKeyOfLastRegion=748000000000000fff8a5f728000000000ff2625a10000000000fa]
[2025/06/20 15:47:20.807 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F8A] [endKey=748000000000000F8A5F7280000000002625A1] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/20 15:47:22.807 +08:00]
[2025/06/20 15:47:20.810 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527] [takeTime=581.207499ms] []
[2025/06/20 15:47:20.810 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`users`:0] [engineUUID=daceadcf-81d5-599b-a71a-472614e94527] [takeTime=8.837819974s] []
[2025/06/20 15:47:20.810 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_oracle_redshift`.`users`] [takeTime=11.717561333s] []
[2025/06/20 15:47:20.811 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6]
[2025/06/20 15:47:21.679 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6] [takeTime=868.572004ms] []
[2025/06/20 15:47:21.680 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6]
[2025/06/20 15:47:21.680 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6] [retryCnt=0]
[2025/06/20 15:47:21.682 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=d18205a5-5970-525f-ae31-e165a2d2e7e6]
[2025/06/20 15:47:21.682 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6] [retryCnt=0] [takeTime=2.418741ms] []
[2025/06/20 15:47:21.683 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6]
[2025/06/20 15:47:21.972 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6] [takeTime=288.632421ms] []
[2025/06/20 15:47:21.972 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`users`:-1] [engineUUID=d18205a5-5970-525f-ae31-e165a2d2e7e6] [takeTime=291.890149ms] []
[2025/06/20 15:47:21.973 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_oracle_redshift`.`users`] [takeTime=13.912015708s] []
[2025/06/20 15:47:21.973 +08:00] [INFO] [import.go:1442] ["restore table start"] [table=`tw_oracle_redshift`.`follows`]
[2025/06/20 15:47:21.973 +08:00] [INFO] [table_import.go:289] ["load engines and files start"] [table=`tw_oracle_redshift`.`follows`]
[2025/06/20 15:47:21.973 +08:00] [INFO] [region.go:291] [makeTableRegions] [filesCount=1] [MaxChunkSize=268435456] [RegionsCount=1] [BatchSize=107374182400] [cost=59.533µs]
[2025/06/20 15:47:21.973 +08:00] [INFO] [table_import.go:332] ["load engines and files completed"] [table=`tw_oracle_redshift`.`follows`] [enginesCnt=2] [filesCnt=1] [takeTime=102.977µs] []
[2025/06/20 15:47:21.973 +08:00] [INFO] [table_import.go:152] ["estimated required row id count"] [table=`tw_oracle_redshift`.`follows`] [table=`tw_oracle_redshift`.`follows`] [count=88897226]
[2025/06/20 15:47:21.974 +08:00] [INFO] [version.go:457] ["detect server version"] [type=TiDB] [version=8.1.0]
[2025/06/20 15:47:22.604 +08:00] [WARN] [region_job.go:659] ["meet error and handle the job later"] ["job stage"=needRescan] [error="[Lightning:KV:NotLeader]peer is not leader for region 12818954, leader may Some(id: 12818955 store_id: 1)"] [] [start=748000000000000F89] [end=748000000000000F895F728000000000140001]
[2025/06/20 15:47:22.605 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f89] [endOfAllRanges=748000000000000f895f728000000000140001] [startKeyOfFirstRegion=748000000000000fff8900000000000000f8] [endKeyOfLastRegion=748000000000000fff895f728000000000ff1400010000000000fa]
[2025/06/20 15:47:22.605 +08:00] [INFO] [local.go:1494] ["put job back to jobCh to retry later"] [startKey=748000000000000F89] [endKey=748000000000000F895F728000000000140001] [stage=regionScanned] [retryCount=1] [waitUntil=2025/06/20 15:47:24.605 +08:00]
[2025/06/20 15:47:23.476 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91]
[2025/06/20 15:47:23.476 +08:00] [INFO] [table_import.go:484] ["import whole table start"] [table=`tw_oracle_redshift`.`follows`]
[2025/06/20 15:47:23.476 +08:00] [INFO] [table_import.go:531] ["restore engine start"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0]
[2025/06/20 15:47:23.476 +08:00] [INFO] [table_import.go:664] ["encode kv data and write start"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0]
[2025/06/20 15:47:24.555 +08:00] [INFO] [backend.go:271] ["open engine"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9]
[2025/06/20 15:47:24.613 +08:00] [INFO] [chunk_process.go:208] ["restore file start"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.follows.sql:0]
[2025/06/20 15:47:29.447 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [size=160505066] [kvs=2500000] [importedSize=160505066] [importedCount=2500000]
[2025/06/20 15:47:29.530 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [retryCnt=0] [takeTime=10.505228966s] []
[2025/06/20 15:47:29.531 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32]
[2025/06/20 15:47:29.700 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [takeTime=168.481662ms] []
[2025/06/20 15:47:29.700 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`tweets`:0] [engineUUID=8dc35fdd-26a2-5c8b-8081-c91785b5ab32] [takeTime=10.674644733s] []
[2025/06/20 15:47:29.700 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_oracle_redshift`.`tweets`] [takeTime=20.598240411s] []
[2025/06/20 15:47:29.700 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f]
[2025/06/20 15:47:30.121 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f] [takeTime=421.085844ms] []
[2025/06/20 15:47:30.122 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f]
[2025/06/20 15:47:30.122 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f] [retryCnt=0]
[2025/06/20 15:47:30.124 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=005189fa-72c6-595b-9101-052547211d0f]
[2025/06/20 15:47:30.124 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f] [retryCnt=0] [takeTime=2.286886ms] []
[2025/06/20 15:47:30.125 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f]
[2025/06/20 15:47:30.372 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f] [takeTime=247.603629ms] []
[2025/06/20 15:47:30.372 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`tweets`:-1] [engineUUID=005189fa-72c6-595b-9101-052547211d0f] [takeTime=250.464964ms] []
[2025/06/20 15:47:30.373 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_oracle_redshift`.`tweets`] [takeTime=22.312525146s] []
[2025/06/20 15:48:06.102 +08:00] [INFO] [chunk_process.go:223] ["restore file completed"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0] [fileIndex=0] [path=tw_oracle_redshift.follows.sql:0] [readDur=12.711731006s] [encodeDur=24.980025824s] [deliverDur=8.398461709s] [checksum="{cksum=11149364216615589161,size=777445676,kvs=20001899}"] [takeTime=41.488545977s] []
[2025/06/20 15:48:06.539 +08:00] [INFO] [table_import.go:860] ["encode kv data and write completed"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0] [read(bytes)=0] [written=777445676] [takeTime=43.062538526s] []
[2025/06/20 15:48:06.539 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9]
[2025/06/20 15:48:06.539 +08:00] [INFO] [engine.go:890] ["write data to local DB"] [size=777445676] [kvs=20001899] [files=1] [sstFileSize=307784126] [file=/data3/dzh/project/grep/dev/twitter/cache/815ee57d-d198-51e8-bf39-a19c36ff89f9.sst/31b090f7-7ea6-49d6-9bef-b0224047892c.sst] [firstKey=748000000000000F7F5F728000000000000001] [lastKey=748000000000000F7F5F72800000000131346B]
[2025/06/20 15:48:07.042 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9] [takeTime=502.57033ms] []
[2025/06/20 15:48:07.234 +08:00] [INFO] [table_import.go:533] ["restore engine completed"] [table=`tw_oracle_redshift`.`follows`] [engineNumber=0] [takeTime=43.757983933s] []
[2025/06/20 15:48:07.235 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9]
[2025/06/20 15:48:07.235 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9] [retryCnt=0]
[2025/06/20 15:48:07.238 +08:00] [INFO] [local.go:863] ["split engine key ranges"] [engine=815ee57d-d198-51e8-bf39-a19c36ff89f9] [totalSize=777445676] [totalCount=20001899] [startKey=748000000000000F7F5F728000000000000001] [endKey=748000000000000F7F5F72800000000131346C] [len(keys)=17] []
[2025/06/20 15:48:07.238 +08:00] [INFO] [local.go:1310] ["pause pd scheduler of table scope"]
[2025/06/20 15:48:07.334 +08:00] [INFO] [local.go:1348] ["start import engine"] [uuid=815ee57d-d198-51e8-bf39-a19c36ff89f9] ["region ranges"=16] [count=20001899] [size=777445676]
[2025/06/20 15:48:07.334 +08:00] [INFO] [local.go:882] ["import engine ranges"] [len(regionSplitKeyCnt)=17]
[2025/06/20 15:48:07.334 +08:00] [INFO] [local.go:893] ["split and scatter ranges start"] [uuid=815ee57d-d198-51e8-bf39-a19c36ff89f9]
[2025/06/20 15:48:07.335 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF7F5F728000000000FF0000010000000000FA] [end=748000000000000FFF7F5F728000000001FF31346C0000000000FB]
[2025/06/20 15:48:08.094 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818894,startKey=748000000000000FFF7F00000000000000F8,endKey=748000000000000FFF8100000000000000F8,epoch=\"conf_ver:5 version:2151 \",peers=\"id:12818895 store_id:1 ,id:12818896 store_id:2 ,id:12818897 store_id:7 \"}"] [keys="{total=17,keys=\"[748000000000000F7F5F728000000000000001,\\\"(skip 15)\\\",748000000000000F7F5F72800000000131346C]\"}"] [regionErr="message:\"EpochNotMatch current epoch of region 12818894 is conf_ver: 5 version: 2153\" epoch_not_match:<current_regions:<id:12818894 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\177_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\201\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2153 > peers:<id:12818895 store_id:1 > peers:<id:12818896 store_id:2 > peers:<id:12818897 store_id:7 > > > "]
[2025/06/20 15:48:08.094 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818894] [error="split region failed: err=message:\"EpochNotMatch current epoch of region 12818894 is conf_ver: 5 version: 2153\" epoch_not_match:<current_regions:<id:12818894 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\177_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\201\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2153 > peers:<id:12818895 store_id:1 > peers:<id:12818896 store_id:2 > peers:<id:12818897 store_id:7 > > > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"EpochNotMatch current epoch of region 12818894 is conf_ver: 5 version: 2153\" epoch_not_match:<current_regions:<id:12818894 start_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\177_r\\200\\000\\000\\000\\001\\37714l\\000\\000\\000\\000\\000\\372\" end_key:\"t\\200\\000\\000\\000\\000\\000\\017\\377\\201\\000\\000\\000\\000\\000\\000\\000\\370\" region_epoch:<conf_ver:5 version:2153 > peers:<id:12818895 store_id:1 > peers:<id:12818896 store_id:2 > peers:<id:12818897 store_id:7 > > > \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/20 15:48:08.146 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=2] [start=748000000000000FFF7F5F728000000000FF0000010000000000FA] [end=748000000000000FFF7F5F728000000001FF31346C0000000000FB]
[2025/06/20 15:48:08.147 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818970,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818971 store_id:1 ,id:12818972 store_id:2 ,id:12818973 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F7F5F728000000000140001,\\\"(skip 13)\\\",748000000000000F7F5F7280000000012C0001]\"}"] [regionErr="message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > "]
[2025/06/20 15:48:08.148 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818972]
[2025/06/20 15:48:08.148 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=0] [regionID=12818970] ["new leader"="id:12818972 store_id:2 "]
[2025/06/20 15:48:08.150 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818970,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818971 store_id:1 ,id:12818972 store_id:2 ,id:12818973 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F7F5F728000000000140001,\\\"(skip 13)\\\",748000000000000F7F5F7280000000012C0001]\"}"] [regionErr="message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > "]
[2025/06/20 15:48:08.151 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818972]
[2025/06/20 15:48:08.151 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=1] [regionID=12818970] ["new leader"="id:12818972 store_id:2 "]
[2025/06/20 15:48:08.153 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818970,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818971 store_id:1 ,id:12818972 store_id:2 ,id:12818973 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F7F5F728000000000140001,\\\"(skip 13)\\\",748000000000000F7F5F7280000000012C0001]\"}"] [regionErr="message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > "]
[2025/06/20 15:48:08.154 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818972]
[2025/06/20 15:48:08.154 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=2] [regionID=12818970] ["new leader"="id:12818972 store_id:2 "]
[2025/06/20 15:48:08.155 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818970,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818971 store_id:1 ,id:12818972 store_id:2 ,id:12818973 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F7F5F728000000000140001,\\\"(skip 13)\\\",748000000000000F7F5F7280000000012C0001]\"}"] [regionErr="message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > "]
[2025/06/20 15:48:08.156 +08:00] [INFO] [client.go:398] ["find new leader"] ["new leader"=12818972]
[2025/06/20 15:48:08.156 +08:00] [INFO] [client.go:401] ["split region meet not leader error, retrying"] ["retry times"=3] [regionID=12818970] ["new leader"="id:12818972 store_id:2 "]
[2025/06/20 15:48:08.157 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818970] [error="split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region; split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="the following errors occurred:\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700\n -  [BR:Restore:ErrRestoreSplitFailed]fail to split region\n    split region failed: err=message:\"peer is not leader for region 12818970, leader may None\" not_leader:<region_id:12818970 > \n    github.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:386\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:318\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:436\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:665\n    github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n    \t/workspace/source/tidb/br/pkg/restore/split/client.go:586\n    github.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/pkg/util/worker_pool.go:81\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/20 15:48:08.258 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF7F5F728000000000FF1400010000000000FA] [end=748000000000000FFF7F5F728000000001FF2C00010000000000FB]
[2025/06/20 15:48:08.261 +08:00] [WARN] [client.go:381] ["fail to split region"] [region="{ID=12818970,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF31346C0000000000FA,epoch=\"conf_ver:5 version:2153 \",peers=\"id:12818971 store_id:1 ,id:12818972 store_id:2 ,id:12818973 store_id:7 \"}"] [keys="{total=15,keys=\"[748000000000000F7F5F728000000000140001,\\\"(skip 13)\\\",748000000000000F7F5F7280000000012C0001]\"}"] [regionErr="message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818970] 12818972 peer has not applied to current term, applied_term 5, current_term 6\\\"\" "]
[2025/06/20 15:48:08.261 +08:00] [WARN] [client.go:591] ["split and scatter region meet error, will retry"] [region_id=12818970] [error="split region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818970] 12818972 peer has not applied to current term, applied_term 5, current_term 6\\\"\" : [BR:Restore:ErrRestoreSplitFailed]fail to split region"] [errorVerbose="[BR:Restore:ErrRestoreSplitFailed]fail to split region\nsplit region failed: err=message:\"\\\"[components/raftstore/src/store/peer.rs:4504]: [region 12818970] 12818972 peer has not applied to current term, applied_term 5, current_term 6\\\"\" \ngithub.com/pingcap/tidb/br/pkg/restore/split.sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:386\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).sendSplitRegionRequest\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:318\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).batchSplitRegionsWithOrigin\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:436\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitWaitAndScatter\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:665\ngithub.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).SplitKeysAndScatter.func1.1\n\t/workspace/source/tidb/br/pkg/restore/split/client.go:586\ngithub.com/pingcap/tidb/pkg/util.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/workspace/source/tidb/pkg/util/worker_pool.go:81\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/root/go/pkg/mod/golang.org/x/sync@v0.8.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1700"]
[2025/06/20 15:48:08.463 +08:00] [INFO] [client.go:570] ["paginate scan regions"] [count=1] [start=748000000000000FFF7F5F728000000000FF1400010000000000FA] [end=748000000000000FFF7F5F728000000001FF2C00010000000000FB]
[2025/06/20 15:48:10.026 +08:00] [INFO] [client.go:189] ["scatter regions"] [regions=15]
[2025/06/20 15:48:10.369 +08:00] [INFO] [localhelper.go:89] ["waiting for scattering regions done"] [regions=15] [take=337.984725ms]
[2025/06/20 15:48:10.369 +08:00] [INFO] [local.go:918] ["split and scatter ranges completed"] [uuid=815ee57d-d198-51e8-bf39-a19c36ff89f9] [takeTime=3.034407971s] []
[2025/06/20 15:48:10.370 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000640001] [endOfAllRanges=748000000000000f7f5f728000000000780001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff6400010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff7800010000000000fa]
[2025/06/20 15:48:10.370 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000280001] [endOfAllRanges=748000000000000f7f5f7280000000003c0001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff2800010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff3c00010000000000fa]
[2025/06/20 15:48:10.370 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000000001] [endOfAllRanges=748000000000000f7f5f728000000000140001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff0000010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff1400010000000000fa]
[2025/06/20 15:48:10.370 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000140001] [endOfAllRanges=748000000000000f7f5f728000000000280001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff1400010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff2800010000000000fa]
[2025/06/20 15:48:10.370 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000c80001] [endOfAllRanges=748000000000000f7f5f728000000000dc0001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ffc800010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ffdc00010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f7280000000003c0001] [endOfAllRanges=748000000000000f7f5f728000000000500001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff3c00010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff5000010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000500001] [endOfAllRanges=748000000000000f7f5f728000000000640001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff5000010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff6400010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000780001] [endOfAllRanges=748000000000000f7f5f7280000000008c0001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff7800010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ff8c00010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000f00001] [endOfAllRanges=748000000000000f7f5f728000000001040001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000fff000010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000001ff0400010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f7280000000008c0001] [endOfAllRanges=748000000000000f7f5f728000000000a00001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ff8c00010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ffa000010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000a00001] [endOfAllRanges=748000000000000f7f5f728000000000b40001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ffa000010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ffb400010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000dc0001] [endOfAllRanges=748000000000000f7f5f728000000000f00001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ffdc00010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000fff000010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000000b40001] [endOfAllRanges=748000000000000f7f5f728000000000c80001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000000ffb400010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000000ffc800010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000001040001] [endOfAllRanges=748000000000000f7f5f728000000001180001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000001ff0400010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000001ff1800010000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f7280000000012c0001] [endOfAllRanges=748000000000000f7f5f72800000000131346c] [startKeyOfFirstRegion=748000000000000fff7f5f728000000001ff2c00010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000001ff31346c0000000000fa]
[2025/06/20 15:48:10.371 +08:00] [INFO] [local.go:1064] ["generate region jobs"] [len(jobs)=1] [startOfAllRanges=748000000000000f7f5f728000000001180001] [endOfAllRanges=748000000000000f7f5f7280000000012c0001] [startKeyOfFirstRegion=748000000000000fff7f5f728000000001ff1800010000000000fa] [endKeyOfLastRegion=748000000000000fff7f5f728000000001ff2c00010000000000fa]
[2025/06/20 15:48:13.979 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752041] [startKey=748000000000000F7F5F728000000001040001] [endKey=748000000000000F7F5F728000000001180001] [remainStart=748000000000000F7F5F728000000001178801] [region="{ID=12819154,startKey=748000000000000FFF7F5F728000000001FF0400010000000000FA,endKey=748000000000000FFF7F5F728000000001FF1800010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819155 store_id:1 ,id:12819156 store_id:2 ,id:12819157 store_id:7 \"}"] [leader="id:12819157 store_id:7 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.164 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751050] [startKey=748000000000000F7F5F7280000000003C0001] [endKey=748000000000000F7F5F728000000000500001] [remainStart=748000000000000F7F5F7280000000004F8801] [region="{ID=12819114,startKey=748000000000000FFF7F5F728000000000FF3C00010000000000FA,endKey=748000000000000FFF7F5F728000000000FF5000010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819115 store_id:1 ,id:12819116 store_id:2 ,id:12819117 store_id:7 \"}"] [leader="id:12819115 store_id:1 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.299 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752155] [startKey=748000000000000F7F5F728000000000A00001] [endKey=748000000000000F7F5F728000000000B40001] [remainStart=748000000000000F7F5F728000000000B38801] [region="{ID=12819134,startKey=748000000000000FFF7F5F728000000000FFA000010000000000FA,endKey=748000000000000FFF7F5F728000000000FFB400010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819135 store_id:1 ,id:12819136 store_id:2 ,id:12819137 store_id:7 \"}"] [leader="id:12819135 store_id:1 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.738 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751025] [startKey=748000000000000F7F5F7280000000008C0001] [endKey=748000000000000F7F5F728000000000A00001] [remainStart=748000000000000F7F5F7280000000009F8801] [region="{ID=12819130,startKey=748000000000000FFF7F5F728000000000FF8C00010000000000FA,endKey=748000000000000FFF7F5F728000000000FFA000010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819131 store_id:1 ,id:12819132 store_id:2 ,id:12819133 store_id:7 \"}"] [leader="id:12819133 store_id:7 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.755 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751529] [startKey=748000000000000F7F5F728000000000DC0001] [endKey=748000000000000F7F5F728000000000F00001] [remainStart=748000000000000F7F5F728000000000EF8801] [region="{ID=12819146,startKey=748000000000000FFF7F5F728000000000FFDC00010000000000FA,endKey=748000000000000FFF7F5F728000000000FFF000010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819147 store_id:1 ,id:12819148 store_id:2 ,id:12819149 store_id:7 \"}"] [leader="id:12819147 store_id:1 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.796 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751287] [startKey=748000000000000F7F5F728000000001180001] [endKey=748000000000000F7F5F7280000000012C0001] [remainStart=748000000000000F7F5F7280000000012B8801] [region="{ID=12819158,startKey=748000000000000FFF7F5F728000000001FF1800010000000000FA,endKey=748000000000000FFF7F5F728000000001FF2C00010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819159 store_id:1 ,id:12819160 store_id:2 ,id:12819161 store_id:7 \"}"] [leader="id:12819161 store_id:7 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.821 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49750676] [startKey=748000000000000F7F5F728000000000C80001] [endKey=748000000000000F7F5F728000000000DC0001] [remainStart=748000000000000F7F5F728000000000DB8801] [region="{ID=12819142,startKey=748000000000000FFF7F5F728000000000FFC800010000000000FA,endKey=748000000000000FFF7F5F728000000000FFDC00010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819143 store_id:1 ,id:12819144 store_id:2 ,id:12819145 store_id:7 \"}"] [leader="id:12819143 store_id:1 "] [commitTS=458858337278099457]
[2025/06/20 15:48:14.828 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752399] [startKey=748000000000000F7F5F728000000000780001] [endKey=748000000000000F7F5F7280000000008C0001] [remainStart=748000000000000F7F5F7280000000008B8801] [region="{ID=12819126,startKey=748000000000000FFF7F5F728000000000FF7800010000000000FA,endKey=748000000000000FFF7F5F728000000000FF8C00010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819127 store_id:1 ,id:12819128 store_id:2 ,id:12819129 store_id:7 \"}"] [leader="id:12819128 store_id:2 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.242 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751454] [startKey=748000000000000F7F5F728000000000280001] [endKey=748000000000000F7F5F7280000000003C0001] [remainStart=748000000000000F7F5F7280000000003B8801] [region="{ID=12819110,startKey=748000000000000FFF7F5F728000000000FF2800010000000000FA,endKey=748000000000000FFF7F5F728000000000FF3C00010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819111 store_id:1 ,id:12819112 store_id:2 ,id:12819113 store_id:7 \"}"] [leader="id:12819112 store_id:2 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.248 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751819] [startKey=748000000000000F7F5F728000000000000001] [endKey=748000000000000F7F5F728000000000140001] [remainStart=748000000000000F7F5F728000000000138801] [region="{ID=12819102,startKey=748000000000000FFF7F5F728000000000FF0000010000000000FA,endKey=748000000000000FFF7F5F728000000000FF1400010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819103 store_id:1 ,id:12819104 store_id:2 ,id:12819105 store_id:7 \"}"] [leader="id:12819103 store_id:1 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.614 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752251] [startKey=748000000000000F7F5F728000000000F00001] [endKey=748000000000000F7F5F728000000001040001] [remainStart=748000000000000F7F5F728000000001038801] [region="{ID=12819150,startKey=748000000000000FFF7F5F728000000000FFF000010000000000FA,endKey=748000000000000FFF7F5F728000000001FF0400010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819151 store_id:1 ,id:12819152 store_id:2 ,id:12819153 store_id:7 \"}"] [leader="id:12819152 store_id:2 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.837 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752016] [startKey=748000000000000F7F5F728000000000640001] [endKey=748000000000000F7F5F728000000000780001] [remainStart=748000000000000F7F5F728000000000778801] [region="{ID=12819122,startKey=748000000000000FFF7F5F728000000000FF6400010000000000FA,endKey=748000000000000FFF7F5F728000000000FF7800010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819123 store_id:1 ,id:12819124 store_id:2 ,id:12819125 store_id:7 \"}"] [leader="id:12819125 store_id:7 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.843 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49751473] [startKey=748000000000000F7F5F728000000000140001] [endKey=748000000000000F7F5F728000000000280001] [remainStart=748000000000000F7F5F728000000000278801] [region="{ID=12819106,startKey=748000000000000FFF7F5F728000000000FF1400010000000000FA,endKey=748000000000000FFF7F5F728000000000FF2800010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819107 store_id:1 ,id:12819108 store_id:2 ,id:12819109 store_id:7 \"}"] [leader="id:12819108 store_id:2 "] [commitTS=458858337278099457]
[2025/06/20 15:48:15.846 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49752228] [startKey=748000000000000F7F5F728000000000500001] [endKey=748000000000000F7F5F728000000000640001] [remainStart=748000000000000F7F5F728000000000638801] [region="{ID=12819118,startKey=748000000000000FFF7F5F728000000000FF5000010000000000FA,endKey=748000000000000FFF7F5F728000000000FF6400010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819119 store_id:1 ,id:12819120 store_id:2 ,id:12819121 store_id:7 \"}"] [leader="id:12819120 store_id:2 "] [commitTS=458858337278099457]
[2025/06/20 15:48:19.912 +08:00] [ERROR] [client.go:252] ["[pd] request failed with a non-200 status"] [caller-id=pd-http-client] [name=GetMinResolvedTSByStoresIDs] [uri=/pd/api/v1/min-resolved-ts] [method=GET] [target-url=] [source=tikv-driver] [url=http://10.77.110.144:2379/pd/api/v1/min-resolved-ts] [status="503 Service Unavailable"] [body="no leader"] [stack="github.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:252\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry.func1\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:155\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:171\ngithub.com/tikv/pd/client/http.(*client).request\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:397\ngithub.com/tikv/pd/client/http.(*client).GetMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/interface.go:925\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).getMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:799\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateGlobalTxnScopeTSFromPD\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:833\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateSafeTS\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:702\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).safeTSUpdater\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:695"]
[2025/06/20 15:48:19.912 +08:00] [ERROR] [client.go:252] ["[pd] request failed with a non-200 status"] [caller-id=pd-http-client] [name=GetMinResolvedTSByStoresIDs] [uri="/pd/api/v1/min-resolved-ts?scope=40373,1,2,7"] [method=GET] [target-url=] [source=tikv-driver] [url="http://10.77.110.144:2379/pd/api/v1/min-resolved-ts?scope=40373,1,2,7"] [status="503 Service Unavailable"] [body="no leader"] [stack="github.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:252\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry.func1\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:155\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:171\ngithub.com/tikv/pd/client/http.(*client).request\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:397\ngithub.com/tikv/pd/client/http.(*client).GetMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/interface.go:925\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).getMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:799\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateSafeTS\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:721\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).safeTSUpdater\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:695"]
[2025/06/20 15:48:20.595 +08:00] [INFO] [region_job.go:531] ["write to tikv partial finish"] [count=1280000] [size=49753196] [startKey=748000000000000F7F5F728000000000B40001] [endKey=748000000000000F7F5F728000000000C80001] [remainStart=748000000000000F7F5F728000000000C78801] [region="{ID=12819138,startKey=748000000000000FFF7F5F728000000000FFB400010000000000FA,endKey=748000000000000FFF7F5F728000000000FFC800010000000000FA,epoch=\"conf_ver:5 version:2168 \",peers=\"id:12819139 store_id:1 ,id:12819140 store_id:2 ,id:12819141 store_id:7 \"}"] [leader="id:12819141 store_id:7 "] [commitTS=458858337278099457]
[2025/06/20 15:48:21.911 +08:00] [ERROR] [client.go:252] ["[pd] request failed with a non-200 status"] [caller-id=pd-http-client] [name=GetMinResolvedTSByStoresIDs] [uri=/pd/api/v1/min-resolved-ts] [method=GET] [target-url=] [source=tikv-driver] [url=http://10.77.110.144:2379/pd/api/v1/min-resolved-ts] [status="503 Service Unavailable"] [body="no leader"] [stack="github.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:252\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry.func1\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:155\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:171\ngithub.com/tikv/pd/client/http.(*client).request\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:397\ngithub.com/tikv/pd/client/http.(*client).GetMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/interface.go:925\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).getMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:799\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateGlobalTxnScopeTSFromPD\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:833\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateSafeTS\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:702\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).safeTSUpdater\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:695"]
[2025/06/20 15:48:21.912 +08:00] [ERROR] [client.go:252] ["[pd] request failed with a non-200 status"] [caller-id=pd-http-client] [name=GetMinResolvedTSByStoresIDs] [uri="/pd/api/v1/min-resolved-ts?scope=40373,1,2,7"] [method=GET] [target-url=] [source=tikv-driver] [url="http://10.77.110.144:2379/pd/api/v1/min-resolved-ts?scope=40373,1,2,7"] [status="503 Service Unavailable"] [body="no leader"] [stack="github.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:252\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry.func1\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:155\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:171\ngithub.com/tikv/pd/client/http.(*client).request\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/client.go:397\ngithub.com/tikv/pd/client/http.(*client).GetMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20241111073742-238d4d79ea31/http/interface.go:925\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).getMinResolvedTSByStoresIDs\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:799\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).updateSafeTS\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:721\ngithub.com/tikv/client-go/v2/tikv.(*KVStore).safeTSUpdater\n\t/root/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.8-0.20250113074216-d66e460ff577/tikv/kv.go:695"]
[2025/06/20 15:48:46.762 +08:00] [INFO] [local.go:1359] ["import engine success"] [uuid=815ee57d-d198-51e8-bf39-a19c36ff89f9] [size=777445676] [kvs=20001899] [importedSize=777445676] [importedCount=20001899]
[2025/06/20 15:48:46.851 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9] [retryCnt=0] [takeTime=39.616279759s] []
[2025/06/20 15:48:46.852 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9]
[2025/06/20 15:48:47.067 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9] [takeTime=215.443263ms] []
[2025/06/20 15:48:47.067 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`follows`:0] [engineUUID=815ee57d-d198-51e8-bf39-a19c36ff89f9] [takeTime=39.832710952s] []
[2025/06/20 15:48:47.067 +08:00] [INFO] [table_import.go:559] ["import whole table completed"] [table=`tw_oracle_redshift`.`follows`] [takeTime=1m23.590981335s] []
[2025/06/20 15:48:47.067 +08:00] [INFO] [backend.go:348] ["engine close start"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91]
[2025/06/20 15:48:47.203 +08:00] [INFO] [backend.go:350] ["engine close completed"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91] [takeTime=135.972656ms] []
[2025/06/20 15:48:47.204 +08:00] [INFO] [table_import.go:1339] ["import and cleanup engine start"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91]
[2025/06/20 15:48:47.204 +08:00] [INFO] [backend.go:390] ["import start"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91] [retryCnt=0]
[2025/06/20 15:48:47.207 +08:00] [INFO] [local.go:1299] ["engine contains no kv, skip import"] [engine=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91]
[2025/06/20 15:48:47.207 +08:00] [INFO] [backend.go:396] ["import completed"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91] [retryCnt=0] [takeTime=2.482068ms] []
[2025/06/20 15:48:47.207 +08:00] [INFO] [backend.go:409] ["cleanup start"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91]
[2025/06/20 15:48:47.304 +08:00] [INFO] [backend.go:411] ["cleanup completed"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91] [takeTime=96.800165ms] []
[2025/06/20 15:48:47.304 +08:00] [INFO] [table_import.go:1372] ["import and cleanup engine completed"] [engineTag=`tw_oracle_redshift`.`follows`:-1] [engineUUID=1f8dcfb8-ddc4-5099-9385-0f33d61b9d91] [takeTime=100.099594ms] []
[2025/06/20 15:48:47.563 +08:00] [INFO] [import.go:1451] ["restore table completed"] [table=`tw_oracle_redshift`.`follows`] [takeTime=1m25.589656585s] []
[2025/06/20 15:48:47.563 +08:00] [INFO] [import.go:1148] ["cancel periodic actions"] [do=true]
[2025/06/20 15:48:47.563 +08:00] [INFO] [tikv_mode.go:61] ["switch tikv mode"] [mode=Normal]
[2025/06/20 15:48:48.587 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_oracle_redshift`.`users`] [checksum="{cksum=769432901054914795,size=19388895,kvs=500000}"]
[2025/06/20 15:48:48.587 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_oracle_redshift`.`tweets`] [checksum="{cksum=8596937516135247041,size=160505066,kvs=2500000}"]
[2025/06/20 15:48:48.587 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=users]
[2025/06/20 15:48:48.588 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=tweets]
[2025/06/20 15:48:49.398 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=users] [takeTime=809.958049ms] []
[2025/06/20 15:48:49.398 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_oracle_redshift`.`users`] [local="{cksum=769432901054914795,size=19388895,kvs=500000}"]
[2025/06/20 15:48:49.399 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_oracle_redshift`.`users`]
[2025/06/20 15:48:50.046 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=tweets] [takeTime=1.458795703s] []
[2025/06/20 15:48:50.046 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_oracle_redshift`.`tweets`] [local="{cksum=8596937516135247041,size=160505066,kvs=2500000}"]
[2025/06/20 15:48:50.048 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_oracle_redshift`.`tweets`]
[2025/06/20 15:49:03.528 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_oracle_redshift`.`users`] [takeTime=14.129106194s] []
[2025/06/20 15:49:03.529 +08:00] [INFO] [table_import.go:1031] ["local checksum"] [table=`tw_oracle_redshift`.`follows`] [checksum="{cksum=11149364216615589161,size=777445676,kvs=20001899}"]
[2025/06/20 15:49:03.529 +08:00] [INFO] [checksum_helper.go:73] ["remote checksum start"] [table=follows]
[2025/06/20 15:49:04.079 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_oracle_redshift`.`tweets`] [takeTime=14.030863118s] []
[2025/06/20 15:49:04.477 +08:00] [INFO] [checksum_helper.go:76] ["remote checksum completed"] [table=follows] [takeTime=948.357784ms] []
[2025/06/20 15:49:04.477 +08:00] [INFO] [table_import.go:1399] ["checksum pass"] [table=`tw_oracle_redshift`.`follows`] [local="{cksum=11149364216615589161,size=777445676,kvs=20001899}"]
[2025/06/20 15:49:04.479 +08:00] [INFO] [table_import.go:1404] ["analyze start"] [table=`tw_oracle_redshift`.`follows`]
[2025/06/20 15:49:20.612 +08:00] [INFO] [table_import.go:1410] ["analyze completed"] [table=`tw_oracle_redshift`.`follows`] [takeTime=16.133206195s] []
[2025/06/20 15:49:20.613 +08:00] [INFO] [import.go:1412] ["restore all tables data completed"] [takeTime=2m12.706978224s] []
[2025/06/20 15:49:20.613 +08:00] [INFO] [import.go:1415] ["cleanup task metas"]
[2025/06/20 15:49:20.614 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=tikv-driver]
[2025/06/20 15:49:20.619 +08:00] [INFO] [import.go:1003] ["everything imported, stopping periodic actions"]
[2025/06/20 15:49:20.827 +08:00] [INFO] [import.go:1643] ["skip full compaction"]
[2025/06/20 15:49:20.827 +08:00] [INFO] [import.go:1793] ["clean checkpoints start"] [keepAfterSuccess=remove] [taskID=5045538457050738054]
[2025/06/20 15:49:20.828 +08:00] [INFO] [import.go:1801] ["clean checkpoints completed"] [keepAfterSuccess=remove] [taskID=5045538457050738054] [takeTime=148.622µs] []
[2025/06/20 15:49:20.828 +08:00] [INFO] [import.go:584] ["the whole procedure completed"] [takeTime=2m20.974238086s] []
[2025/06/20 15:49:20.854 +08:00] [INFO] [client.go:347] ["[pd] http client closed"] [source=lightning]
[2025/06/20 15:49:20.854 +08:00] [INFO] [checksum.go:510] ["service safe point keeper exited"]
[2025/06/20 15:49:20.855 +08:00] [INFO] [main.go:110] ["tidb lightning exit"] [finished=true]
