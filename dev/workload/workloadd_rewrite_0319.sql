select   order_line_part2.ol_number,  sum(order_line_part1.ol_quantity) as sum_qty,  sum(order_line_part2.ol_amount) as sum_amount,  avg(order_line_part1.ol_quantity) as avg_qty,  avg(order_line_part2.ol_amount) as avg_amount,  count(*) as count_order from order_line_part2,order_line_part1 where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.ol_w_id = order_line_part1.ol_w_id and order_line_part2.order_line_part2.ol_number = order_line_part1.order_line_part2.ol_number and  order_line_part1.ol_delivery_d > '2024-10-28 17:00:00' group by order_line_part2.ol_number order by order_line_part2.ol_number
select su.supplier.s_suppkey, su.supplier.s_name, n.nation.n_name, i.item.i_id, i.item.i_name, su.supplier.s_address, su.supplier.s_phone, su.supplier.s_comment from item as i join stock as s on i.item.i_id = s.stock.s_i_id join supplier as su on mod((s.stock.s_w_id * s.stock.s_i_id), 10000) = su.supplier.s_suppkey join nation as n on su.supplier.s_nationkey = n.nation.n_nationkey join region as r on n.nation.n_regionkey = r.region.r_regionkey join (select s_sub.stock.s_i_id as m_i_id, min(s_sub.stock.s_quantity) as m_s_quantity from stock as s_sub join supplier as su_sub on mod((s_sub.stock.s_w_id * s_sub.stock.s_i_id), 10000) = su_sub.supplier.s_suppkey join nation as n_sub on su_sub.supplier.s_nationkey = n_sub.nation.n_nationkey join region as r_sub on n_sub.nation.n_regionkey = r_sub.region.r_regionkey where r_sub.region.r_name like 'europ%' group by s_sub.stock.s_i_id) as m on i.item.i_id = m.m_i_id and s.stock.s_quantity = m.m_s_quantity where i.item.i_data like '%b' and r.region.r_name like 'europ%' order by n.nation.n_name, su.supplier.s_name, i.item.i_id
select   order_line_part2.ol_o_id, order_line_part2.ol_w_id, order_line_part2.ol_d_id,sum(order_line_part2.ol_amount) as revenue, orders.o_entry_d from 	 customer, new_order, orders, order_line_part2 where 	 customer.c_state like 'a%' and customer.c_id = orders.o_c_id and customer.c_w_id = orders.o_w_id and customer.c_d_id = orders.o_d_id and new_order.no_w_id = orders.o_w_id and new_order.no_d_id = orders.o_d_id and new_order.no_o_id = orders.o_id and order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id and orders.o_entry_d > '2024-10-28 17:00:00' group by order_line_part2.ol_o_id, order_line_part2.ol_w_id, order_line_part2.ol_d_id, orders.o_entry_d order by revenue desc, orders.o_entry_d
select o.orders.o_ol_cnt, count(*) as order_count from orders o join order_line_part1 ol on o.orders.o_id = ol.order_line_part2.ol_o_id and o.orders.o_w_id = ol.order_line_part2.ol_w_id and o.orders.o_d_id = ol.order_line_part2.ol_d_id and ol.order_line_part1.ol_delivery_d >= o.orders.o_entry_d where o.orders.o_entry_d >= '2024-10-28 17:00:00' and o.orders.o_entry_d < '2025-10-23 17:00:00' group by o.orders.o_ol_cnt order by o.orders.o_ol_cnt
select nation.n_name,  sum(order_line_part2.ol_amount) as revenue from customer, orders, order_line_part2,order_line_part1, stock, supplier, nation, region where order_line_part2.order_line_part2.ol_o_id = order_line_part1.order_line_part2.ol_o_id and order_line_part2.order_line_part2.ol_d_id = order_line_part1.order_line_part2.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  customer.c_id = orders.o_c_id  and customer.c_w_id = orders.o_w_id  and customer.c_d_id = orders.o_d_id  and order_line_part2.ol_o_id = orders.o_id  and order_line_part2.ol_w_id = orders.o_w_id  and order_line_part2.ol_d_id=orders.o_d_id  and order_line_part2.ol_w_id = stock.s_w_id  and order_line_part1.ol_i_id = stock.s_i_id  and mod((stock.s_w_id * stock.s_i_id),10000) = supplier.s_suppkey  and ascii(substr(customer.c_state,1,1)) = supplier.s_nationkey  and supplier.s_nationkey = nation.n_nationkey  and nation.n_regionkey = region.r_regionkey  and region.r_name = 'europe'  and orders.o_entry_d >= '2024-10-28 17:00:00' group by nation.n_name order by revenue desc
select sum(order_line_part2.ol_amount) as revenue from order_line_part2,order_line_part1 where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.ol_w_id = order_line_part1.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  order_line_part1.ol_delivery_d >= '2024-10-23 17:00:00' and order_line_part1.ol_delivery_d < '2024-10-28 17:00:00' and order_line_part1.ol_quantity between 1 and 100000
select s.supplier.s_nationkey as supp_nation,substr(c.customer.c_state, 1, 1) as cust_nation,extract(year from o.orders.o_entry_d) as l_year,sum(ol.order_line_part2.ol_amount) as revenue from order_line_part2,order_line_part1 as ol join stock st on ol.order_line_part1.ol_supply_w_id = st.stock.s_w_id and ol.order_line_part1.ol_i_id = st.stock.s_i_id join orders o on ol.order_line_part2.ol_w_id = o.orders.o_w_id and ol.order_line_part2.ol_d_id = o.orders.o_d_id and ol.order_line_part2.ol_o_id = o.orders.o_id join customer c on o.orders.o_c_id = c.customer.c_id and o.orders.o_w_id = c.customer.c_w_id and o.orders.o_d_id = c.customer.c_d_id join supplier s on mod((st.stock.s_w_id * st.stock.s_i_id), 10000) = s.supplier.s_suppkey join nation n1 on s.supplier.s_nationkey = n1.nation.n_nationkey join nation n2 on ascii(substr(c.customer.c_state, 1, 1)) = n2.nation.n_nationkey where order_line_part2.order_line_part2.ol_o_id = order_line_part1.order_line_part2.ol_o_id and order_line_part2.order_line_part2.ol_d_id = order_line_part1.order_line_part2.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  mod((st.stock.s_w_id * st.stock.s_i_id), 10000) = s.supplier.s_suppkey and ((n1.nation.n_name = 'germany' and n2.nation.n_name = 'canada') or (n1.nation.n_name = 'canada' and n2.nation.n_name = 'germany')) and o.orders.o_entry_d between '2024-10-28 17:00:00' and '2025-10-23 17:00:00' group by s.supplier.s_nationkey,substr(c.customer.c_state, 1, 1), extract(year from o.orders.o_entry_d) order by s.supplier.s_nationkey,cust_nation, l_year
select extract(year from orders.o_entry_d) as l_year,sum(case when n2.nation.n_name = 'germany' then order_line_part2.ol_amount else 0 end) / sum(order_line_part2.ol_amount) as mkt_share from	 item, supplier, stock, order_line_part2,order_line_part1, orders, customer, nation n1, nation n2, region where order_line_part2.order_line_part2.ol_o_id = order_line_part1.order_line_part2.ol_o_id and order_line_part2.order_line_part2.ol_d_id = order_line_part1.order_line_part2.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and 	 item.i_id = stock.s_i_id and order_line_part1.ol_i_id = stock.s_i_id and order_line_part1.ol_supply_w_id = stock.s_w_id and mod((stock.s_w_id * stock.s_i_id),10000) = supplier.s_suppkey and order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id and customer.c_id = orders.o_c_id and customer.c_w_id = orders.o_w_id and customer.c_d_id = orders.o_d_id and n1.nation.n_nationkey = ascii(substr(customer.c_state,1,1)) and n1.nation.n_regionkey = region.r_regionkey and order_line_part1.ol_i_id < 1000 and region.r_name = 'europe' and supplier.s_nationkey = n2.nation.n_nationkey and orders.o_entry_d between '2024-10-23 17:00:00' and '2024-10-28 17:00:00' and item.i_data like '%b' and item.i_id = order_line_part1.ol_i_id group by extract(year from orders.o_entry_d) order by l_year
select	 nation.n_name, extract(year from orders.o_entry_d) as l_year, sum(order_line_part2.ol_amount) as sum_profit from	 item, stock, supplier, order_line_part2,order_line_part1, orders, nation where order_line_part2.order_line_part2.ol_o_id = order_line_part1.order_line_part2.ol_o_id and order_line_part2.order_line_part2.ol_d_id = order_line_part1.order_line_part2.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and 	 order_line_part1.ol_i_id = stock.s_i_id and order_line_part1.ol_supply_w_id = stock.s_w_id and mod((stock.s_w_id * stock.s_i_id), 10000) = supplier.s_suppkey and order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id and order_line_part1.ol_i_id = item.i_id and supplier.s_nationkey = nation.n_nationkey and item.i_data like '%bb' group by nation.n_name, extract(year from orders.o_entry_d) order by nation.n_name, l_year desc
select	 customer.c_id, customer.c_last, sum(order_line_part2.ol_amount) as revenue, customer.c_city, customer.c_phone, nation.n_name from	 customer, orders, order_line_part2,order_line_part1, nation where order_line_part2.order_line_part2.ol_o_id = order_line_part1.order_line_part2.ol_o_id and order_line_part2.order_line_part2.ol_d_id = order_line_part1.order_line_part2.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and 	 customer.c_id = orders.o_c_id and customer.c_w_id = orders.o_w_id and customer.c_d_id = orders.o_d_id and order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id and orders.o_entry_d >= '2024-10-28 17:00:00' and orders.o_entry_d <= order_line_part1.ol_delivery_d and nation.n_nationkey = ascii(substr(customer.c_state,1,1)) group by customer.c_id, customer.c_last, customer.c_city, customer.c_phone, nation.n_name order by revenue desc
select	 stock.s_i_id, sum(stock.s_order_cnt) as ordercount from	 stock, supplier, nation where	 mod((stock.s_w_id * stock.s_i_id),10000) = supplier.s_suppkey and supplier.s_nationkey = nation.n_nationkey and nation.n_name = 'germany' group by stock.s_i_id having   sum(stock.s_order_cnt) >(select sum(stock.s_order_cnt) * 0.005 from stock, supplier, nation where mod((stock.s_w_id * stock.s_i_id),10000) = supplier.s_suppkey and supplier.s_nationkey = nation.n_nationkey and nation.n_name = 'germany') order by ordercount desc
select	 orders.o_ol_cnt, sum(case when orders.o_carrier_id = 1 or orders.o_carrier_id = 2 then 1 else 0 end) as high_line_count, sum(case when orders.o_carrier_id <> 1 and orders.o_carrier_id <> 2 then 1 else 0 end) as low_line_count from	 orders, order_line_part1 where	 order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id and orders.o_entry_d <= order_line_part1.ol_delivery_d and order_line_part1.ol_delivery_d < '2025-10-23 17:00:00' group by orders.o_ol_cnt order by orders.o_ol_cnt
select c_count, count(*) as custdist from (select c.customer.c_id, count(o.orders.o_id) as c_count from customer c left join orders o on c.customer.c_w_id = o.orders.o_w_id and c.customer.c_d_id = o.orders.o_d_id and c.customer.c_id = o.orders.o_c_id and o.orders.o_carrier_id > 8 group by c.customer.c_id) as c_orders group by c_count order by custdist desc, c_count desc
select 100.00 * sum(case when i.item.i_data like 'pr%' then ol.order_line_part2.ol_amount else 0 end) / nullif(sum(ol.order_line_part2.ol_amount), 0) as promo_revenue from order_line_part2,order_line_part1 ol join item i on ol.order_line_part1.ol_i_id = i.item.i_id where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.ol_w_id = order_line_part1.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  ol.order_line_part1.ol_delivery_d >= '2024-10-28 17:00:00' and ol.order_line_part1.ol_delivery_d < '2025-10-23 17:00:00'
with revenue as (select mod((st.stock.s_w_id * st.stock.s_i_id), 10000) as supplier_no,sum(ol.order_line_part2.ol_amount) as total_revenue from order_line_part2,order_line_part1 ol join stock st on ol.order_line_part1.ol_i_id = st.stock.s_i_id and ol.order_line_part1.ol_supply_w_id = st.stock.s_w_id where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.ol_w_id = order_line_part1.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  ol.order_line_part1.ol_delivery_d >= '2024-10-28 17:00:00' group by mod((st.stock.s_w_id * st.stock.s_i_id), 10000))select s.supplier.s_suppkey, s.supplier.s_name, s.supplier.s_address, s.supplier.s_phone, r.total_revenue from supplier s join revenue r on s.supplier.s_suppkey = r.supplier_no where r.total_revenue = (select max(total_revenue) from revenue) order by s.supplier.s_suppkey
select i.item.i_name,substr(i.item.i_data, 1, 3) as brand,i.item.i_price,count(distinct mod((st.stock.s_w_id * st.stock.s_i_id), 10000)) as supplier_cnt from stock st join item i on i.item.i_id = st.stock.s_i_id where i.item.i_data not like 'zz%' and mod((st.stock.s_w_id * st.stock.s_i_id), 10000) not in (select s.supplier.s_suppkey from supplier s where s.supplier.s_comment like '%bad%') group by i.item.i_name, substr(i.item.i_data, 1, 3), i.item.i_price order by supplier_cnt desc
select sum(ol.order_line_part2.ol_amount) / 2.0 as avg_yearly from order_line_part2,order_line_part1 ol join (select i.item.i_id, avg(ol.order_line_part1.ol_quantity) as a from order_line_part2,order_line_part1 ol join item i on ol.order_line_part1.ol_i_id = i.item.i_id group by i.item.i_id) as t on ol.order_line_part1.ol_i_id = t.item.i_id where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.ol_w_id = order_line_part1.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  ol.order_line_part1.ol_quantity < t.a
select	 customer.c_last, customer.c_id orders.o_id, orders.o_entry_d, orders.o_ol_cnt, sum(order_line_part2.ol_amount) from	 customer, orders, order_line_part2 where	 customer.c_id = orders.o_c_id and customer.c_w_id = orders.o_w_id and customer.c_d_id = orders.o_d_id and order_line_part2.ol_w_id = orders.o_w_id and order_line_part2.ol_d_id = orders.o_d_id and order_line_part2.ol_o_id = orders.o_id group by orders.o_id, orders.o_w_id, orders.o_d_id, customer.c_id, customer.c_last, orders.o_entry_d, orders.o_ol_cnt having	 sum(order_line_part2.ol_amount) > 200 order by sum(order_line_part2.ol_amount) desc, orders.o_entry_d
select sum(ol.order_line_part2.ol_amount) as revenue from order_line_part2,order_line_part1 ol join item i on ol.order_line_part1.ol_i_id = i.item.i_id where order_line_part2.ol_o_id = order_line_part1.ol_o_id and order_line_part2.ol_d_id = order_line_part1.ol_d_id and order_line_part2.order_line_part2.ol_w_id = order_line_part1.order_line_part2.ol_w_id and order_line_part2.ol_number = order_line_part1.ol_number and  ol.order_line_part1.ol_quantity >= 1 and ol.order_line_part1.ol_quantity <= 10 and i.item.i_price between 1 and 400000 and ((i.item.i_data like '%a' and ol.order_line_part2.ol_w_id in (1, 2, 3)) or (i.item.i_data like '%b' and ol.order_line_part2.ol_w_id in (1, 2, 4)) or (i.item.i_data like '%c' and ol.order_line_part2.ol_w_id in (1, 5, 3)))
select supplier.s_name, supplier.s_address from supplier, nation where supplier.s_suppkey in (select mod(s.stock.s_i_id * s.stock.s_w_id, 10000) from stock s join order_line_part1 ol on s.stock.s_i_id = ol.order_line_part1.ol_i_id where s.stock.s_i_id in (select i.item.i_id from item i where i.item.i_data like 'co%') and ol.order_line_part1.ol_delivery_d > '2024-10-28 17:00:00' group by s.stock.s_i_id, s.stock.s_w_id, s.stock.s_quantity having 2 * s.stock.s_quantity > sum(ol.order_line_part1.ol_quantity)) and supplier.s_nationkey = nation.n_nationkey and nation.n_name = 'germany' order by supplier.s_name
select s.supplier.s_name, count(*) as numwait from supplier s join stock st on s.supplier.s_suppkey = mod((st.stock.s_w_id * st.stock.s_i_id), 10000) join order_line_part1 l1 on l1.order_line_part1.ol_i_id = st.stock.s_i_id and l1.order_line_part2.ol_w_id = st.stock.s_w_id join orders o on l1.order_line_part2.ol_o_id = o.orders.o_id join nation n on s.supplier.s_nationkey = n.nation.n_nationkey where l1.order_line_part1.ol_delivery_d > o.orders.o_entry_d and not exists (select * from order_line_part1 l2 where l2.order_line_part2.ol_o_id = l1.order_line_part2.ol_o_id and l2.order_line_part2.ol_w_id = l1.order_line_part2.ol_w_id and l2.order_line_part2.ol_d_id = l1.order_line_part2.ol_d_id and l2.order_line_part1.ol_delivery_d > l1.order_line_part1.ol_delivery_d) and n.nation.n_name = 'germany' group by s.supplier.s_name order by numwait desc, s.supplier.s_name
select substr(c.customer.c_state, 1, 1) as country,count(*) as numcust, sum(c.customer.c_balance) as totacctbal from customer c where substr(c.customer.c_phone, 1, 1) in ('1', '2', '3', '4', '5', '6', '7') and c.customer.c_balance > (select avg(c2.customer.c_balance) from customer c2 where c2.customer.c_balance > 0.00 and substr(c2.customer.c_phone, 1, 1) in ('1', '2', '3', '4', '5', '6', '7'))and not exists (select * from orders o where o.orders.o_c_id = c.customer.c_id and o.orders.o_w_id = c.customer.c_w_id and o.orders.o_d_id = c.customer.c_d_id) group by substr(c.customer.c_state, 1, 1) order by substr(c.customer.c_state, 1, 1)
